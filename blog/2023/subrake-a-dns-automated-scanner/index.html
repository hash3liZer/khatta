<!DOCTYPE html>
<html lang="zh">
  <head prefix="og: https://ogp.me/ns#">
    <meta charset="utf-8" />
    <meta name="generator" content="gh:importantimport/urara" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="manifest" crossorigin="use-credentials" href="/manifest.webmanifest" />
    <link rel="alternate" type="application/feed+json" href="/feed.json" />
    <link rel="alternate" type="application/atom+xml" href="/atom.xml" />
    <link rel="sitemap" type="application/xml" href="/sitemap.xml" />
    <meta http-equiv="content-security-policy" content="style-src 'self' 'unsafe-inline' https://giscus.app">
		<link href="../../../_app/immutable/assets/0.4fcee0bd.css" rel="stylesheet">
		<link rel="modulepreload" href="../../../_app/immutable/entry/start.0035f0c5.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/index.725d15e1.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/singletons.0f8a05f9.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/index.f6403797.js">
		<link rel="modulepreload" href="../../../_app/immutable/entry/app.a1b97411.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/preload-helper.41c905a7.js">
		<link rel="modulepreload" href="../../../_app/immutable/nodes/0.e1d7901b.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/posts.7eeb28a4.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/posts.d89605eb.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/icon.415d2f94.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/title.ff9679dd.js">
		<link rel="modulepreload" href="../../../_app/immutable/nodes/3.9d623281.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/post_layout.a1c515d4.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/post_card.96bda489.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/footer.5a183668.js"><title>A Guide to Zone Transfer, DNS Zone Takeover and Subdomain Takeover | ./khatta.sh</title><!-- HEAD_svelte-1592q3p_START --><link rel="me" href="https://kongwoo.icu/@seviche"><!-- HEAD_svelte-1592q3p_END --><!-- HEAD_svelte-1kxdj3d_START --><link rel="shortcut icon" href="https://blog.shameerkashif.me/favicon.png" sizes="48x48" type="image/png"><link rel="apple-touch-icon" href="https://blog.shameerkashif.me/assets/any@180.png" sizes="180x180" type="image/png"><link rel="icon" href="https://blog.shameerkashif.me/assets/any@192.png" sizes="192x192" type="image/png"><!-- HEAD_svelte-1kxdj3d_END --><!-- HEAD_svelte-1g590ms_START --><meta name="theme-color"><!-- HEAD_svelte-1g590ms_END --><!-- HEAD_svelte-abrfj_START --><meta name="author" content="@hash3liZer"><link rel="canonical" href="https://blog.shameerkashif.me/blog/2023/subrake-a-dns-automated-scanner">
    
    <meta name="keywords" content="dns-zone-takeover, dns-zone-transfer, subdomain-takeover, bugbounty, infosec, reconnaissance, automated-tool">
    <meta name="description" content="In this guide, we will be looking over vulnerabilites associated with a domain normally occured due to the negligence from the develper team. The terms we will see are Zone Transfer, DNS Zone Takeover and Subdomain Takeover."><!-- HTML_TAG_START --><link rel="me" href="https://github.com/hash3liZer" /><!-- HTML_TAG_END --><!-- HEAD_svelte-abrfj_END --><!-- HEAD_svelte-4dky5b_START --><meta property="og:site_name" content="./khatta.sh"><meta property="og:locale" content="zh"><meta property="og:type" content="article">
    <meta property="og:title" content="A Guide to Zone Transfer, DNS Zone Takeover and Subdomain Takeover">
    <meta property="og:description" content="In this guide, we will be looking over vulnerabilites associated with a domain normally occured due to the negligence from the develper team. The terms we will see are Zone Transfer, DNS Zone Takeover and Subdomain Takeover.">
    <meta property="og:image" content="https://github.com/hash3liZer/khatta/assets/29171692/755e47ec-8f67-45e9-a7cb-04efe7584127">
      <meta name="twitter:card" content="summary_large_image">
    <meta property="article:tag" content="dns-zone-takeover"><meta property="article:tag" content="dns-zone-transfer"><meta property="article:tag" content="subdomain-takeover"><meta property="article:tag" content="bugbounty"><meta property="article:tag" content="infosec"><meta property="article:tag" content="reconnaissance"><meta property="article:tag" content="automated-tool">
    <meta property="og:url" content="https://blog.shameerkashif.me/blog/2023/subrake-a-dns-automated-scanner">
    <meta property="article:author" content="@hash3liZer">
    <meta property="article:published_time" content="2023-06-30T00:00:00.000Z">
    <meta property="article:modified_time" content="2023-07-01T18:17:22.105Z"><!-- HEAD_svelte-4dky5b_END -->
  </head>

  <body itemscope itemtype="https://schema.org/WebPage">
    










<header id="header" class="fixed z-50 w-screen transition-all duration-500 ease-in-out border-b-2 border-transparent max-h-[4.125rem] false"><div class="navbar"><div class="navbar-start">

<div class="dropdown lg:hidden"><label for="navbar-dropdown" tabindex="0" class="btn btn-square btn-ghost"><span class="i-heroicons-outline-menu-alt-1"></span></label>
  <ul id="navbar-dropdown" tabindex="0" class="menu menu-compact dropdown-content bg-base-100 text-base-content shadow-lg rounded-box min-w-max max-w-52 p-2"><li><a href="/projects">Projects</a>
        </li><li><a href="/resume">Resume</a>
        </li><li><a href="https://shameerkashif.me">My Profile ➡️</a>
        </li></ul></div>
<div class="swap order-last hidden lg:inline-grid"><button class="swap-on btn btn-ghost text-base font-normal normal-case transition-all duration-200 hidden"></button>
  <ul class="swap-off menu menu-horizontal p-0"><li><a class="!rounded-btn" href="/projects">Projects</a>
        </li><li><a class="!rounded-btn" href="/resume">Resume</a>
        </li><li><a class="!rounded-btn" href="https://shameerkashif.me">My Profile ➡️</a>
        </li></ul></div>
        <a href="/" class="btn btn-ghost normal-case text-lg">./khatta.sh</a></div>
      <div class="navbar-end"><button aria-label="search" tabindex="0" class="btn btn-square btn-ghost"><span class="i-heroicons-outline-search"></span></button>
        <div id="change-theme" class="dropdown dropdown-end">
          
          <div tabindex="0" class="btn btn-square btn-ghost"><span class="i-heroicons-outline-color-swatch"></span></div>
          
          
          <ul tabindex="0" class="flex flex-nowrap shadow-2xl menu dropdown-content bg-base-100 text-base-content rounded-box w-52 p-2 gap-2 overflow-y-auto max-h-[21.5rem]"><button data-theme="lofi" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Light</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="dracula" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Dracula</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="coffee" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Coffee</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="cupcake" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Cupcake</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="valentine" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Valentine</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="aqua" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Aqua</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="synthwave" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Synthwave</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="night" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Night</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="garden" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Garden</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="lemonade" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Lemonade</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="cmyk" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">CMYK</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="retro" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Retro</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="black" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Black</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button></ul></div></div></div></header>

<button id="totop" aria-label="scroll to top" class="fixed grid group btn btn-circle btn-lg border-none backdrop-blur bottom-6 right-6 z-50 duration-500 ease-in-out btn-ghost bg-base-100/30 md:bg-base-200/30 translate-y-24"><div class="radial-progress text-accent transition-all duration-500 ease-in-out group-hover:text-accent-focus col-start-1 row-start-1" style="--size:4rem; --thickness: 0.25rem; --value:undefined;"></div>
  <div class="border-4 border-base-content/10 group-hover:border-transparent col-start-1 row-start-1 rounded-full w-full h-full p-4 grid duration-500 ease-in-out"><span class="i-heroicons-solid-chevron-up !w-6 !h-6"></span></div></button>

<div class="bg-base-100 md:bg-base-200 min-h-screen pt-16 md:pb-8 lg:pb-16">



<div class="flex flex-col flex-nowrap justify-center xl:flex-row xl:flex-wrap"><div class="flex-1 w-full order-first ease-out transform mx-auto xl:mr-0 xl:ml-0"></div>
  <div class="flex-1 w-full xl:order-last ease-out transform mx-auto xl:ml-0 xl:mr-0"></div>
  <div class="flex-none w-full max-w-screen-md mx-auto xl:mx-0"><article itemscope itemtype="https://schema.org/BlogPosting" itemprop="blogPost" class="h-entry card bg-base-100 rounded-none md:rounded-box md:shadow-lg md:shadow-grey-10 overflow-hidden z-10 md:mb-8 lg:mb-16"><div id="bridgy" class="hidden"><a href="https://brid.gy/publish/mastodon">mastodon</a></div>
  
  
  <div class="card-body gap-0 "><div class="flex flex-col gap-2"><figure class="md:order-last rounded-lg mb-4 flex-col gap-2 -mt-8 md:mt-0'
          }"><img src="https://github.com/hash3liZer/khatta/assets/29171692/755e47ec-8f67-45e9-a7cb-04efe7584127" alt="https://github.com/hash3liZer/khatta/assets/29171692/755e47ec-8f67-45e9-a7cb-04efe7584127" class="u-featured" loading="lazy" decoding="async"></figure>
      <div class="flex font-semibold gap-1.5"><a rel="author" class="opacity-75 hover:opacity-100 hover:text-primary duration-500 ease-in-out p-author h-card" href="https://blog.shameerkashif.me">@hash3liZer</a>
  <span class="opacity-50">/</span>
  <a href="/blog/2023/subrake-a-dns-automated-scanner" class="u-url u-uid swap group/time"><time class="group-hover/time:opacity-0 font-semibold opacity-75 duration-500 ease-in-out mr-auto dt-published" datetime="2023-06-30T00:00:00.000Z" itemprop="datePublished">Fri, Jun 30, 2023</time>
    <time class="opacity-0 group-hover/time:opacity-100 font-semibold text-primary duration-500 ease-in-out mr-auto dt-updated" datetime="2023-07-01T18:17:22.105Z" itemprop="dateModified">Sat, Jul 1, 2023</time></a></div>
      <h1 itemprop="name headline" class="card-title text-2xl mb-8 p-name">A Guide to Zone Transfer, DNS Zone Takeover and Subdomain Takeover</h1>
      <p itemprop="description" class="p-summary mb-auto hidden">In this guide, we will be looking over vulnerabilites associated with a domain normally occured due to the negligence from the develper team. The terms we will see are Zone Transfer, DNS Zone Takeover and Subdomain Takeover.</p></div>
    <main itemprop="articleBody" class="urara-prose prose e-content"><h2 id="introduction"><a href="#introduction">Introduction</a></h2>
<p>DNS have been there for years now to help you find things normally you wouldn’t remember. In this guide, we will go through the following set of problems that a third party can find and take advantage of in negative terms:</p>
<ul><li>DNS Zone Transfer</li>
<li>Subdomain Takeover</li>
<li>DNS Zone Transfer</li></ul>
<h2 id="subrake"><a href="#subrake">Subrake</a></h2>
<p>The primary reason i wrote this blog post was this project i am working on: <a href="https://github.com/hash3liZer/Subrake" rel="nofollow noopener noreferrer external" target="_blank">Subrake</a>. It’s an automated DNS scanner to cover various issues in a single go. Let me know what you think about it in the comment section…</p>
<h2 id="explanation"><a href="#explanation">Explanation</a></h2>
<h3 id="zone-transfer"><a href="#zone-transfer">Zone Transfer</a></h3>
<p>Zone Transfer itself is not a vulnerability and is a procedure followed to transfer the records of a domain from one DNS server to another. For example, you need to replicate the records of your domain available in <code>namecheap</code> to AWS <code>Route53</code>.</p>
<p>In a Zone transfer, the dns server sends a complete dns records file to another server. The file contains everything the DNS server has regarding that domain including its <code>A</code>, <code>AAAA</code>, <code>CNAME</code>, and <code>SOA</code> records. This includes the information which publicly isn’t accessible. </p>
<p>For example, you can’t access the <code>CNAME</code> records of any domain without having to brute force your way into it. But if the DNS server itself is offering the service, kaboom. </p>
<p>Most of the pople in industry are already aware of Zone transfer, so lets directly jump to the part <strong>How to find it?</strong>. There are many tools available in the wild to find <code>zone transfer</code>. But the famous and the most simple one is <code>dig</code>: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">dig zonetransfer.me -t AXFR +nocookie @dns_address</span></div></code></div></pre><!-- HTML_TAG_END -->
<ul><li>The <code>-t AXFR</code> option is a type of query to request zone transfer details.</li>
<li>The <code>+nocookie</code> option would disable the use of DNS cookies.</li>
<li>And additionally, you can specify <code>@dns_server</code> which can be skipped to use default DNS servers. I would highly recommend this option if you a playing a CTF or inside a network where a private DNS server is accessible.</li></ul>
<p>If successfull, this would list all the DNS records. This can also be accomplished using <code>subrake -d zonetransfer.me</code> and you would get: </p>
<img width="828" alt="image" src="https://github.com/hash3liZer/khatta/assets/29171692/e0552efd-45d1-41fc-ad00-63706be3849a">
<h3 id="subdomain-takeover"><a href="#subdomain-takeover">Subdomain Takeover</a></h3>
<p>Subdomain Takeover unlike it sounds is actually the takeover of the service that subdomain is pointing to. Lets say <code>marketing.domain.tld</code> was pointing to an Amazon <code>S3</code> bucket or <code>ELastic Beanstalk</code> service which actually didn’t exist. </p>
<p>A third party can come and claim this service. Now what happens is that the party that claimed the service can host whatever they want on that subdomain but that ofcourse is limited to what the service has to offer. </p>
<p>Most of the people in industry have been creating their automations of this. Some use their own tools and some have sort of created a workflow. </p>
<p>You can go for a <code>oneliner</code>: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">subfinder </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d HOST </span><span style="color: #89DDFF">&gt;&gt;</span><span style="color: #EEFFFF"> FILE; assetfinder --subs</span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">only HOST </span><span style="color: #89DDFF">&gt;&gt;</span><span style="color: #EEFFFF"> FILE; amass enum </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">norecursive </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">noalts </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d HOST </span><span style="color: #89DDFF">&gt;&gt;</span><span style="color: #EEFFFF"> FILE; subjack </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">w FILE </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">t </span><span style="color: #F78C6C">100</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">timeout </span><span style="color: #F78C6C">30</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">ssl </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">c $GOPATH</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">src</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">github</span><span style="color: #89DDFF">.</span><span style="color: #F07178">com</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">haccer</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">subjack</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">fingerprints</span><span style="color: #89DDFF">.</span><span style="color: #F07178">json</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">v </span><span style="color: #F78C6C">3</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&gt;&gt;</span><span style="color: #EEFFFF"> takeover ; </span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Or you can find the subdomains first using different tools and public sources and probably use a tool to check the takeover. </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">python3 sublist3r</span><span style="color: #89DDFF">.</span><span style="color: #F07178">py</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d target</span><span style="color: #89DDFF">.</span><span style="color: #F07178">com</span></div><div class='line'><span style="color: #EEFFFF">amass enum </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d target</span><span style="color: #89DDFF">.</span><span style="color: #F07178">com</span></div><div class='line'><span style="color: #EEFFFF">...</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Checking the takeover: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">subrake </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d target</span><span style="color: #89DDFF">.</span><span style="color: #F07178">com</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">w </span><span style="color: #89DDFF">./</span><span style="color: #EEFFFF">finalwordlists</span><span style="color: #89DDFF">.</span><span style="color: #F07178">txt</span></div></code></div></pre><!-- HTML_TAG_END -->
<img width="828" alt="image" src="https://github.com/hash3liZer/khatta/assets/29171692/ce1559b0-e5fe-4fdc-ae2c-98de252c9970">
<p>The list of services that are currently known to vulnerable to Subdomain Takeover can be found at: <strong><a href="https://github.com/EdOverflow/can-i-take-over-xyz" rel="nofollow noopener noreferrer external" target="_blank">Can I Takeover XYZ</a></strong></p>
<h3 id="dns-zone-takeover"><a href="#dns-zone-takeover">DNS Zone Takeover</a></h3>
<p>Zone Takeover is a term not too old right now and its actually is as it sounds unlike subdomain takeover. And it can be more <strong>severe</strong> as you have the control over the complete zone. In order words, you can host your own <code>records</code> and are not limited to the service being used like subdomain takeover. </p>
<p>The normal procedure that is being followed or atleast i follow this:</p>
<ul><li>I purchase the domain from namecheap or godaddy.</li>
<li>I create a new <code>Hosted Zone</code> in AWS <code>Route53</code> service.</li>
<li>The hosted zone gives me a set of nameservers.</li>
<li>I enter these nameservers into the Authoritative nameservers section in GoDaddy or namecheap.</li>
<li>Then i use the <code>Route53</code> service instead of GoDaddy or Namecheap to manage the records like <code>A</code>, <code>AAAA</code>, or <code>CNAME</code>. </li></ul>
<p>Infact, if you ever worked with <strong>Cloudflare</strong>, you would know that you create a new website in Cloudflare. In result you get the nameservers. You then set the <code>nameservers</code> with the domain you purchased. </p>
<p>After doing so, you <em>add/edit/remove</em> the records within the cloudflare panel. Lets suppose, after a year you plan to not use the Cloudflare service anymore. So, you delete your website from cloudflare but doesn’t actually remove the authoritative entries in your domain settings from godaddy. </p>
<p>Since the nameserver entries already exist and still pointing to the service (aka cloudflare in this case), a third party can claim the service which would lead to <strong>zone takeover</strong>. </p>
<p>If you understand the above scenario, you can relate it to the subdomain takeover where you claim the stale service. But here, its the stale zone. </p>
<h4 id="finding-zone-takeover"><a href="#finding-zone-takeover">Finding Zone Takeover</a></h4>
<p>The good thing with zone takeover is you don’t have to brute force your way into it or find anything publicly. The information is already there, you just have to make sure its in the right condition. </p>
<p>The first step would be to get the nameservers of the domain. We can use <code>dig</code> for that: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">dig shameerkashif.me +trace +all</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Or you can directly get the <code>NS</code> records and start looking from there. </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">dig shameerkashif.me NS</span></div></code></div></pre><!-- HTML_TAG_END -->
<img width="894" alt="image" src="https://github.com/hash3liZer/khatta/assets/29171692/aba8e709-0b33-486a-ac5c-c0ab48264625">
<p>The against each NS record, check if any of them fails to responsd. If it does, it can probably be vulnerable to zone takeover. The case it failes, you will have the status as <strong>REFUSED</strong> or <strong>SERVFAIL</strong>: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">dig shameerkashif.me @ns1.digitalocean.com</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>You can also check for <code>SOA</code> which is what i would like to do instead (to be more concise): </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">dig shameerkashif.me @ns1.digitalocean.com SOA</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Well, if it doesn’t responsd, you can try to claim the service. As of now, the current vulnerable services are available at: <a href="https://github.com/indianajson/can-i-take-over-dns" rel="nofollow noopener noreferrer external" target="_blank">Can I Takeover DNS</a></p>
<p>Well, with subrake, it first tries to resolve each nameserver and if it does then it tries to guess the service and tells if its vulnerable or not. Something like this: </p>
<img width="743" alt="image" src="https://github.com/hash3liZer/khatta/assets/29171692/3d55e662-c019-4062-8c46-4c9075c47a8e">
<h2 id="using-subrake"><a href="#using-subrake">Using Subrake</a></h2>
<p>Subrake can help you pick all 3 above cases. The complete information and details can be found at the link i mentioned in the start of this blog. I am simply attaching a screenshot with the details. </p>
<img src="https://user-images.githubusercontent.com/29171692/250178751-75abd71e-7765-4da0-8b08-1cc5e1e069c7.png">
<h2 id="conclusion"><a href="#conclusion">Conclusion</a></h2>
<p>First of all, i hope this guide was helpful 😅. We saw 3 different cases namely, Zone Transfer, Zone Takeover and Subdomain Takeover. The mitigation simply is to be aware of when you remove a service. Make sure the entries in your DNS gets updated as well. Or wrap the service completely.</p></main>
    <div class="divider mt-4 mb-0"></div>
      <div><a href="/?tags=dns-zone-takeover" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#dns-zone-takeover
          </a><a href="/?tags=dns-zone-transfer" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#dns-zone-transfer
          </a><a href="/?tags=subdomain-takeover" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#subdomain-takeover
          </a><a href="/?tags=bugbounty" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#bugbounty
          </a><a href="/?tags=infosec" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#infosec
          </a><a href="/?tags=reconnaissance" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#reconnaissance
          </a><a href="/?tags=automated-tool" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#automated-tool
          </a></div></div>
  
    </article>
    <footer id="footer" class="footer footer-center bg-base-300 text-base-content shadow-inner p-8 md:rounded-box sticky bottom-0 z-0 md:static "><div class="prose"><p><a href="/atom.xml" rel="noopener noreferrer external" target="_blank">Feed</a>
          <span class="mr-1">·</span><a href="/privacy" rel="noopener noreferrer external" target="_blank">Privacy</a>
          
        <br>
      Copyright © 2023
      @hash3liZer
      <br>
      Powered by
      <a rel="noopener noreferrer external" target="_blank" class="tooltip tooltip-secondary hover:text-secondary" data-tip="🌸 [δ] - Based on MDsveX & SvelteKit 🌸" href="https://github.com/importantimport/urara">Urara
      </a>
      <br>
        <!-- HTML_TAG_START -->Hosted at <a href="https://github.com/hash3liZer/khatta">Khatta</a><!-- HTML_TAG_END --></p></div></footer></div></div></div>


			<script type="application/json" data-sveltekit-fetched data-url="/posts.json">{"status":200,"statusText":"","headers":{},"body":"[{\"title\":\"A Guide to Zone Transfer, DNS Zone Takeover and Subdomain Takeover\",\"tags\":[\"dns-zone-takeover\",\"dns-zone-transfer\",\"subdomain-takeover\",\"bugbounty\",\"infosec\",\"reconnaissance\",\"automated-tool\"],\"categories\":[\"Bug Bounty\",\"Projects\"],\"summary\":\"In this guide, we will be looking over vulnerabilites associated with a domain normally occured due to the negligence from the develper team. The terms we will see are Zone Transfer, DNS Zone Takeover and Subdomain Takeover.\",\"created\":\"2023-06-30T00:00:00.000Z\",\"lastmod\":\"2023-06-30T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/755e47ec-8f67-45e9-a7cb-04efe7584127\",\"flags\":[],\"updated\":\"2023-07-01T18:17:22.105Z\",\"slug\":\"/blog/2023/subrake-a-dns-automated-scanner/+page.md\",\"path\":\"/blog/2023/subrake-a-dns-automated-scanner\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":2,\"title\":\"Subrake\",\"slug\":\"subrake\"},{\"depth\":2,\"title\":\"Explanation\",\"slug\":\"explanation\"},{\"depth\":3,\"title\":\"Zone Transfer\",\"slug\":\"zone-transfer\"},{\"depth\":3,\"title\":\"Subdomain Takeover\",\"slug\":\"subdomain-takeover\"},{\"depth\":3,\"title\":\"DNS Zone Takeover\",\"slug\":\"dns-zone-takeover\"},{\"depth\":4,\"title\":\"Finding Zone Takeover\",\"slug\":\"finding-zone-takeover\"},{\"depth\":2,\"title\":\"Using Subrake\",\"slug\":\"using-subrake\"},{\"depth\":2,\"title\":\"Conclusion\",\"slug\":\"conclusion\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"BSidesTLV CTF 2023 Browselicious (Misc) Writeup\",\"tags\":[\"ctf\",\"writeups\",\"bsidestlv-ctf-2023\"],\"categories\":[\"CTF Writeups\"],\"summary\":\"Writeup for Browselicious challenge (Misc) from BsidesTLV CTF 2023\",\"created\":\"2023-06-28T00:00:00.000Z\",\"lastmod\":\"2023-06-28T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/1788ec87-fc59-49a7-a035-ec767504fb3d\",\"flags\":[],\"updated\":\"2023-07-01T18:17:22.105Z\",\"slug\":\"/blog/2023/writeup-browselicious-challenge-bsidestlv-ctf/+page.md\",\"path\":\"/blog/2023/writeup-browselicious-challenge-bsidestlv-ctf\",\"toc\":[{\"depth\":1,\"title\":\"Introducton\",\"slug\":\"introducton\"},{\"depth\":1,\"title\":\"Writeup\",\"slug\":\"writeup\"},{\"depth\":3,\"title\":\"Server Request\",\"slug\":\"server-request\"},{\"depth\":3,\"title\":\"Code Review\",\"slug\":\"code-review\"},{\"depth\":3,\"title\":\"Exploit\",\"slug\":\"exploit\"},{\"depth\":4,\"title\":\"Input Field\",\"slug\":\"input-field\"},{\"depth\":4,\"title\":\"Race Condition\",\"slug\":\"race-condition\"},{\"depth\":4,\"title\":\"Post Message\",\"slug\":\"post-message\"},{\"depth\":2,\"title\":\"PoC\",\"slug\":\"poc\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Google CTF 2023 Under Construction (Web) Writeup\",\"tags\":[\"ctf\",\"writeups\",\"google-ctf-2023\"],\"categories\":[\"CTF Writeups\"],\"summary\":\"Writeup for under construction challenge from google ctf 2023\",\"created\":\"2023-06-27T00:00:00.000Z\",\"lastmod\":\"2023-06-27T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta.sh/assets/29171692/f553635d-6deb-43e5-a2ae-0d8cef296db7\",\"flags\":[],\"updated\":\"2023-07-01T18:17:22.105Z\",\"slug\":\"/blog/2023/writeup-under-construction-google-ctf-2023/+page.md\",\"path\":\"/blog/2023/writeup-under-construction-google-ctf-2023\",\"toc\":[{\"depth\":1,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":1,\"title\":\"Writeup\",\"slug\":\"writeup\"},{\"depth\":2,\"title\":\"Getting Started\",\"slug\":\"getting-started\"},{\"depth\":2,\"title\":\"Vulnerable Part\",\"slug\":\"vulnerable-part\"},{\"depth\":2,\"title\":\"Exploit\",\"slug\":\"exploit\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Privacy Policy\",\"created\":\"2023-06-27T00:00:00.000Z\",\"flags\":[\"unlisted\"],\"updated\":\"2023-07-01T18:17:22.105Z\",\"slug\":\"/privacy/+page.svelte.md\",\"path\":\"/privacy\",\"toc\":false,\"type\":\"article\",\"html\":\"\"},{\"title\":\"Resume\",\"created\":\"2022-05-06T00:00:00.000Z\",\"flags\":[\"unlisted\"],\"updated\":\"2023-07-01T18:17:22.105Z\",\"slug\":\"/resume/+page.svelte.md\",\"path\":\"/resume\",\"toc\":[{\"depth\":2,\"title\":\"Skills\",\"slug\":\"skills\"},{\"depth\":2,\"title\":\"Experience\",\"slug\":\"experience\"},{\"depth\":2,\"title\":\"Education\",\"slug\":\"education\"},{\"depth\":2,\"title\":\"Certifications\",\"slug\":\"certifications\"},{\"depth\":2,\"title\":\"Acheivements\",\"slug\":\"acheivements\"},{\"depth\":2,\"title\":\"Projects\",\"slug\":\"projects\"},{\"depth\":2,\"title\":\"Volunteering and Startups\",\"slug\":\"volunteering-and-startups\"},{\"depth\":2,\"title\":\"Contact\",\"slug\":\"contact\"}],\"type\":\"article\",\"html\":\"\"}]"}</script>
			<script>
				{
					__sveltekit_amcrug = {
						base: new URL("../../..", location).pathname.slice(0, -1),
						env: {}
					};

					const element = document.currentScript.parentElement;

					const data = [null,null];

					Promise.all([
						import("../../../_app/immutable/entry/start.0035f0c5.js"),
						import("../../../_app/immutable/entry/app.a1b97411.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 3],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		
    <div style="display: contents">%sveltekit.body%</div>
  </body>
</html>
