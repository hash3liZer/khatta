<!DOCTYPE html>
<html lang="en">
  <head prefix="og: https://ogp.me/ns#">
    <meta charset="utf-8" />
    <meta name="generator" content="gh:importantimport/urara" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="manifest" crossorigin="use-credentials" href="/manifest.webmanifest" />
    <link rel="alternate" type="application/feed+json" href="/feed.json" />
    <link rel="alternate" type="application/atom+xml" href="/atom.xml" />
    <link rel="sitemap" type="application/xml" href="/sitemap.xml" />
    <meta http-equiv="content-security-policy" content="style-src 'self' 'unsafe-inline' https://giscus.app">
		<link href="../../../_app/immutable/assets/0.5486f8e5.css" rel="stylesheet">
		<link rel="modulepreload" href="../../../_app/immutable/entry/start.94d6949e.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/index.725d15e1.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/singletons.e25824f4.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/index.f6403797.js">
		<link rel="modulepreload" href="../../../_app/immutable/entry/app.a40b6300.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/preload-helper.41c905a7.js">
		<link rel="modulepreload" href="../../../_app/immutable/nodes/0.7eed1335.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/posts.7eeb28a4.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/posts.d89605eb.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/icon.fa06396a.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/title.ff9679dd.js">
		<link rel="modulepreload" href="../../../_app/immutable/nodes/11.2b1194b5.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/post_layout.b6bd0bbf.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/post_card.004e8740.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/footer.a8ea1951.js"><title>WPA(2) PMKID Hash Cracking (MIC) Process Explained | ./khatta.sh | کھاتا</title><!-- HEAD_svelte-1592q3p_START --><link rel="me" href="https://kongwoo.icu/@seviche"><!-- HEAD_svelte-1592q3p_END --><!-- HEAD_svelte-1kxdj3d_START --><link rel="shortcut icon" href="https://blog.shameerkashif.me/favicon.png" sizes="48x48" type="image/png"><link rel="apple-touch-icon" href="https://blog.shameerkashif.me/assets/any@180.png" sizes="180x180" type="image/png"><link rel="icon" href="https://blog.shameerkashif.me/assets/any@192.png" sizes="192x192" type="image/png"><!-- HEAD_svelte-1kxdj3d_END --><!-- HEAD_svelte-1g590ms_START --><meta name="theme-color"><!-- HEAD_svelte-1g590ms_END --><!-- HEAD_svelte-abrfj_START --><meta name="author" content="@hash3liZer"><link rel="canonical" href="https://blog.shameerkashif.me/blog/2023/wpa-hash-cracking-process-explained-in-detal">
    
    <meta name="keywords" content="wireless, wpa-wpa2, wifi">
    <meta name="description" content="A guide on what the MIC is and how the actual WPA(2) cracking happens at lower level"><!-- HTML_TAG_START --><link rel="me" href="https://github.com/hash3liZer" /><!-- HTML_TAG_END --><!-- HTML_TAG_START --><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZZRLH1SYB9"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-ZZRLH1SYB9");</script><!-- HTML_TAG_END --><!-- HEAD_svelte-abrfj_END --><!-- HEAD_svelte-4dky5b_START --><meta property="og:site_name" content="./khatta.sh | کھاتا"><meta property="og:locale" content="en"><meta property="og:type" content="article">
    <meta property="og:title" content="WPA(2) PMKID Hash Cracking (MIC) Process Explained">
    <meta property="og:description" content="A guide on what the MIC is and how the actual WPA(2) cracking happens at lower level">
    <meta property="og:image" content="https://github.com/user-attachments/assets/51b06557-0a25-4ddd-a59d-6783add3a447">
      <meta name="twitter:card" content="summary_large_image">
    <meta property="article:tag" content="wireless"><meta property="article:tag" content="wpa-wpa2"><meta property="article:tag" content="wifi">
    <meta property="og:url" content="https://blog.shameerkashif.me/blog/2023/wpa-hash-cracking-process-explained-in-detal">
    <meta property="article:author" content="@hash3liZer">
    <meta property="article:published_time" content="2024-08-25T00:00:00.000Z">
    <meta property="article:modified_time" content="2025-02-03T19:35:52.328Z"><!-- HEAD_svelte-4dky5b_END -->
  </head>

  <body itemscope itemtype="https://schema.org/WebPage">
    










<header id="header" class="fixed z-50 w-screen transition-all duration-500 ease-in-out border-b-2 border-transparent max-h-[4.125rem] false"><div class="navbar"><div class="navbar-start">

<div class="dropdown lg:hidden"><label for="navbar-dropdown" tabindex="0" class="btn btn-square btn-ghost"><span class="i-heroicons-outline-menu-alt-1"></span></label>
  <ul id="navbar-dropdown" tabindex="0" class="menu menu-compact dropdown-content bg-base-100 text-base-content shadow-lg rounded-box min-w-max max-w-52 p-2"><li><a href="/resume">About Me</a>
        </li><li><a href="https://shameerkashif.me">Who@mi ➡️</a>
        </li></ul></div>
<div class="swap order-last hidden lg:inline-grid"><button class="swap-on btn btn-ghost text-base font-normal normal-case transition-all duration-200 hidden"></button>
  <ul class="swap-off menu menu-horizontal p-0"><li><a class="!rounded-btn" href="/resume">About Me</a>
        </li><li><a class="!rounded-btn" href="https://shameerkashif.me">Who@mi ➡️</a>
        </li></ul></div>
        <a href="/" class="btn btn-ghost normal-case text-lg">./khatta.sh | کھاتا</a></div>
      <div class="navbar-end"><button aria-label="search" tabindex="0" class="btn btn-square btn-ghost"><span class="i-heroicons-outline-search"></span></button>
        <div id="change-theme" class="dropdown dropdown-end">
          
          <div tabindex="0" class="btn btn-square btn-ghost"><span class="i-heroicons-outline-color-swatch"></span></div>
          
          
          <ul tabindex="0" class="flex flex-nowrap shadow-2xl menu dropdown-content bg-base-100 text-base-content rounded-box w-52 p-2 gap-2 overflow-y-auto max-h-[21.5rem]"><button data-theme="lofi" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Light</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="dracula" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Dracula</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="coffee" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Coffee</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="cupcake" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Cupcake</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="valentine" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Valentine</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="aqua" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Aqua</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="synthwave" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Synthwave</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="night" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Night</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="garden" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Garden</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="lemonade" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Lemonade</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="cmyk" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">CMYK</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="retro" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Retro</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="black" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Black</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button></ul></div></div></div></header>

<button id="totop" aria-label="scroll to top" class="fixed grid group btn btn-circle btn-lg border-none backdrop-blur bottom-6 right-6 z-50 duration-500 ease-in-out btn-ghost bg-base-100/30 md:bg-base-200/30 translate-y-24"><div class="radial-progress text-accent transition-all duration-500 ease-in-out group-hover:text-accent-focus col-start-1 row-start-1" style="--size:4rem; --thickness: 0.25rem; --value:undefined;"></div>
  <div class="border-4 border-base-content/10 group-hover:border-transparent col-start-1 row-start-1 rounded-full w-full h-full p-4 grid duration-500 ease-in-out"><span class="i-heroicons-solid-chevron-up !w-6 !h-6"></span></div></button>

<div class="bg-base-100 md:bg-base-200 min-h-screen pt-16 md:pb-8 lg:pb-16">



<div class="flex flex-col flex-nowrap justify-center xl:flex-row xl:flex-wrap"><div class="flex-1 w-full order-first ease-out transform mx-auto xl:mr-0 xl:ml-0"></div>
  <div class="flex-1 w-full xl:order-last ease-out transform mx-auto xl:ml-0 xl:mr-0"></div>
  <div class="flex-none w-full max-w-screen-md mx-auto xl:mx-0"><article itemscope itemtype="https://schema.org/BlogPosting" itemprop="blogPost" class="h-entry card bg-base-100 rounded-none md:rounded-box md:shadow-lg md:shadow-grey-10 overflow-hidden z-10 md:mb-8 lg:mb-16"><div id="bridgy" class="hidden"><a href="https://brid.gy/publish/mastodon">mastodon</a></div>
  
  
  <div class="card-body gap-0 "><div class="flex flex-col gap-2"><figure class="md:order-last rounded-lg mb-4 flex-col gap-2 -mt-8 md:mt-0'
          }"><img src="https://github.com/user-attachments/assets/51b06557-0a25-4ddd-a59d-6783add3a447" alt="https://github.com/user-attachments/assets/51b06557-0a25-4ddd-a59d-6783add3a447" class="u-featured" loading="lazy" decoding="async"></figure>
      <div class="flex font-semibold gap-1.5"><a rel="author" class="opacity-75 hover:opacity-100 hover:text-primary duration-500 ease-in-out p-author h-card" href="https://blog.shameerkashif.me">@hash3liZer</a>
  <span class="opacity-50">/</span>
  <a href="/blog/2023/wpa-hash-cracking-process-explained-in-detal" class="u-url u-uid swap group/time"><time class="group-hover/time:opacity-0 font-semibold opacity-75 duration-500 ease-in-out mr-auto dt-published" datetime="2024-08-25T00:00:00.000Z" itemprop="datePublished">Sun, Aug 25, 2024</time>
    <time class="opacity-0 group-hover/time:opacity-100 font-semibold text-primary duration-500 ease-in-out mr-auto dt-updated" datetime="2025-02-03T19:35:52.328Z" itemprop="dateModified">Mon, Feb 3, 2025</time></a></div>
      <h1 itemprop="name headline" class="card-title text-2xl mb-8 p-name">WPA(2) PMKID Hash Cracking (MIC) Process Explained</h1>
      <p itemprop="description" class="p-summary mb-auto hidden">A guide on what the MIC is and how the actual WPA(2) cracking happens at lower level</p></div>
    <main itemprop="articleBody" class="urara-prose prose e-content"><p><strong>After the discovery of the PMKID hash crack vulnerability, I spent some time understanding the process and WPA/WPA2 protocol &amp; came across this idea to publish how the real hash cracking works. This article is all about how you can build up something like aircrack-ng or coWPAtty or in other words your own cracking tool. Since a lot of articles have been published on the 4-way handshake and how basic MIC cracking works, the aim here is to get to know how things work at the lower level.</strong></p>
<p>Well, in basic, there are three major keys that we have to compute: </p>
<ul><li>Pairwise Master Keys (PMK)</li>
<li>Pairwise Transient Keys (PTK)</li>
<li>Message Integrity Code (MIC)</li></ul>
<p>These three of them are computed in the same sequence as given. The idea behind the 4-way handshake is that two connecting stations have to prove that they know the key by not transmitting the actual key. Instead, the key is strongly encrypted and verified on Authenticator’s (AP) Side. Various functions are used in this process to securely encrypt the passphrase key.</p>
<h2 id="the-handshake-process"><a href="#the-handshake-process">The Handshake Process</a></h2>
<p>Before the actual handshake takes place, i.e. EAPOL packets are transmitted, Open authentication and association steps are performed which in short verifies the compatibility of both interconnecting stations. In short, the following happens after successful association: </p>
<ul><li>ANONCE, a randomly generated value is sent by Access Point to the connecting station.</li>
<li>The Station then sends SNONCE along with Pairwise Transient Key (PTK) and MIC to AP. While PTK is derived from PMK.</li>
<li>On receiving the second EAPOL, access point computes Group Transient Key (GTK).</li>
<li>Lastly, AP sends an acknowledgement to the station which also contains a MIC code.</li></ul>
<p>From the above process, our main objective is to get the MIC hash. You see, MIC is transmitted at second and fourth step. Tools like aircrack-ng and coWPAtty use the MIC at the fourth step to crack the hash. While here we will look for the second frame MIC.</p>
<p>Calculating the MIC of the 2nd EAPOL frame can also be more useful, like a half captured handshake can be used in the process. Half handshakes can be captured and further manipulated by hosting a rogue access point. Let’s come back to where we were.</p>
<h3 id="pml-pairwise-master-key-computation"><a href="#pml-pairwise-master-key-computation">(PML) Pairwise Master Key Computation</a></h3>
<p>In sequence we have PMK on the first side. PMK is used to derive PTK and is never sent over the air. instead, the derived PTK is transmitted to AP. PMK is computed using the Password-Based Key Derivation Function 2 (PBKDF2) which uses the HMAC-SHA1 hash algorithm to encode data. In result, a 256-bit hash will be created to this function. Well, in general, we could logically write this up:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">_PMK_ </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">PBKDF2</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">SHA1</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> Pre</span><span style="color: #89DDFF">-</span><span style="color: #82AAFF">Shared</span><span style="color: #89DDFF">-</span><span style="color: #82AAFF">Key</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> SSID</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">4096</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">256</span><span style="color: #89DDFF">)</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Where Pre-Shared-Key (PSK) is the actual plaintext password and SSID is used here as a salt for hashing. In the classic sense of Python, we could write:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #546E7A">#!/usr/bin/python</span></div><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> pbkdf2 </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> PBKDF2</span></div><div class='line'></div><div class='line'><span style="color: #546E7A"># Supposing Values Here.</span></div><div class='line'><span style="color: #EEFFFF">ssid </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">shellvoide</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">      </span></div><div class='line'><span style="color: #EEFFFF">psk </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">mypassword</span><span style="color: #89DDFF">"</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">pmk </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">PBKDF2</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">psk</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> ssid</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">4096</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">read</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">32</span><span style="color: #89DDFF">)</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Make sure you have pbkdf2 library in path. Install it using python-pip if you don’t have it already. </p>
<h3 id="ptk-pairwise-transient-key-computation"><a href="#ptk-pairwise-transient-key-computation">(PTK) Pairwise Transient Key Computation</a></h3>
<p>The next hash in sequence is PTK which is transmitted in 2nd EAPOL frame. The construction of PTK is pretty tricky but thanks to stackoverfow from where i found the code. The PTK is dependant on ANONCE, SNONCE, AP MAC, Station MAC and PMK which are first concatenated and must exist in hex form. In result, a 512 bit string will be constructed which is the combination of various other keys. These keys are:</p>
<ul><li>Key Confirmation Key (KCK): 128 bits.</li>
<li>Key Encryption Key (KEK): 128 bits.</li>
<li>Temporal Key (TK): 128 bits.</li>
<li>MIC Tx: 64 bits.</li>
<li>MIC Rx: 64 bits.</li></ul>
<p>While searching on web, i came across two implemenations of the function “PRF512” which is another pseudo random function for computing PTK. This one worked perfectly: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">customPRF512</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">key</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF">A</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF">B</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">    blen </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">64</span></div><div class='line'><span style="color: #EEFFFF">    i    </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">0</span></div><div class='line'><span style="color: #EEFFFF">    R    </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">''</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">while</span><span style="color: #EEFFFF"> i</span><span style="color: #89DDFF">&lt;=((</span><span style="color: #EEFFFF">blen</span><span style="color: #89DDFF">*</span><span style="color: #F78C6C">8</span><span style="color: #89DDFF">+</span><span style="color: #F78C6C">159</span><span style="color: #89DDFF">)/</span><span style="color: #F78C6C">160</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">        hmacsha1 </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> hmac</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">new</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">key</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF">A</span><span style="color: #89DDFF">+</span><span style="color: #82AAFF">chr</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">0x</span><span style="color: #F78C6C">00</span><span style="color: #89DDFF">)+</span><span style="color: #82AAFF">B</span><span style="color: #89DDFF">+</span><span style="color: #82AAFF">chr</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">i</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF">hashlib</span><span style="color: #89DDFF">.</span><span style="color: #F07178">sha1</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        i</span><span style="color: #89DDFF">+=</span><span style="color: #F78C6C">1</span></div><div class='line'><span style="color: #EEFFFF">        R </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> R</span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF">hmacsha1</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">digest</span><span style="color: #89DDFF">()</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> R</span><span style="color: #89DDFF">[:</span><span style="color: #EEFFFF">blen</span><span style="color: #89DDFF">]</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>And now putting the pieces together: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> pbkdf2 </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> PBKDF2</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> hmac</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> binascii</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> hmac</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> hashlib</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> sha</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">customPRF512</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">key</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF">A</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF">B</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">    blen </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">64</span></div><div class='line'><span style="color: #EEFFFF">    i    </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">0</span></div><div class='line'><span style="color: #EEFFFF">    R    </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">''</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">while</span><span style="color: #EEFFFF"> i</span><span style="color: #89DDFF">&lt;=((</span><span style="color: #EEFFFF">blen</span><span style="color: #89DDFF">*</span><span style="color: #F78C6C">8</span><span style="color: #89DDFF">+</span><span style="color: #F78C6C">159</span><span style="color: #89DDFF">)/</span><span style="color: #F78C6C">160</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">        hmacsha1 </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> hmac</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">new</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">key</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF">A</span><span style="color: #89DDFF">+</span><span style="color: #82AAFF">chr</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">0x</span><span style="color: #F78C6C">00</span><span style="color: #89DDFF">)+</span><span style="color: #82AAFF">B</span><span style="color: #89DDFF">+</span><span style="color: #82AAFF">chr</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">i</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF">hashlib</span><span style="color: #89DDFF">.</span><span style="color: #F07178">sha1</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        i</span><span style="color: #89DDFF">+=</span><span style="color: #F78C6C">1</span></div><div class='line'><span style="color: #EEFFFF">        R </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> R</span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF">hmacsha1</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">digest</span><span style="color: #89DDFF">()</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> R</span><span style="color: #89DDFF">[:</span><span style="color: #EEFFFF">blen</span><span style="color: #89DDFF">]</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">ssid </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">shellvoide</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">      </span></div><div class='line'><span style="color: #EEFFFF">psk </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">mypassword</span><span style="color: #89DDFF">"</span></div><div class='line'><span style="color: #EEFFFF">mac_ap </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> binascii</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">unhexlify</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">000ef4ded961</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">mac_cl </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> binascii</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">unhexlify</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">9840bb444f49</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">anonce </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> binascii</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">unhexlify</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">26c7a2cf7d9d0657980e9d077562f5ae3f17929a66e870569980dc5fc2fcf238</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">cnonce </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> binascii</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">unhexlify</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">80ccbcbea79e39b4d88cf43478b19f32649cce78bc4942f4f51ba31207a9f2cf</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">key_data </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">min</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">mac_ap</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> mac_cl</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">max</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">mac_ap</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> mac_cl</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">min</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">anonce</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF">snonce</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">max</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">anonce</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF">snonce</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">pke </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Pairwise key expansion</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">    </span><span style="color: #546E7A"># Standard Set Value</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">pmk </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">PBKDF2</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">psk</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> ssid</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">4096</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">read</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">32</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">ptk </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">customPRF512</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">pmk</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> PKE</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> key_data</span><span style="color: #89DDFF">)</span></div></code></div></pre><!-- HTML_TAG_END -->
<h3 id="mic-message-integrity-code"><a href="#mic-message-integrity-code">(MIC) Message Integrity Code</a></h3>
<p>Until now, we have two of our keys. MIC is a pain in the butt and it took me over a week to figure the right sequence. However, as I’ve already told that the MIC that we are going to compute is the MIC from the second EAPOL. From until to this point and all the previous proceedings, it’s worth mentioning about this article which helped me a lot to reach this point. Remember that the PTK is the combination of various other keys and the first of them is KCK which will be used as a salt for MIC. </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #82AAFF">HMAC</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">KCK</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> payload</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> MD5</span><span style="color: #89DDFF">/</span><span style="color: #82AAFF">SHA128</span><span style="color: #89DDFF">)</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Where KCK, as you know, can be extracted from PTK and MD5/SHA1 are the hashes which are available through hashlib library. The only thing we are left with is payload. Here, the payload is referred to the whole data captured in the 2nd EAPOL frame. Well, doing it the Python way: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">mic </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> hmac</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">new</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">ptk</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">:</span><span style="color: #F78C6C">16</span><span style="color: #89DDFF">],</span><span style="color: #82AAFF"> payload</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> hashlib</span><span style="color: #89DDFF">.</span><span style="color: #F07178">md5</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">hexdigest</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #546E7A">#WPA1</span></div><div class='line'><span style="color: #EEFFFF">mic </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> hmac</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">new</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">ptk</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">:</span><span style="color: #F78C6C">16</span><span style="color: #89DDFF">],</span><span style="color: #82AAFF"> payload</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> hashlib</span><span style="color: #89DDFF">.</span><span style="color: #F07178">sha1</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">hexdigest</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #546E7A">#WPA2</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Let’s recall the whole script: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> pbkdf2 </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> PBKDF2</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> hmac</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> binascii</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> hmac</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> hashlib</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> sha</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">customPRF512</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">key</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF">A</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF">B</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">    blen </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">64</span></div><div class='line'><span style="color: #EEFFFF">    i    </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">0</span></div><div class='line'><span style="color: #EEFFFF">    R    </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">''</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">while</span><span style="color: #EEFFFF"> i</span><span style="color: #89DDFF">&lt;=((</span><span style="color: #EEFFFF">blen</span><span style="color: #89DDFF">*</span><span style="color: #F78C6C">8</span><span style="color: #89DDFF">+</span><span style="color: #F78C6C">159</span><span style="color: #89DDFF">)/</span><span style="color: #F78C6C">160</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">        hmacsha1 </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> hmac</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">new</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">key</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF">A</span><span style="color: #89DDFF">+</span><span style="color: #82AAFF">chr</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">0x</span><span style="color: #F78C6C">00</span><span style="color: #89DDFF">)+</span><span style="color: #82AAFF">B</span><span style="color: #89DDFF">+</span><span style="color: #82AAFF">chr</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">i</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF">hashlib</span><span style="color: #89DDFF">.</span><span style="color: #F07178">sha1</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        i</span><span style="color: #89DDFF">+=</span><span style="color: #F78C6C">1</span></div><div class='line'><span style="color: #EEFFFF">        R </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> R</span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF">hmacsha1</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">digest</span><span style="color: #89DDFF">()</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> R</span><span style="color: #89DDFF">[:</span><span style="color: #EEFFFF">blen</span><span style="color: #89DDFF">]</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">ssid </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">shellvoide</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">      </span></div><div class='line'><span style="color: #EEFFFF">psk </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">mypassword</span><span style="color: #89DDFF">"</span></div><div class='line'><span style="color: #EEFFFF">mac_ap </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> binascii</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">unhexlify</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">000ef4ded961</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">mac_cl </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> binascii</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">unhexlify</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">9840bb444f49</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">anonce </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> binascii</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">unhexlify</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">26c7a2cf7d9d0657980e9d077562f5ae3f17929a66e870569980dc5fc2fcf238</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">cnonce </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> binascii</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">unhexlify</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">80ccbcbea79e39b4d88cf43478b19f32649cce78bc4942f4f51ba31207a9f2cf</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #546E7A"># Supposing payload. You'll have to extract it.</span></div><div class='line'><span style="color: #EEFFFF">payload </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> binascii</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">unhexlify</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">key_data </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">min</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">mac_ap</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> mac_cl</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">max</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">mac_ap</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> mac_cl</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">min</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">anonce</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF">snonce</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">max</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">anonce</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF">snonce</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">pke </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Pairwise key expansion</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">    </span><span style="color: #546E7A"># Standard Set Value</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">pmk </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">PBKDF2</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">psk</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> ssid</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">4096</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">read</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">32</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">ptk </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">customPRF512</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">pmk</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> PKE</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> key_data</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">mic </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> hmac</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">new</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">ptk</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">:</span><span style="color: #F78C6C">16</span><span style="color: #89DDFF">],</span><span style="color: #82AAFF"> payload</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> hashlib</span><span style="color: #89DDFF">.</span><span style="color: #F07178">md5</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">hexdigest</span><span style="color: #89DDFF">()</span></div><div class='line'></div><div class='line'><span style="color: #82AAFF">print</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">MIC: </span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF">mic</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>If you give everything correctly, this code will produce the MIC and will print in on screen. You can then verify by comparing this MIC from MIC produced by coWPAtty and aircrack. </p>
<p>As of my understandings, the only thing that’s probably can cause some issue is step 3 while looking at the payload. If you are writing something on this, you can first go for each hash independently and then bind them together. While implementing the functions, note which version of WPA you are computing MIC for. WPA use MD5 algorithm while WPA2 use SHA1 algorithm. </p></main>
    <div class="divider mt-4 mb-0"></div>
      <div><a href="/?tags=wireless" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#wireless
          </a><a href="/?tags=wpa-wpa2" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#wpa-wpa2
          </a><a href="/?tags=wifi" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#wifi
          </a></div></div>
  
    </article>
    <footer id="footer" class="footer footer-center bg-base-300 text-base-content shadow-inner p-8 md:rounded-box sticky bottom-0 z-0 md:static "><div class="prose"><p><a href="/atom.xml" rel="noopener noreferrer external" target="_blank">Feed</a>
          
        <br>
      Copyright © 2023 - 2025
      @hash3liZer
      <br>
      Powered by
      <a rel="noopener noreferrer external" target="_blank" class="tooltip tooltip-secondary hover:text-secondary" data-tip="🌸 [δ] - Based on MDsveX & SvelteKit 🌸" href="https://github.com/importantimport/urara">Urara
      </a>
      <br>
        <!-- HTML_TAG_START -->Hosted at <a href="https://github.com/hash3liZer/khatta">Khatta</a><!-- HTML_TAG_END --></p></div></footer></div></div></div>


			<script type="application/json" data-sveltekit-fetched data-url="/posts.json">{"status":200,"statusText":"","headers":{},"body":"[{\"title\":\"CTF web challenge writeups for Ignite Islamabad 24 regional round\",\"tags\":[\"ignite-24\",\"web\",\"ctf\",\"regional\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"Writeups for all web related challenges from Ignite 2024 regional round of Islamabad\",\"created\":\"2024-11-26T00:00:00.000Z\",\"lastmod\":\"2024-11-26T00:00:00.000Z\",\"image\":\"https://github.com/user-attachments/assets/505ce24b-a239-465b-b2cd-ea90a6f43bbd\",\"flags\":[],\"updated\":\"2025-02-03T19:35:52.329Z\",\"slug\":\"/blog/2024/ctf-ignite-islamabad-regional-24-web-writeups/+page.md\",\"path\":\"/blog/2024/ctf-ignite-islamabad-regional-24-web-writeups\",\"toc\":[{\"depth\":2,\"title\":\"readme | Easy\",\"slug\":\"readme--easy\"},{\"depth\":2,\"title\":\"SMG | Medium\",\"slug\":\"smg--medium\"},{\"depth\":2,\"title\":\"wtwaf | Hard\",\"slug\":\"wtwaf--hard\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"BlackhatMEA 2024 CTF Writeups for all web challenges (Qualifiers)\",\"tags\":[\"blackhatmea-2024\",\"qualifiers\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"Writeups for all web related challenges from Blackhat MEA 2024 CTF\",\"created\":\"2024-09-04T00:00:00.000Z\",\"lastmod\":\"2023-09-04T00:00:00.000Z\",\"image\":\"https://github.com/user-attachments/assets/07220c38-8cb9-4961-b1c2-7020b0baa0ad\",\"flags\":[],\"updated\":\"2025-02-03T19:35:52.329Z\",\"slug\":\"/blog/2024/blackhat-mea-24-qualifiers-web-writeups/+page.md\",\"path\":\"/blog/2024/blackhat-mea-24-qualifiers-web-writeups\",\"toc\":[{\"depth\":2,\"title\":\"Watermelon\",\"slug\":\"watermelon\"},{\"depth\":2,\"title\":\"Free Flag\",\"slug\":\"free-flag\"},{\"depth\":2,\"title\":\"Notey\",\"slug\":\"notey\"},{\"depth\":2,\"title\":\"Fastest Delivery Service\",\"slug\":\"fastest-delivery-service\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Setup Fake (Rogue) Access Point WiFi using HostAPD\",\"tags\":null,\"categories\":[\"wireless\",\"rogue-ap\"],\"summary\":\"A detailed guide on how to setup a rogue or fake access point wifi network using hostapdo\",\"created\":\"2024-08-25T00:00:00.000Z\",\"lastmod\":\"2023-08-25T00:00:00.000Z\",\"image\":\"https://github.com/user-attachments/assets/471e01a7-df63-414e-9370-6b8deafe6686\",\"flags\":[],\"updated\":\"2025-02-03T19:35:52.328Z\",\"slug\":\"/blog/2023/setup-fake-rogue-access-point-hostapd/+page.md\",\"path\":\"/blog/2023/setup-fake-rogue-access-point-hostapd\",\"toc\":[{\"depth\":2,\"title\":\"Technical Terms\",\"slug\":\"technical-terms\"},{\"depth\":3,\"title\":\"Phishing\",\"slug\":\"phishing\"},{\"depth\":3,\"title\":\"Wireless Adapter\",\"slug\":\"wireless-adapter\"},{\"depth\":3,\"title\":\"Is it Effective?\",\"slug\":\"is-it-effective\"},{\"depth\":2,\"title\":\"The Guide\",\"slug\":\"the-guide\"},{\"depth\":3,\"title\":\"Setup Environment\",\"slug\":\"setup-environment\"},{\"depth\":3,\"title\":\"Wireless Interface\",\"slug\":\"wireless-interface\"},{\"depth\":3,\"title\":\"Fake / Rogue Access Point\",\"slug\":\"fake--rogue-access-point\"},{\"depth\":3,\"title\":\"Multiple Access Points (Optional)\",\"slug\":\"multiple-access-points-optional\"},{\"depth\":3,\"title\":\"DHCP\",\"slug\":\"dhcp\"},{\"depth\":3,\"title\":\"Traffic Forwarding\",\"slug\":\"traffic-forwarding\"},{\"depth\":3,\"title\":\"MySQL Storage\",\"slug\":\"mysql-storage\"},{\"depth\":3,\"title\":\"Phishing Site\",\"slug\":\"phishing-site\"},{\"depth\":3,\"title\":\"Apache and MySQL\",\"slug\":\"apache-and-mysql\"},{\"depth\":3,\"title\":\"Deauthentication\",\"slug\":\"deauthentication\"},{\"depth\":3,\"title\":\"Credentials\",\"slug\":\"credentials\"},{\"depth\":2,\"title\":\"Conclusion\",\"slug\":\"conclusion\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"WPA(2) PMKID Hash Cracking (MIC) Process Explained\",\"tags\":[\"wireless\",\"wpa-wpa2\",\"wifi\"],\"categories\":[\"Writeups\"],\"summary\":\"A guide on what the MIC is and how the actual WPA(2) cracking happens at lower level\",\"created\":\"2024-08-25T00:00:00.000Z\",\"lastmod\":\"2024-08-25T00:00:00.000Z\",\"image\":\"https://github.com/user-attachments/assets/51b06557-0a25-4ddd-a59d-6783add3a447\",\"flags\":[],\"updated\":\"2025-02-03T19:35:52.328Z\",\"slug\":\"/blog/2023/wpa-hash-cracking-process-explained-in-detal/+page.md\",\"path\":\"/blog/2023/wpa-hash-cracking-process-explained-in-detal\",\"toc\":[{\"depth\":2,\"title\":\"The Handshake Process\",\"slug\":\"the-handshake-process\"},{\"depth\":3,\"title\":\"(PML) Pairwise Master Key Computation\",\"slug\":\"pml-pairwise-master-key-computation\"},{\"depth\":3,\"title\":\"(PTK) Pairwise Transient Key Computation\",\"slug\":\"ptk-pairwise-transient-key-computation\"},{\"depth\":3,\"title\":\"(MIC) Message Integrity Code\",\"slug\":\"mic-message-integrity-code\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Writeups for Web challenges from HTB Cyber Apocalypse CTF 2024\",\"tags\":[\"ctf\",\"cyber-apocalypse\",\"htb\",\"htb-2024\",\"web\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"This blog post contains the writeups for the web challenges that i solved from HTB Cyber Apocalypse 2024\",\"created\":\"2024-03-14T00:00:00.000Z\",\"lastmod\":\"2024-03-14T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/d5abad92-0b61-4418-af4b-582a6d03044b\",\"flags\":[],\"updated\":\"2025-02-03T19:35:52.328Z\",\"slug\":\"/blog/2023/htb-cyber-apocalypse-ctf-2024-web-writeups/+page.md\",\"path\":\"/blog/2023/htb-cyber-apocalypse-ctf-2024-web-writeups\",\"toc\":[{\"depth\":2,\"title\":\"WEB\",\"slug\":\"web\"},{\"depth\":3,\"title\":\"Labyrinth Linguist - Easy\",\"slug\":\"labyrinth-linguist---easy\"},{\"depth\":3,\"title\":\"LockTalk\",\"slug\":\"locktalk\"},{\"depth\":3,\"title\":\"SerialFlow\",\"slug\":\"serialflow\"},{\"depth\":2,\"title\":\"Ending Note\",\"slug\":\"ending-note\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Writeups for Web challenges from PCC 23\",\"tags\":[\"pcc23\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"These are the writeups for web challenges from PCC 23 held at Air University Islamabad\",\"created\":\"2023-12-22T00:00:00.000Z\",\"lastmod\":\"2023-12-22T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/661f1693-25ee-4ea3-8599-635e7b73cb6e\",\"flags\":[],\"updated\":\"2025-02-03T19:35:52.328Z\",\"slug\":\"/blog/2023/pcc-23-web-challenge-writeups/+page.md\",\"path\":\"/blog/2023/pcc-23-web-challenge-writeups\",\"toc\":[{\"depth\":1,\"title\":\"Qualifiers\",\"slug\":\"qualifiers\"},{\"depth\":3,\"title\":\"Secure ME\",\"slug\":\"secure-me\"},{\"depth\":1,\"title\":\"Finals\",\"slug\":\"finals\"},{\"depth\":3,\"title\":\"JazzME\",\"slug\":\"jazzme\"},{\"depth\":3,\"title\":\"Lama\",\"slug\":\"lama\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Blackhat MEA CTF Qualifiers Web Authy and Warm Me Up Writeup\",\"tags\":[\"blackhatmea\",\"ctf\",\"authy\",\"warmme-up\",\"unicode\",\"broken-logic\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"Writeups for 2 of web challenges from Blackhat MEA Qualifier CTF Round namely Authy and Warm Me Up\",\"created\":\"2023-11-13T00:00:00.000Z\",\"lastmod\":\"2023-11-13T00:00:00.000Z\",\"flags\":[],\"updated\":\"2025-02-03T19:35:52.328Z\",\"slug\":\"/blog/2023/blackhatmea-ctf-web-authy-writeup/+page.md\",\"path\":\"/blog/2023/blackhatmea-ctf-web-authy-writeup\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":3,\"title\":\"Authy\",\"slug\":\"authy\"},{\"depth\":3,\"title\":\"Warm Me Up\",\"slug\":\"warm-me-up\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Deploy a Django Application on Ubuntu 22.04 with Gunicorn & NGINX\",\"tags\":[\"django\",\"deployment\",\"development\",\"drf\",\"python\",\"ubuntu\"],\"categories\":[\"Linux\",\"Development\"],\"summary\":\"A Detailed walkthrough of the process of deploying a django application on a ubuntu server from scratch. This guide covers the deployment stages with Gunicorn, NGINX and Postgresql.\",\"created\":\"2023-09-11T00:00:00.000Z\",\"lastmod\":\"2023-10-29T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/ed7dd92d-f7d1-4646-9194-e02102945392\",\"flags\":[],\"updated\":\"2025-02-03T19:35:52.328Z\",\"slug\":\"/blog/2023/deploy-django-website-nginx-gunicorn-ubuntu-22/+page.md\",\"path\":\"/blog/2023/deploy-django-website-nginx-gunicorn-ubuntu-22\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":2,\"title\":\"Tutorial\",\"slug\":\"tutorial\"},{\"depth\":3,\"title\":\"Pre-Reqs\",\"slug\":\"pre-reqs\"},{\"depth\":3,\"title\":\"Installing Packages\",\"slug\":\"installing-packages\"},{\"depth\":3,\"title\":\"Setting up Project Directory\",\"slug\":\"setting-up-project-directory\"},{\"depth\":3,\"title\":\"Setting up Postgres (Database)\",\"slug\":\"setting-up-postgres-database\"},{\"depth\":3,\"title\":\"Project Settings\",\"slug\":\"project-settings\"},{\"depth\":3,\"title\":\"Spin up the Project\",\"slug\":\"spin-up-the-project\"},{\"depth\":3,\"title\":\"Setting up Gunicorn\",\"slug\":\"setting-up-gunicorn\"},{\"depth\":3,\"title\":\"Setting UP NGINX\",\"slug\":\"setting-up-nginx\"},{\"depth\":2,\"title\":\"Conclusion\",\"slug\":\"conclusion\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Web Sanity Writeup AmateursCTF 2023 DOM Clobbering and Prototype Pollution\",\"tags\":[\"amateurs-ctf\",\"writeup\",\"sanity\",\"xss\",\"dom-clobbering\",\"prototype-pollution\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"A complete writeup of sanity web challenge from AmateursCTF 2023. It covers the use of the Sanitizer API in browsers, DOM Clobbering, Parameter Pollution and XSS.\",\"created\":\"2023-07-21T00:00:00.000Z\",\"lastmod\":\"2023-07-21T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/c70a5dc7-5294-45b7-8a9f-8a04ac9214b3\",\"flags\":[],\"updated\":\"2025-02-03T19:35:52.327Z\",\"slug\":\"/blog/2023/amateursctf-web-2023-writeup-sanity/+page.md\",\"path\":\"/blog/2023/amateursctf-web-2023-writeup-sanity\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":2,\"title\":\"Surface\",\"slug\":\"surface\"},{\"depth\":2,\"title\":\"Behind the Scenes\",\"slug\":\"behind-the-scenes\"},{\"depth\":3,\"title\":\"DOM Clobbering\",\"slug\":\"dom-clobbering\"},{\"depth\":3,\"title\":\"Attacker Server\",\"slug\":\"attacker-server\"},{\"depth\":3,\"title\":\"Prototype Pollution\",\"slug\":\"prototype-pollution\"},{\"depth\":4,\"title\":\"Proof of Concept (POC)\",\"slug\":\"proof-of-concept-poc\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"A Guide to Zone Transfer, DNS Zone Takeover and Subdomain Takeover\",\"tags\":[\"dns-zone-takeover\",\"dns-zone-transfer\",\"subdomain-takeover\",\"bugbounty\",\"infosec\",\"reconnaissance\",\"automated-tool\"],\"categories\":[\"Bug Bounty\",\"Projects\"],\"summary\":\"In this guide, we will be looking over vulnerabilites associated with a domain normally occured due to the negligence from the develper team. The terms we will see are Zone Transfer, DNS Zone Takeover and Subdomain Takeover.\",\"created\":\"2023-06-30T00:00:00.000Z\",\"lastmod\":\"2023-06-30T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/755e47ec-8f67-45e9-a7cb-04efe7584127\",\"flags\":[],\"updated\":\"2025-02-03T19:35:52.328Z\",\"slug\":\"/blog/2023/subrake-a-dns-automated-scanner/+page.md\",\"path\":\"/blog/2023/subrake-a-dns-automated-scanner\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":2,\"title\":\"Subrake\",\"slug\":\"subrake\"},{\"depth\":2,\"title\":\"Explanation\",\"slug\":\"explanation\"},{\"depth\":3,\"title\":\"Zone Transfer\",\"slug\":\"zone-transfer\"},{\"depth\":3,\"title\":\"Subdomain Takeover\",\"slug\":\"subdomain-takeover\"},{\"depth\":3,\"title\":\"DNS Zone Takeover\",\"slug\":\"dns-zone-takeover\"},{\"depth\":4,\"title\":\"Finding Zone Takeover\",\"slug\":\"finding-zone-takeover\"},{\"depth\":2,\"title\":\"Using Subrake\",\"slug\":\"using-subrake\"},{\"depth\":2,\"title\":\"Conclusion\",\"slug\":\"conclusion\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"BSidesTLV CTF 2023 Browselicious (Misc) Writeup\",\"tags\":[\"ctf\",\"writeups\",\"bsidestlv-ctf-2023\"],\"categories\":[\"CTF Writeups\"],\"summary\":\"Writeup for Browselicious challenge (Misc) from BsidesTLV CTF 2023\",\"created\":\"2023-06-28T00:00:00.000Z\",\"lastmod\":\"2023-06-28T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/1788ec87-fc59-49a7-a035-ec767504fb3d\",\"flags\":[],\"updated\":\"2025-02-03T19:35:52.329Z\",\"slug\":\"/blog/2023/writeup-browselicious-challenge-bsidestlv-ctf/+page.md\",\"path\":\"/blog/2023/writeup-browselicious-challenge-bsidestlv-ctf\",\"toc\":[{\"depth\":1,\"title\":\"Introducton\",\"slug\":\"introducton\"},{\"depth\":1,\"title\":\"Writeup\",\"slug\":\"writeup\"},{\"depth\":3,\"title\":\"Server Request\",\"slug\":\"server-request\"},{\"depth\":3,\"title\":\"Code Review\",\"slug\":\"code-review\"},{\"depth\":3,\"title\":\"Exploit\",\"slug\":\"exploit\"},{\"depth\":4,\"title\":\"Input Field\",\"slug\":\"input-field\"},{\"depth\":4,\"title\":\"Race Condition\",\"slug\":\"race-condition\"},{\"depth\":4,\"title\":\"Post Message\",\"slug\":\"post-message\"},{\"depth\":2,\"title\":\"PoC\",\"slug\":\"poc\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Google CTF 2023 Under Construction (Web) Writeup\",\"tags\":[\"ctf\",\"writeups\",\"google-ctf-2023\"],\"categories\":[\"CTF Writeups\"],\"summary\":\"Writeup for under construction challenge from google ctf 2023\",\"created\":\"2023-06-27T00:00:00.000Z\",\"lastmod\":\"2023-06-27T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta.sh/assets/29171692/f553635d-6deb-43e5-a2ae-0d8cef296db7\",\"flags\":[],\"updated\":\"2025-02-03T19:35:52.329Z\",\"slug\":\"/blog/2023/writeup-under-construction-google-ctf-2023/+page.md\",\"path\":\"/blog/2023/writeup-under-construction-google-ctf-2023\",\"toc\":[{\"depth\":1,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":1,\"title\":\"Writeup\",\"slug\":\"writeup\"},{\"depth\":2,\"title\":\"Getting Started\",\"slug\":\"getting-started\"},{\"depth\":2,\"title\":\"Vulnerable Part\",\"slug\":\"vulnerable-part\"},{\"depth\":2,\"title\":\"Exploit\",\"slug\":\"exploit\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Privacy Policy\",\"created\":\"2023-06-27T00:00:00.000Z\",\"flags\":[\"unlisted\"],\"updated\":\"2025-02-03T19:35:52.329Z\",\"slug\":\"/privacy/+page.svelte.md\",\"path\":\"/privacy\",\"toc\":false,\"type\":\"article\",\"html\":\"\"},{\"title\":\"SSTI Bypass using HTTP Request Referer and Cookie headers - My First App Writeup\",\"tags\":[\"UoftCTF\",\"writeup\",\"ssti\",\"template-injection\",\"jwt\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"This is solution for My First App challenge from UofTCTF 23. It covers initial JWT cracking and then escalating it to SSTI. And then bypassing filters by using the request object attributes\",\"created\":\"2023-01-16T00:00:00.000Z\",\"lastmod\":\"2023-01-16T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/45d79cff-0f11-4c49-92cb-a530ee2c36a5\",\"flags\":[\"unlisted\"],\"updated\":\"2025-02-03T19:35:52.328Z\",\"slug\":\"/blog/2023/ssti-bypass-using-referer-and-cookie-my-first-app-uoftctf-23/+page.md\",\"path\":\"/blog/2023/ssti-bypass-using-referer-and-cookie-my-first-app-uoftctf-23\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"About Me\",\"created\":\"2022-05-06T00:00:00.000Z\",\"flags\":[\"unlisted\"],\"updated\":\"2025-02-03T19:35:52.330Z\",\"slug\":\"/resume/+page.svelte.md\",\"path\":\"/resume\",\"toc\":[{\"depth\":2,\"title\":\"Skills\",\"slug\":\"skills\"},{\"depth\":2,\"title\":\"Experience\",\"slug\":\"experience\"},{\"depth\":2,\"title\":\"Education\",\"slug\":\"education\"},{\"depth\":2,\"title\":\"Certifications\",\"slug\":\"certifications\"},{\"depth\":2,\"title\":\"Acheivements\",\"slug\":\"acheivements\"},{\"depth\":2,\"title\":\"Projects\",\"slug\":\"projects\"},{\"depth\":2,\"title\":\"Volunteering and Startups\",\"slug\":\"volunteering-and-startups\"},{\"depth\":2,\"title\":\"Contact\",\"slug\":\"contact\"}],\"type\":\"article\",\"html\":\"\"}]"}</script>
			<script>
				{
					__sveltekit_1d9mlfg = {
						base: new URL("../../..", location).pathname.slice(0, -1),
						env: {}
					};

					const element = document.currentScript.parentElement;

					const data = [null,null];

					Promise.all([
						import("../../../_app/immutable/entry/start.94d6949e.js"),
						import("../../../_app/immutable/entry/app.a40b6300.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 11],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		
    <div style="display: contents">%sveltekit.body%</div>
  </body>
</html>
