import{S as xr,i as Hr,s as Rr,U as ol,y as Mr,z as Gr,A as Wr,V as jr,W as Sr,g as Br,d as $r,B as Ur,X as Ar,k as r,q as a,a as d,Y as X,l as i,m as c,r as s,h as t,c as f,Z as V,n as u,T as Mt,b as n,D as o,E as Yr}from"../chunks/index.725d15e1.js";import{P as qr}from"../chunks/post_layout.a1c515d4.js";function Xr(fe){let p,y,N,g,h,k,J,w,Me,Go,Wo,Ge,jo,Bo,We,$o,Gt,K,ue,Uo,Wt,Z,Yo,z,qo,Xo,jt,Q,pe,Vo,Bt,ee,he,Jo,$t,_,Ko,je,Qo,ea,Be,ta,oa,Ut,v,aa,$e,sa,la,Ue,ra,ia,Ye,na,ca,qe,da,fa,Yt,P,ua,Xe,pa,ha,qt,E,va,Ve,ma,ya,Je,Fa,Ea,Ke,ba,ka,Xt,Qe,Cr=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">dig zonetransfer.me -t AXFR +nocookie @dns_address</span></div></code></div></pre>`,et,D,te,wa,tt,_a,Da,Ta,oe,Sa,ot,Aa,Ia,Ca,ae,Na,at,Oa,ga,Vt,L,Za,st,za,Pa,Jt,x,al,Kt,se,ve,La,Qt,b,xa,lt,Ha,Ra,rt,Ma,Ga,it,Wa,ja,eo,me,Ba,to,ye,$a,oo,H,Ua,nt,Ya,qa,ao,ct,Nr=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">subfinder </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d HOST </span><span style="color: #89DDFF">&gt;&gt;</span><span style="color: #EEFFFF"> FILE; assetfinder --subs</span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">only HOST </span><span style="color: #89DDFF">&gt;&gt;</span><span style="color: #EEFFFF"> FILE; amass enum </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">norecursive </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">noalts </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d HOST </span><span style="color: #89DDFF">&gt;&gt;</span><span style="color: #EEFFFF"> FILE; subjack </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">w FILE </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">t </span><span style="color: #F78C6C">100</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">timeout </span><span style="color: #F78C6C">30</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">ssl </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">c $GOPATH</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">src</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">github</span><span style="color: #89DDFF">.</span><span style="color: #F07178">com</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">haccer</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">subjack</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">fingerprints</span><span style="color: #89DDFF">.</span><span style="color: #F07178">json</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">v </span><span style="color: #F78C6C">3</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&gt;&gt;</span><span style="color: #EEFFFF"> takeover ; </span></div></code></div></pre>`,dt,Fe,Xa,so,ft,Or=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">python3 sublist3r</span><span style="color: #89DDFF">.</span><span style="color: #F07178">py</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d target</span><span style="color: #89DDFF">.</span><span style="color: #F07178">com</span></div><div class='line'><span style="color: #EEFFFF">amass enum </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d target</span><span style="color: #89DDFF">.</span><span style="color: #F07178">com</span></div><div class='line'><span style="color: #EEFFFF">...</span></div></code></div></pre>`,ut,Ee,Va,lo,pt,gr=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">subrake </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d target</span><span style="color: #89DDFF">.</span><span style="color: #F07178">com</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">w </span><span style="color: #89DDFF">./</span><span style="color: #EEFFFF">finalwordlists</span><span style="color: #89DDFF">.</span><span style="color: #F07178">txt</span></div></code></div></pre>`,ht,R,sl,ro,le,Ja,vt,M,Ka,io,re,be,Qa,no,T,es,mt,ts,os,yt,as,ss,co,ke,ls,fo,m,Ft,rs,is,O,ns,Et,cs,ds,bt,fs,us,ps,kt,hs,vs,wt,ms,ys,F,Fs,_t,Es,bs,Dt,ks,ws,Tt,_s,Ds,St,Ts,Ss,uo,we,As,po,_e,Is,ho,De,Cs,vo,Te,Ns,mo,ie,Se,Os,yo,Ae,gs,Fo,G,Zs,At,zs,Ps,Eo,It,Zr=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">dig shameerkashif.me +trace +all</span></div></code></div></pre>`,Ct,W,Ls,Nt,xs,Hs,bo,Ot,zr=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">dig shameerkashif.me NS</span></div></code></div></pre>`,gt,j,ll,ko,S,Rs,Zt,Ms,Gs,zt,Ws,js,wo,Pt,Pr=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">dig shameerkashif.me @ns1.digitalocean.com</span></div></code></div></pre>`,Lt,B,Bs,xt,$s,Us,_o,Ht,Lr=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">dig shameerkashif.me @ns1.digitalocean.com SOA</span></div></code></div></pre>`,Rt,ne,Ys,$,qs,Do,Ie,Xs,To,U,rl,So,ce,Ce,Vs,Ao,Ne,Js,Io,Oe,il,Co,de,ge,Ks,No,Ze,Qs;return{c(){p=r("h2"),y=r("a"),N=a("Introduction"),g=d(),h=r("p"),k=a("DNS have been there for years now to help you find things normally you wouldn’t remember. In this guide, we will go through the following set of problems that a third party can find and take advantage of in negative terms:"),J=d(),w=r("ul"),Me=r("li"),Go=a("DNS Zone Transfer"),Wo=d(),Ge=r("li"),jo=a("Subdomain Takeover"),Bo=d(),We=r("li"),$o=a("DNS Zone Transfer"),Gt=d(),K=r("h2"),ue=r("a"),Uo=a("Subrake"),Wt=d(),Z=r("p"),Yo=a("The primary reason i wrote this blog post was this project i am working on: "),z=r("a"),qo=a("Subrake"),Xo=a(". It’s an automated DNS scanner to cover various issues in a single go. Let me know what you think about it in the comment section…"),jt=d(),Q=r("h2"),pe=r("a"),Vo=a("Explanation"),Bt=d(),ee=r("h3"),he=r("a"),Jo=a("Zone Transfer"),$t=d(),_=r("p"),Ko=a("Zone Transfer itself is not a vulnerability and is a procedure followed to transfer the records of a domain from one DNS server to another. For example, you need to replicate the records of your domain available in "),je=r("code"),Qo=a("namecheap"),ea=a(" to AWS "),Be=r("code"),ta=a("Route53"),oa=a("."),Ut=d(),v=r("p"),aa=a("In a Zone transfer, the dns server sends a complete dns records file to another server. The file contains everything the DNS server has regarding that domain including its "),$e=r("code"),sa=a("A"),la=a(", "),Ue=r("code"),ra=a("AAAA"),ia=a(", "),Ye=r("code"),na=a("CNAME"),ca=a(", and "),qe=r("code"),da=a("SOA"),fa=a(" records. This includes the information which publicly isn’t accessible."),Yt=d(),P=r("p"),ua=a("For example, you can’t access the "),Xe=r("code"),pa=a("CNAME"),ha=a(" records of any domain without having to brute force your way into it. But if the DNS server itself is offering the service, kaboom."),qt=d(),E=r("p"),va=a("Most of the pople in industry are already aware of Zone transfer, so lets directly jump to the part "),Ve=r("strong"),ma=a("How to find it?"),ya=a(". There are many tools available in the wild to find "),Je=r("code"),Fa=a("zone transfer"),Ea=a(". But the famous and the most simple one is "),Ke=r("code"),ba=a("dig"),ka=a(":"),Xt=d(),Qe=new X(!1),et=d(),D=r("ul"),te=r("li"),wa=a("The "),tt=r("code"),_a=a("-t AXFR"),Da=a(" option is a type of query to request zone transfer details."),Ta=d(),oe=r("li"),Sa=a("The "),ot=r("code"),Aa=a("+nocookie"),Ia=a(" option would disable the use of DNS cookies."),Ca=d(),ae=r("li"),Na=a("And additionally, you can specify "),at=r("code"),Oa=a("@dns_server"),ga=a(" which can be skipped to use default DNS servers. I would highly recommend this option if you a playing a CTF or inside a network where a private DNS server is accessible."),Vt=d(),L=r("p"),Za=a("If successfull, this would list all the DNS records. This can also be accomplished using "),st=r("code"),za=a("subrake -d zonetransfer.me"),Pa=a(" and you would get:"),Jt=d(),x=r("img"),Kt=d(),se=r("h3"),ve=r("a"),La=a("Subdomain Takeover"),Qt=d(),b=r("p"),xa=a("Subdomain Takeover unlike it sounds is actually the takeover of the service that subdomain is pointing to. Lets say "),lt=r("code"),Ha=a("marketing.domain.tld"),Ra=a(" was pointing to an Amazon "),rt=r("code"),Ma=a("S3"),Ga=a(" bucket or "),it=r("code"),Wa=a("ELastic Beanstalk"),ja=a(" service which actually didn’t exist."),eo=d(),me=r("p"),Ba=a("A third party can come and claim this service. Now what happens is that the party that claimed the service can host whatever they want on that subdomain but that ofcourse is limited to what the service has to offer."),to=d(),ye=r("p"),$a=a("Most of the people in industry have been creating their automations of this. Some use their own tools and some have sort of created a workflow."),oo=d(),H=r("p"),Ua=a("You can go for a "),nt=r("code"),Ya=a("oneliner"),qa=a(":"),ao=d(),ct=new X(!1),dt=d(),Fe=r("p"),Xa=a("Or you can find the subdomains first using different tools and public sources and probably use a tool to check the takeover."),so=d(),ft=new X(!1),ut=d(),Ee=r("p"),Va=a("Checking the takeover:"),lo=d(),pt=new X(!1),ht=d(),R=r("img"),ro=d(),le=r("p"),Ja=a("The list of services that are currently known to vulnerable to Subdomain Takeover can be found at: "),vt=r("strong"),M=r("a"),Ka=a("Can I Takeover XYZ"),io=d(),re=r("h3"),be=r("a"),Qa=a("DNS Zone Takeover"),no=d(),T=r("p"),es=a("Zone Takeover is a term not too old right now and its actually is as it sounds unlike subdomain takeover. And it can be more "),mt=r("strong"),ts=a("severe"),os=a(" as you have the control over the complete zone. In order words, you can host your own "),yt=r("code"),as=a("records"),ss=a(" and are not limited to the service being used like subdomain takeover."),co=d(),ke=r("p"),ls=a("The normal procedure that is being followed or atleast i follow this:"),fo=d(),m=r("ul"),Ft=r("li"),rs=a("I purchase the domain from namecheap or godaddy."),is=d(),O=r("li"),ns=a("I create a new "),Et=r("code"),cs=a("Hosted Zone"),ds=a(" in AWS "),bt=r("code"),fs=a("Route53"),us=a(" service."),ps=d(),kt=r("li"),hs=a("The hosted zone gives me a set of nameservers."),vs=d(),wt=r("li"),ms=a("I enter these nameservers into the Authoritative nameservers section in GoDaddy or namecheap."),ys=d(),F=r("li"),Fs=a("Then i use the "),_t=r("code"),Es=a("Route53"),bs=a(" service instead of GoDaddy or Namecheap to manage the records like "),Dt=r("code"),ks=a("A"),ws=a(", "),Tt=r("code"),_s=a("AAAA"),Ds=a(", or "),St=r("code"),Ts=a("CNAME"),Ss=a("."),uo=d(),we=r("p"),As=a("Infact, if you ever worked with Cloudflare, you would know that you create a new website in Cloudflare. In result you get the nameservers. You then set the nameservers with the domain you purchased."),po=d(),_e=r("p"),Is=a("After doing so, you add/edit/remove the records within the cloudflare panel. Lets suppose, after a year you plan to not use the Cloudflare service anymore. So, you delete your website from cloudflare but doesn’t actually remove the authoritative entries in your domain settings from godaddy."),ho=d(),De=r("p"),Cs=a("Since the nameserver entries already exist and still pointing to the service (aka cloudflare in this case), a third party can claim the service which would lead to zone takeover."),vo=d(),Te=r("p"),Ns=a("If you understand the above scenario, you can relate it to the subdomain takeover where you claim the stale service. But here, its the stale zone."),mo=d(),ie=r("h4"),Se=r("a"),Os=a("Finding Zone Takeover"),yo=d(),Ae=r("p"),gs=a("The good thing with zone takeover is you don’t have to brute force your way into it or find anything publicly. The information is already there, you just have to make sure its in the right condition."),Fo=d(),G=r("p"),Zs=a("The first step would be to get the nameservers of the domain. We can use "),At=r("code"),zs=a("dig"),Ps=a(" for that:"),Eo=d(),It=new X(!1),Ct=d(),W=r("p"),Ls=a("Or you can directly get the "),Nt=r("code"),xs=a("NS"),Hs=a(" records and start looking from there."),bo=d(),Ot=new X(!1),gt=d(),j=r("img"),ko=d(),S=r("p"),Rs=a("The against each NS record, check if any of them fails to responsd. If it does, it can probably be vulnerable to zone takeover. The case it failes, you will have the status as "),Zt=r("strong"),Ms=a("REFUSED"),Gs=a(" or "),zt=r("strong"),Ws=a("SERVFAIL"),js=a(":"),wo=d(),Pt=new X(!1),Lt=d(),B=r("p"),Bs=a("You can also check for "),xt=r("code"),$s=a("SOA"),Us=a(" which is what i would like to do instead (to be more concise):"),_o=d(),Ht=new X(!1),Rt=d(),ne=r("p"),Ys=a("Well, if it doesn’t responsd, you can try to claim the service. As of now, the current vulnerable services are available at: "),$=r("a"),qs=a("Can I Takeover DNS"),Do=d(),Ie=r("p"),Xs=a("Well, with subrake, it first tries to resolve each nameserver and if it does then it tries to guess the service and tells if its vulnerable or not. Something like this:"),To=d(),U=r("img"),So=d(),ce=r("h2"),Ce=r("a"),Vs=a("Using Subrake"),Ao=d(),Ne=r("p"),Js=a("Subrake can help you pick all 3 above cases. The complete information and details can be found at the link i mentioned in the start of this blog. I am simply attaching a screenshot with the details."),Io=d(),Oe=r("img"),Co=d(),de=r("h2"),ge=r("a"),Ks=a("Conclusion"),No=d(),Ze=r("p"),Qs=a("First of all, i hope this guide was helpful 😅. We saw 3 different cases namely, Zone Transfer, Zone Takeover and Subdomain Takeover. The mitigation simply is to be aware of when you remove a service. Make sure the entries in your DNS gets updated as well. Or wrap the service completely."),this.h()},l(e){p=i(e,"H2",{id:!0});var l=c(p);y=i(l,"A",{href:!0});var nl=c(y);N=s(nl,"Introduction"),nl.forEach(t),l.forEach(t),g=f(e),h=i(e,"P",{});var cl=c(h);k=s(cl,"DNS have been there for years now to help you find things normally you wouldn’t remember. In this guide, we will go through the following set of problems that a third party can find and take advantage of in negative terms:"),cl.forEach(t),J=f(e),w=i(e,"UL",{});var ze=c(w);Me=i(ze,"LI",{});var dl=c(Me);Go=s(dl,"DNS Zone Transfer"),dl.forEach(t),Wo=f(ze),Ge=i(ze,"LI",{});var fl=c(Ge);jo=s(fl,"Subdomain Takeover"),fl.forEach(t),Bo=f(ze),We=i(ze,"LI",{});var ul=c(We);$o=s(ul,"DNS Zone Transfer"),ul.forEach(t),ze.forEach(t),Gt=f(e),K=i(e,"H2",{id:!0});var pl=c(K);ue=i(pl,"A",{href:!0});var hl=c(ue);Uo=s(hl,"Subrake"),hl.forEach(t),pl.forEach(t),Wt=f(e),Z=i(e,"P",{});var Oo=c(Z);Yo=s(Oo,"The primary reason i wrote this blog post was this project i am working on: "),z=i(Oo,"A",{href:!0,rel:!0,target:!0});var vl=c(z);qo=s(vl,"Subrake"),vl.forEach(t),Xo=s(Oo,". It’s an automated DNS scanner to cover various issues in a single go. Let me know what you think about it in the comment section…"),Oo.forEach(t),jt=f(e),Q=i(e,"H2",{id:!0});var ml=c(Q);pe=i(ml,"A",{href:!0});var yl=c(pe);Vo=s(yl,"Explanation"),yl.forEach(t),ml.forEach(t),Bt=f(e),ee=i(e,"H3",{id:!0});var Fl=c(ee);he=i(Fl,"A",{href:!0});var El=c(he);Jo=s(El,"Zone Transfer"),El.forEach(t),Fl.forEach(t),$t=f(e),_=i(e,"P",{});var Pe=c(_);Ko=s(Pe,"Zone Transfer itself is not a vulnerability and is a procedure followed to transfer the records of a domain from one DNS server to another. For example, you need to replicate the records of your domain available in "),je=i(Pe,"CODE",{});var bl=c(je);Qo=s(bl,"namecheap"),bl.forEach(t),ea=s(Pe," to AWS "),Be=i(Pe,"CODE",{});var kl=c(Be);ta=s(kl,"Route53"),kl.forEach(t),oa=s(Pe,"."),Pe.forEach(t),Ut=f(e),v=i(e,"P",{});var A=c(v);aa=s(A,"In a Zone transfer, the dns server sends a complete dns records file to another server. The file contains everything the DNS server has regarding that domain including its "),$e=i(A,"CODE",{});var wl=c($e);sa=s(wl,"A"),wl.forEach(t),la=s(A,", "),Ue=i(A,"CODE",{});var _l=c(Ue);ra=s(_l,"AAAA"),_l.forEach(t),ia=s(A,", "),Ye=i(A,"CODE",{});var Dl=c(Ye);na=s(Dl,"CNAME"),Dl.forEach(t),ca=s(A,", and "),qe=i(A,"CODE",{});var Tl=c(qe);da=s(Tl,"SOA"),Tl.forEach(t),fa=s(A," records. This includes the information which publicly isn’t accessible."),A.forEach(t),Yt=f(e),P=i(e,"P",{});var go=c(P);ua=s(go,"For example, you can’t access the "),Xe=i(go,"CODE",{});var Sl=c(Xe);pa=s(Sl,"CNAME"),Sl.forEach(t),ha=s(go," records of any domain without having to brute force your way into it. But if the DNS server itself is offering the service, kaboom."),go.forEach(t),qt=f(e),E=i(e,"P",{});var Y=c(E);va=s(Y,"Most of the pople in industry are already aware of Zone transfer, so lets directly jump to the part "),Ve=i(Y,"STRONG",{});var Al=c(Ve);ma=s(Al,"How to find it?"),Al.forEach(t),ya=s(Y,". There are many tools available in the wild to find "),Je=i(Y,"CODE",{});var Il=c(Je);Fa=s(Il,"zone transfer"),Il.forEach(t),Ea=s(Y,". But the famous and the most simple one is "),Ke=i(Y,"CODE",{});var Cl=c(Ke);ba=s(Cl,"dig"),Cl.forEach(t),ka=s(Y,":"),Y.forEach(t),Xt=f(e),Qe=V(e,!1),et=f(e),D=i(e,"UL",{});var Le=c(D);te=i(Le,"LI",{});var Zo=c(te);wa=s(Zo,"The "),tt=i(Zo,"CODE",{});var Nl=c(tt);_a=s(Nl,"-t AXFR"),Nl.forEach(t),Da=s(Zo," option is a type of query to request zone transfer details."),Zo.forEach(t),Ta=f(Le),oe=i(Le,"LI",{});var zo=c(oe);Sa=s(zo,"The "),ot=i(zo,"CODE",{});var Ol=c(ot);Aa=s(Ol,"+nocookie"),Ol.forEach(t),Ia=s(zo," option would disable the use of DNS cookies."),zo.forEach(t),Ca=f(Le),ae=i(Le,"LI",{});var Po=c(ae);Na=s(Po,"And additionally, you can specify "),at=i(Po,"CODE",{});var gl=c(at);Oa=s(gl,"@dns_server"),gl.forEach(t),ga=s(Po," which can be skipped to use default DNS servers. I would highly recommend this option if you a playing a CTF or inside a network where a private DNS server is accessible."),Po.forEach(t),Le.forEach(t),Vt=f(e),L=i(e,"P",{});var Lo=c(L);Za=s(Lo,"If successfull, this would list all the DNS records. This can also be accomplished using "),st=i(Lo,"CODE",{});var Zl=c(st);za=s(Zl,"subrake -d zonetransfer.me"),Zl.forEach(t),Pa=s(Lo," and you would get:"),Lo.forEach(t),Jt=f(e),x=i(e,"IMG",{width:!0,alt:!0,src:!0}),Kt=f(e),se=i(e,"H3",{id:!0});var zl=c(se);ve=i(zl,"A",{href:!0});var Pl=c(ve);La=s(Pl,"Subdomain Takeover"),Pl.forEach(t),zl.forEach(t),Qt=f(e),b=i(e,"P",{});var q=c(b);xa=s(q,"Subdomain Takeover unlike it sounds is actually the takeover of the service that subdomain is pointing to. Lets say "),lt=i(q,"CODE",{});var Ll=c(lt);Ha=s(Ll,"marketing.domain.tld"),Ll.forEach(t),Ra=s(q," was pointing to an Amazon "),rt=i(q,"CODE",{});var xl=c(rt);Ma=s(xl,"S3"),xl.forEach(t),Ga=s(q," bucket or "),it=i(q,"CODE",{});var Hl=c(it);Wa=s(Hl,"ELastic Beanstalk"),Hl.forEach(t),ja=s(q," service which actually didn’t exist."),q.forEach(t),eo=f(e),me=i(e,"P",{});var Rl=c(me);Ba=s(Rl,"A third party can come and claim this service. Now what happens is that the party that claimed the service can host whatever they want on that subdomain but that ofcourse is limited to what the service has to offer."),Rl.forEach(t),to=f(e),ye=i(e,"P",{});var Ml=c(ye);$a=s(Ml,"Most of the people in industry have been creating their automations of this. Some use their own tools and some have sort of created a workflow."),Ml.forEach(t),oo=f(e),H=i(e,"P",{});var xo=c(H);Ua=s(xo,"You can go for a "),nt=i(xo,"CODE",{});var Gl=c(nt);Ya=s(Gl,"oneliner"),Gl.forEach(t),qa=s(xo,":"),xo.forEach(t),ao=f(e),ct=V(e,!1),dt=f(e),Fe=i(e,"P",{});var Wl=c(Fe);Xa=s(Wl,"Or you can find the subdomains first using different tools and public sources and probably use a tool to check the takeover."),Wl.forEach(t),so=f(e),ft=V(e,!1),ut=f(e),Ee=i(e,"P",{});var jl=c(Ee);Va=s(jl,"Checking the takeover:"),jl.forEach(t),lo=f(e),pt=V(e,!1),ht=f(e),R=i(e,"IMG",{width:!0,alt:!0,src:!0}),ro=f(e),le=i(e,"P",{});var el=c(le);Ja=s(el,"The list of services that are currently known to vulnerable to Subdomain Takeover can be found at: "),vt=i(el,"STRONG",{});var Bl=c(vt);M=i(Bl,"A",{href:!0,rel:!0,target:!0});var $l=c(M);Ka=s($l,"Can I Takeover XYZ"),$l.forEach(t),Bl.forEach(t),el.forEach(t),io=f(e),re=i(e,"H3",{id:!0});var Ul=c(re);be=i(Ul,"A",{href:!0});var Yl=c(be);Qa=s(Yl,"DNS Zone Takeover"),Yl.forEach(t),Ul.forEach(t),no=f(e),T=i(e,"P",{});var xe=c(T);es=s(xe,"Zone Takeover is a term not too old right now and its actually is as it sounds unlike subdomain takeover. And it can be more "),mt=i(xe,"STRONG",{});var ql=c(mt);ts=s(ql,"severe"),ql.forEach(t),os=s(xe," as you have the control over the complete zone. In order words, you can host your own "),yt=i(xe,"CODE",{});var Xl=c(yt);as=s(Xl,"records"),Xl.forEach(t),ss=s(xe," and are not limited to the service being used like subdomain takeover."),xe.forEach(t),co=f(e),ke=i(e,"P",{});var Vl=c(ke);ls=s(Vl,"The normal procedure that is being followed or atleast i follow this:"),Vl.forEach(t),fo=f(e),m=i(e,"UL",{});var I=c(m);Ft=i(I,"LI",{});var Jl=c(Ft);rs=s(Jl,"I purchase the domain from namecheap or godaddy."),Jl.forEach(t),is=f(I),O=i(I,"LI",{});var He=c(O);ns=s(He,"I create a new "),Et=i(He,"CODE",{});var Kl=c(Et);cs=s(Kl,"Hosted Zone"),Kl.forEach(t),ds=s(He," in AWS "),bt=i(He,"CODE",{});var Ql=c(bt);fs=s(Ql,"Route53"),Ql.forEach(t),us=s(He," service."),He.forEach(t),ps=f(I),kt=i(I,"LI",{});var er=c(kt);hs=s(er,"The hosted zone gives me a set of nameservers."),er.forEach(t),vs=f(I),wt=i(I,"LI",{});var tr=c(wt);ms=s(tr,"I enter these nameservers into the Authoritative nameservers section in GoDaddy or namecheap."),tr.forEach(t),ys=f(I),F=i(I,"LI",{});var C=c(F);Fs=s(C,"Then i use the "),_t=i(C,"CODE",{});var or=c(_t);Es=s(or,"Route53"),or.forEach(t),bs=s(C," service instead of GoDaddy or Namecheap to manage the records like "),Dt=i(C,"CODE",{});var ar=c(Dt);ks=s(ar,"A"),ar.forEach(t),ws=s(C,", "),Tt=i(C,"CODE",{});var sr=c(Tt);_s=s(sr,"AAAA"),sr.forEach(t),Ds=s(C,", or "),St=i(C,"CODE",{});var lr=c(St);Ts=s(lr,"CNAME"),lr.forEach(t),Ss=s(C,"."),C.forEach(t),I.forEach(t),uo=f(e),we=i(e,"P",{});var rr=c(we);As=s(rr,"Infact, if you ever worked with Cloudflare, you would know that you create a new website in Cloudflare. In result you get the nameservers. You then set the nameservers with the domain you purchased."),rr.forEach(t),po=f(e),_e=i(e,"P",{});var ir=c(_e);Is=s(ir,"After doing so, you add/edit/remove the records within the cloudflare panel. Lets suppose, after a year you plan to not use the Cloudflare service anymore. So, you delete your website from cloudflare but doesn’t actually remove the authoritative entries in your domain settings from godaddy."),ir.forEach(t),ho=f(e),De=i(e,"P",{});var nr=c(De);Cs=s(nr,"Since the nameserver entries already exist and still pointing to the service (aka cloudflare in this case), a third party can claim the service which would lead to zone takeover."),nr.forEach(t),vo=f(e),Te=i(e,"P",{});var cr=c(Te);Ns=s(cr,"If you understand the above scenario, you can relate it to the subdomain takeover where you claim the stale service. But here, its the stale zone."),cr.forEach(t),mo=f(e),ie=i(e,"H4",{id:!0});var dr=c(ie);Se=i(dr,"A",{href:!0});var fr=c(Se);Os=s(fr,"Finding Zone Takeover"),fr.forEach(t),dr.forEach(t),yo=f(e),Ae=i(e,"P",{});var ur=c(Ae);gs=s(ur,"The good thing with zone takeover is you don’t have to brute force your way into it or find anything publicly. The information is already there, you just have to make sure its in the right condition."),ur.forEach(t),Fo=f(e),G=i(e,"P",{});var Ho=c(G);Zs=s(Ho,"The first step would be to get the nameservers of the domain. We can use "),At=i(Ho,"CODE",{});var pr=c(At);zs=s(pr,"dig"),pr.forEach(t),Ps=s(Ho," for that:"),Ho.forEach(t),Eo=f(e),It=V(e,!1),Ct=f(e),W=i(e,"P",{});var Ro=c(W);Ls=s(Ro,"Or you can directly get the "),Nt=i(Ro,"CODE",{});var hr=c(Nt);xs=s(hr,"NS"),hr.forEach(t),Hs=s(Ro," records and start looking from there."),Ro.forEach(t),bo=f(e),Ot=V(e,!1),gt=f(e),j=i(e,"IMG",{width:!0,alt:!0,src:!0}),ko=f(e),S=i(e,"P",{});var Re=c(S);Rs=s(Re,"The against each NS record, check if any of them fails to responsd. If it does, it can probably be vulnerable to zone takeover. The case it failes, you will have the status as "),Zt=i(Re,"STRONG",{});var vr=c(Zt);Ms=s(vr,"REFUSED"),vr.forEach(t),Gs=s(Re," or "),zt=i(Re,"STRONG",{});var mr=c(zt);Ws=s(mr,"SERVFAIL"),mr.forEach(t),js=s(Re,":"),Re.forEach(t),wo=f(e),Pt=V(e,!1),Lt=f(e),B=i(e,"P",{});var Mo=c(B);Bs=s(Mo,"You can also check for "),xt=i(Mo,"CODE",{});var yr=c(xt);$s=s(yr,"SOA"),yr.forEach(t),Us=s(Mo," which is what i would like to do instead (to be more concise):"),Mo.forEach(t),_o=f(e),Ht=V(e,!1),Rt=f(e),ne=i(e,"P",{});var tl=c(ne);Ys=s(tl,"Well, if it doesn’t responsd, you can try to claim the service. As of now, the current vulnerable services are available at: "),$=i(tl,"A",{href:!0,rel:!0,target:!0});var Fr=c($);qs=s(Fr,"Can I Takeover DNS"),Fr.forEach(t),tl.forEach(t),Do=f(e),Ie=i(e,"P",{});var Er=c(Ie);Xs=s(Er,"Well, with subrake, it first tries to resolve each nameserver and if it does then it tries to guess the service and tells if its vulnerable or not. Something like this:"),Er.forEach(t),To=f(e),U=i(e,"IMG",{width:!0,alt:!0,src:!0}),So=f(e),ce=i(e,"H2",{id:!0});var br=c(ce);Ce=i(br,"A",{href:!0});var kr=c(Ce);Vs=s(kr,"Using Subrake"),kr.forEach(t),br.forEach(t),Ao=f(e),Ne=i(e,"P",{});var wr=c(Ne);Js=s(wr,"Subrake can help you pick all 3 above cases. The complete information and details can be found at the link i mentioned in the start of this blog. I am simply attaching a screenshot with the details."),wr.forEach(t),Io=f(e),Oe=i(e,"IMG",{src:!0}),Co=f(e),de=i(e,"H2",{id:!0});var _r=c(de);ge=i(_r,"A",{href:!0});var Dr=c(ge);Ks=s(Dr,"Conclusion"),Dr.forEach(t),_r.forEach(t),No=f(e),Ze=i(e,"P",{});var Tr=c(Ze);Qs=s(Tr,"First of all, i hope this guide was helpful 😅. We saw 3 different cases namely, Zone Transfer, Zone Takeover and Subdomain Takeover. The mitigation simply is to be aware of when you remove a service. Make sure the entries in your DNS gets updated as well. Or wrap the service completely."),Tr.forEach(t),this.h()},h(){u(y,"href","#introduction"),u(p,"id","introduction"),u(ue,"href","#subrake"),u(K,"id","subrake"),u(z,"href","https://github.com/hash3liZer/Subrake"),u(z,"rel","nofollow noopener noreferrer external"),u(z,"target","_blank"),u(pe,"href","#explanation"),u(Q,"id","explanation"),u(he,"href","#zone-transfer"),u(ee,"id","zone-transfer"),Qe.a=et,u(x,"width","828"),u(x,"alt","image"),Mt(x.src,al="https://github.com/hash3liZer/khatta/assets/29171692/e0552efd-45d1-41fc-ad00-63706be3849a")||u(x,"src",al),u(ve,"href","#subdomain-takeover"),u(se,"id","subdomain-takeover"),ct.a=dt,ft.a=ut,pt.a=ht,u(R,"width","828"),u(R,"alt","image"),Mt(R.src,sl="https://github.com/hash3liZer/khatta/assets/29171692/ce1559b0-e5fe-4fdc-ae2c-98de252c9970")||u(R,"src",sl),u(M,"href","https://github.com/EdOverflow/can-i-take-over-xyz"),u(M,"rel","nofollow noopener noreferrer external"),u(M,"target","_blank"),u(be,"href","#dns-zone-takeover"),u(re,"id","dns-zone-takeover"),u(Se,"href","#finding-zone-takeover"),u(ie,"id","finding-zone-takeover"),It.a=Ct,Ot.a=gt,u(j,"width","894"),u(j,"alt","image"),Mt(j.src,ll="https://github.com/hash3liZer/khatta/assets/29171692/aba8e709-0b33-486a-ac5c-c0ab48264625")||u(j,"src",ll),Pt.a=Lt,Ht.a=Rt,u($,"href","https://github.com/indianajson/can-i-take-over-dns"),u($,"rel","nofollow noopener noreferrer external"),u($,"target","_blank"),u(U,"width","743"),u(U,"alt","image"),Mt(U.src,rl="https://github.com/hash3liZer/khatta/assets/29171692/3d55e662-c019-4062-8c46-4c9075c47a8e")||u(U,"src",rl),u(Ce,"href","#using-subrake"),u(ce,"id","using-subrake"),Mt(Oe.src,il="https://user-images.githubusercontent.com/29171692/250178751-75abd71e-7765-4da0-8b08-1cc5e1e069c7.png")||u(Oe,"src",il),u(ge,"href","#conclusion"),u(de,"id","conclusion")},m(e,l){n(e,p,l),o(p,y),o(y,N),n(e,g,l),n(e,h,l),o(h,k),n(e,J,l),n(e,w,l),o(w,Me),o(Me,Go),o(w,Wo),o(w,Ge),o(Ge,jo),o(w,Bo),o(w,We),o(We,$o),n(e,Gt,l),n(e,K,l),o(K,ue),o(ue,Uo),n(e,Wt,l),n(e,Z,l),o(Z,Yo),o(Z,z),o(z,qo),o(Z,Xo),n(e,jt,l),n(e,Q,l),o(Q,pe),o(pe,Vo),n(e,Bt,l),n(e,ee,l),o(ee,he),o(he,Jo),n(e,$t,l),n(e,_,l),o(_,Ko),o(_,je),o(je,Qo),o(_,ea),o(_,Be),o(Be,ta),o(_,oa),n(e,Ut,l),n(e,v,l),o(v,aa),o(v,$e),o($e,sa),o(v,la),o(v,Ue),o(Ue,ra),o(v,ia),o(v,Ye),o(Ye,na),o(v,ca),o(v,qe),o(qe,da),o(v,fa),n(e,Yt,l),n(e,P,l),o(P,ua),o(P,Xe),o(Xe,pa),o(P,ha),n(e,qt,l),n(e,E,l),o(E,va),o(E,Ve),o(Ve,ma),o(E,ya),o(E,Je),o(Je,Fa),o(E,Ea),o(E,Ke),o(Ke,ba),o(E,ka),n(e,Xt,l),Qe.m(Cr,e,l),n(e,et,l),n(e,D,l),o(D,te),o(te,wa),o(te,tt),o(tt,_a),o(te,Da),o(D,Ta),o(D,oe),o(oe,Sa),o(oe,ot),o(ot,Aa),o(oe,Ia),o(D,Ca),o(D,ae),o(ae,Na),o(ae,at),o(at,Oa),o(ae,ga),n(e,Vt,l),n(e,L,l),o(L,Za),o(L,st),o(st,za),o(L,Pa),n(e,Jt,l),n(e,x,l),n(e,Kt,l),n(e,se,l),o(se,ve),o(ve,La),n(e,Qt,l),n(e,b,l),o(b,xa),o(b,lt),o(lt,Ha),o(b,Ra),o(b,rt),o(rt,Ma),o(b,Ga),o(b,it),o(it,Wa),o(b,ja),n(e,eo,l),n(e,me,l),o(me,Ba),n(e,to,l),n(e,ye,l),o(ye,$a),n(e,oo,l),n(e,H,l),o(H,Ua),o(H,nt),o(nt,Ya),o(H,qa),n(e,ao,l),ct.m(Nr,e,l),n(e,dt,l),n(e,Fe,l),o(Fe,Xa),n(e,so,l),ft.m(Or,e,l),n(e,ut,l),n(e,Ee,l),o(Ee,Va),n(e,lo,l),pt.m(gr,e,l),n(e,ht,l),n(e,R,l),n(e,ro,l),n(e,le,l),o(le,Ja),o(le,vt),o(vt,M),o(M,Ka),n(e,io,l),n(e,re,l),o(re,be),o(be,Qa),n(e,no,l),n(e,T,l),o(T,es),o(T,mt),o(mt,ts),o(T,os),o(T,yt),o(yt,as),o(T,ss),n(e,co,l),n(e,ke,l),o(ke,ls),n(e,fo,l),n(e,m,l),o(m,Ft),o(Ft,rs),o(m,is),o(m,O),o(O,ns),o(O,Et),o(Et,cs),o(O,ds),o(O,bt),o(bt,fs),o(O,us),o(m,ps),o(m,kt),o(kt,hs),o(m,vs),o(m,wt),o(wt,ms),o(m,ys),o(m,F),o(F,Fs),o(F,_t),o(_t,Es),o(F,bs),o(F,Dt),o(Dt,ks),o(F,ws),o(F,Tt),o(Tt,_s),o(F,Ds),o(F,St),o(St,Ts),o(F,Ss),n(e,uo,l),n(e,we,l),o(we,As),n(e,po,l),n(e,_e,l),o(_e,Is),n(e,ho,l),n(e,De,l),o(De,Cs),n(e,vo,l),n(e,Te,l),o(Te,Ns),n(e,mo,l),n(e,ie,l),o(ie,Se),o(Se,Os),n(e,yo,l),n(e,Ae,l),o(Ae,gs),n(e,Fo,l),n(e,G,l),o(G,Zs),o(G,At),o(At,zs),o(G,Ps),n(e,Eo,l),It.m(Zr,e,l),n(e,Ct,l),n(e,W,l),o(W,Ls),o(W,Nt),o(Nt,xs),o(W,Hs),n(e,bo,l),Ot.m(zr,e,l),n(e,gt,l),n(e,j,l),n(e,ko,l),n(e,S,l),o(S,Rs),o(S,Zt),o(Zt,Ms),o(S,Gs),o(S,zt),o(zt,Ws),o(S,js),n(e,wo,l),Pt.m(Pr,e,l),n(e,Lt,l),n(e,B,l),o(B,Bs),o(B,xt),o(xt,$s),o(B,Us),n(e,_o,l),Ht.m(Lr,e,l),n(e,Rt,l),n(e,ne,l),o(ne,Ys),o(ne,$),o($,qs),n(e,Do,l),n(e,Ie,l),o(Ie,Xs),n(e,To,l),n(e,U,l),n(e,So,l),n(e,ce,l),o(ce,Ce),o(Ce,Vs),n(e,Ao,l),n(e,Ne,l),o(Ne,Js),n(e,Io,l),n(e,Oe,l),n(e,Co,l),n(e,de,l),o(de,ge),o(ge,Ks),n(e,No,l),n(e,Ze,l),o(Ze,Qs)},p:Yr,d(e){e&&t(p),e&&t(g),e&&t(h),e&&t(J),e&&t(w),e&&t(Gt),e&&t(K),e&&t(Wt),e&&t(Z),e&&t(jt),e&&t(Q),e&&t(Bt),e&&t(ee),e&&t($t),e&&t(_),e&&t(Ut),e&&t(v),e&&t(Yt),e&&t(P),e&&t(qt),e&&t(E),e&&t(Xt),e&&Qe.d(),e&&t(et),e&&t(D),e&&t(Vt),e&&t(L),e&&t(Jt),e&&t(x),e&&t(Kt),e&&t(se),e&&t(Qt),e&&t(b),e&&t(eo),e&&t(me),e&&t(to),e&&t(ye),e&&t(oo),e&&t(H),e&&t(ao),e&&ct.d(),e&&t(dt),e&&t(Fe),e&&t(so),e&&ft.d(),e&&t(ut),e&&t(Ee),e&&t(lo),e&&pt.d(),e&&t(ht),e&&t(R),e&&t(ro),e&&t(le),e&&t(io),e&&t(re),e&&t(no),e&&t(T),e&&t(co),e&&t(ke),e&&t(fo),e&&t(m),e&&t(uo),e&&t(we),e&&t(po),e&&t(_e),e&&t(ho),e&&t(De),e&&t(vo),e&&t(Te),e&&t(mo),e&&t(ie),e&&t(yo),e&&t(Ae),e&&t(Fo),e&&t(G),e&&t(Eo),e&&It.d(),e&&t(Ct),e&&t(W),e&&t(bo),e&&Ot.d(),e&&t(gt),e&&t(j),e&&t(ko),e&&t(S),e&&t(wo),e&&Pt.d(),e&&t(Lt),e&&t(B),e&&t(_o),e&&Ht.d(),e&&t(Rt),e&&t(ne),e&&t(Do),e&&t(Ie),e&&t(To),e&&t(U),e&&t(So),e&&t(ce),e&&t(Ao),e&&t(Ne),e&&t(Io),e&&t(Oe),e&&t(Co),e&&t(de),e&&t(No),e&&t(Ze)}}}function Vr(fe){let p,y;const N=[fe[0],Ir];let g={$$slots:{default:[Xr]},$$scope:{ctx:fe}};for(let h=0;h<N.length;h+=1)g=ol(g,N[h]);return p=new qr({props:g}),{c(){Mr(p.$$.fragment)},l(h){Gr(p.$$.fragment,h)},m(h,k){Wr(p,h,k),y=!0},p(h,[k]){const J=k&1?jr(N,[k&1&&Sr(h[0]),k&0&&Sr(Ir)]):{};k&2&&(J.$$scope={dirty:k,ctx:h}),p.$set(J)},i(h){y||(Br(p.$$.fragment,h),y=!0)},o(h){$r(p.$$.fragment,h),y=!1},d(h){Ur(p,h)}}}const Ir={title:"A Guide to Zone Transfer, DNS Zone Takeover and Subdomain Takeover",tags:["dns-zone-takeover","dns-zone-transfer","subdomain-takeover","bugbounty","infosec","reconnaissance","automated-tool"],categories:["Bug Bounty","Projects"],summary:"In this guide, we will be looking over vulnerabilites associated with a domain normally occured due to the negligence from the develper team. The terms we will see are Zone Transfer, DNS Zone Takeover and Subdomain Takeover.",created:"2023-06-30T00:00:00.000Z",lastmod:"2023-06-30T00:00:00.000Z",image:"https://github.com/hash3liZer/khatta/assets/29171692/755e47ec-8f67-45e9-a7cb-04efe7584127",flags:[],updated:"2023-07-01T18:15:05.506Z",slug:"/blog/2023/subrake-a-dns-automated-scanner/+page.md",path:"/blog/2023/subrake-a-dns-automated-scanner",toc:[{depth:2,title:"Introduction",slug:"introduction"},{depth:2,title:"Subrake",slug:"subrake"},{depth:2,title:"Explanation",slug:"explanation"},{depth:3,title:"Zone Transfer",slug:"zone-transfer"},{depth:3,title:"Subdomain Takeover",slug:"subdomain-takeover"},{depth:3,title:"DNS Zone Takeover",slug:"dns-zone-takeover"},{depth:4,title:"Finding Zone Takeover",slug:"finding-zone-takeover"},{depth:2,title:"Using Subrake",slug:"using-subrake"},{depth:2,title:"Conclusion",slug:"conclusion"}]};function Jr(fe,p,y){return fe.$$set=N=>{y(0,p=ol(ol({},p),Ar(N)))},p=Ar(p),[p]}class ei extends xr{constructor(p){super(),Hr(this,p,Jr,Vr,Rr,{})}}export{ei as component};
