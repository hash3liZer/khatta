import{S as or,i as ar,s as sr,U as Ns,y as lr,z as rr,A as ir,V as nr,W as $l,g as cr,d as dr,B as fr,X as Yl,k as r,q as a,a as d,Y as W,e as ql,l as i,m as n,r as s,h as t,c as f,Z as U,n as u,T as Is,b as c,D as o,E as ur}from"../chunks/index.725d15e1.js";import{P as pr}from"../chunks/post_layout.a1c515d4.js";function hr(re){let p,F,N,g,h,b,X,k,Ie,ko,wo,Ne,Do,To,Oe,So,It,V,ie,Ao,Nt,Z,Co,z,Io,No,Ot,J,ne,Oo,gt,K,ce,go,Zt,w,Zo,ge,zo,Po,Ze,Lo,xo,zt,v,Ro,ze,Ho,Go,Pe,Mo,jo,Le,Bo,$o,xe,Yo,qo,Pt,P,Wo,Re,Uo,Xo,Lt,E,Vo,He,Jo,Ko,Ge,Qo,ea,Me,ta,oa,xt,je,Ul=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">dig zonetransfer.me -t AXFR +nocookie @dns_address</span></div></code></div></pre>`,Be,D,Q,aa,$e,sa,la,ra,ee,ia,Ye,na,ca,da,te,fa,qe,ua,pa,Rt,L,ha,We,va,ma,Ht,x,Os,Gt,oe,de,Fa,Mt,_,ya,Ue,Ea,_a,Xe,ba,ka,Ve,wa,Da,jt,fe,Ta,Bt,ue,Sa,$t,R,Aa,Je,Ca,Ia,Yt,Ke,Xl=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">subfinder </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d HOST </span><span style="color: #89DDFF">&gt;&gt;</span><span style="color: #EEFFFF"> FILE; assetfinder --subs</span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">only HOST </span><span style="color: #89DDFF">&gt;&gt;</span><span style="color: #EEFFFF"> FILE; amass enum </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">norecursive </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">noalts </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d HOST </span><span style="color: #89DDFF">&gt;&gt;</span><span style="color: #EEFFFF"> FILE; subjack </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">w FILE </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">t </span><span style="color: #F78C6C">100</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">timeout </span><span style="color: #F78C6C">30</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">ssl </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">c $GOPATH</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">src</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">github</span><span style="color: #89DDFF">.</span><span style="color: #F07178">com</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">haccer</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">subjack</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">fingerprints</span><span style="color: #89DDFF">.</span><span style="color: #F07178">json</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">v </span><span style="color: #F78C6C">3</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&gt;&gt;</span><span style="color: #EEFFFF"> takeover ; </span></div></code></div></pre>`,Qe,pe,Na,qt,et,Vl=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">python3 sublist3r</span><span style="color: #89DDFF">.</span><span style="color: #F07178">py</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d target</span><span style="color: #89DDFF">.</span><span style="color: #F07178">com</span></div><div class='line'><span style="color: #EEFFFF">amass enum </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d target</span><span style="color: #89DDFF">.</span><span style="color: #F07178">com</span></div><div class='line'><span style="color: #EEFFFF">...</span></div></code></div></pre>`,tt,he,Oa,Wt,ot,Jl=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">subrake </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d target</span><span style="color: #89DDFF">.</span><span style="color: #F07178">com</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">w </span><span style="color: #89DDFF">./</span><span style="color: #EEFFFF">finalwordlists</span><span style="color: #89DDFF">.</span><span style="color: #F07178">txt</span></div></code></div></pre>`,at,H,gs,Ut,ae,ga,st,G,Za,Xt,se,ve,za,Vt,T,Pa,lt,La,xa,rt,Ra,Ha,Jt,me,Ga,Kt,m,it,Ma,ja,O,Ba,nt,$a,Ya,ct,qa,Wa,Ua,dt,Xa,Va,ft,Ja,Ka,y,Qa,ut,es,ts,pt,os,as,ht,ss,ls,vt,rs,is,Qt,Fe,ns,eo,ye,cs,to,Ee,ds,oo,_e,fs,ao,le,be,us,so,ke,ps,lo,M,hs,mt,vs,ms,ro,Ft,Kl=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">dig shameerkashif.me +trace +all</span></div></code></div></pre>`,yt,j,Fs,Et,ys,Es,io,_t,Ql=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">dig shameerkashif.me NS</span></div></code></div></pre>`,bt,B,Zs,no,S,_s,kt,bs,ks,wt,ws,Ds,co,Dt,er=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">dig shameerkashif.me @ns1.digitalocean.com</span></div></code></div></pre>`,Tt,$,Ts,St,Ss,As,fo,At,tr=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">dig shameerkashif.me @ns1.digitalocean.com SOA</span></div></code></div></pre>`,Ct;return{c(){p=r("h2"),F=r("a"),N=a("Introduction"),g=d(),h=r("p"),b=a("DNS have been there for years now to help you find things normally you wouldn’t remember. In this guide, we will go through the following set of problems that a third party can find and take advantage of in negative terms:"),X=d(),k=r("ul"),Ie=r("li"),ko=a("DNS Zone Transfer"),wo=d(),Ne=r("li"),Do=a("Subdomain Takeover"),To=d(),Oe=r("li"),So=a("DNS Zone Transfer"),It=d(),V=r("h2"),ie=r("a"),Ao=a("Subrake"),Nt=d(),Z=r("p"),Co=a("The primary reason i wrote this blog post was this project i am working on: "),z=r("a"),Io=a("Subrake"),No=a(". It’s an automated DNS scanner to cover various issues in a single go. Let me know what you think about it in the comment section…"),Ot=d(),J=r("h2"),ne=r("a"),Oo=a("Explanation"),gt=d(),K=r("h3"),ce=r("a"),go=a("Zone Transfer"),Zt=d(),w=r("p"),Zo=a("Zone Transfer itself is not a vulnerability and is a procedure followed to transfer the records of a domain from one DNS server to another. For example, you need to replicate the records of your domain available in "),ge=r("code"),zo=a("namecheap"),Po=a(" to AWS "),Ze=r("code"),Lo=a("Route53"),xo=a("."),zt=d(),v=r("p"),Ro=a("In a Zone transfer, the dns server sends a complete dns records file to another server. The file contains everything the DNS server has regarding that domain including its "),ze=r("code"),Ho=a("A"),Go=a(", "),Pe=r("code"),Mo=a("AAAA"),jo=a(", "),Le=r("code"),Bo=a("CNAME"),$o=a(", and "),xe=r("code"),Yo=a("SOA"),qo=a(" records. This includes the information which publicly isn’t accessible."),Pt=d(),P=r("p"),Wo=a("For example, you can’t access the "),Re=r("code"),Uo=a("CNAME"),Xo=a(" records of any domain without having to brute force your way into it. But if the DNS server itself is offering the service, kaboom."),Lt=d(),E=r("p"),Vo=a("Most of the pople in industry are already aware of Zone transfer, so lets directly jump to the part "),He=r("strong"),Jo=a("How to find it?"),Ko=a(". There are many tools available in the wild to find "),Ge=r("code"),Qo=a("zone transfer"),ea=a(". But the famous and the most simple one is "),Me=r("code"),ta=a("dig"),oa=a(":"),xt=d(),je=new W(!1),Be=d(),D=r("ul"),Q=r("li"),aa=a("The "),$e=r("code"),sa=a("-t AXFR"),la=a(" option is a type of query to request zone transfer details."),ra=d(),ee=r("li"),ia=a("The "),Ye=r("code"),na=a("+nocookie"),ca=a(" option would disable the use of DNS cookies."),da=d(),te=r("li"),fa=a("And additionally, you can specify "),qe=r("code"),ua=a("@dns_server"),pa=a(" which can be skipped to use default DNS servers. I would highly recommend this option if you a playing a CTF or inside a network where a private DNS server is accessible."),Rt=d(),L=r("p"),ha=a("If successfull, this would list all the DNS records. This can also be accomplished using "),We=r("code"),va=a("subrake -d zonetransfer.me"),ma=a(" and you would get:"),Ht=d(),x=r("img"),Gt=d(),oe=r("h3"),de=r("a"),Fa=a("Subdomain Takeover"),Mt=d(),_=r("p"),ya=a("Subdomain Takeover unlike it sounds is actually the takeover of the service that subdomain is pointing to. Lets say "),Ue=r("code"),Ea=a("marketing.domain.tld"),_a=a(" was pointing to an Amazon "),Xe=r("code"),ba=a("S3"),ka=a(" bucket or "),Ve=r("code"),wa=a("ELastic Beanstalk"),Da=a(" service which actually didn’t exist."),jt=d(),fe=r("p"),Ta=a("A third party can come and claim this service. Now what happens is that the party that claimed the service can host whatever they want on that subdomain but that ofcourse is limited to what the service has to offer."),Bt=d(),ue=r("p"),Sa=a("Most of the people in industry have been creating their automations of this. Some use their own tools and some have sort of created a workflow."),$t=d(),R=r("p"),Aa=a("You can go for a "),Je=r("code"),Ca=a("oneliner"),Ia=a(":"),Yt=d(),Ke=new W(!1),Qe=d(),pe=r("p"),Na=a("Or you can find the subdomains first using different tools and public sources and probably use a tool to check the takeover."),qt=d(),et=new W(!1),tt=d(),he=r("p"),Oa=a("Checking the takeover:"),Wt=d(),ot=new W(!1),at=d(),H=r("img"),Ut=d(),ae=r("p"),ga=a("The list of services that are currently known to vulnerable to Subdomain Takeover can be found at: "),st=r("strong"),G=r("a"),Za=a("Can I Takeover XYZ"),Xt=d(),se=r("h3"),ve=r("a"),za=a("DNS Zone Takeover"),Vt=d(),T=r("p"),Pa=a("Zone Takeover is a term not too old right now and its actually is as it sounds unlike subdomain takeover. And it can be more "),lt=r("strong"),La=a("severe"),xa=a(" as you have the control over the complete zone. In order words, you can host your own "),rt=r("code"),Ra=a("records"),Ha=a(" and are not limited to the service being used like subdomain takeover."),Jt=d(),me=r("p"),Ga=a("The normal procedure that is being followed or atleast i follow this:"),Kt=d(),m=r("ul"),it=r("li"),Ma=a("I purchase the domain from namecheap or godaddy."),ja=d(),O=r("li"),Ba=a("I create a new "),nt=r("code"),$a=a("Hosted Zone"),Ya=a(" in AWS "),ct=r("code"),qa=a("Route53"),Wa=a(" service."),Ua=d(),dt=r("li"),Xa=a("The hosted zone gives me a set of nameservers."),Va=d(),ft=r("li"),Ja=a("I enter these nameservers into the Authoritative nameservers section in GoDaddy or namecheap."),Ka=d(),y=r("li"),Qa=a("Then i use the "),ut=r("code"),es=a("Route53"),ts=a(" service instead of GoDaddy or Namecheap to manage the records like "),pt=r("code"),os=a("A"),as=a(", "),ht=r("code"),ss=a("AAAA"),ls=a(", or "),vt=r("code"),rs=a("CNAME"),is=a("."),Qt=d(),Fe=r("p"),ns=a("Infact, if you ever worked with Cloudflare, you would know that you create a new website in Cloudflare. In result you get the nameservers. You then set the nameservers with the domain you purchased."),eo=d(),ye=r("p"),cs=a("After doing so, you add/edit/remove the records within the cloudflare panel. Lets suppose, after a year you plan to not use the Cloudflare service anymore. So, you delete your website from cloudflare but doesn’t actually remove the authoritative entries in your domain settings from godaddy."),to=d(),Ee=r("p"),ds=a("Since the nameserver entries already exist and still pointing to the service (aka cloudflare in this case), a third party can claim the service which would lead to zone takeover."),oo=d(),_e=r("p"),fs=a("If you understand the above scenario, you can relate it to the subdomain takeover where you claim the stale service. But here, its the stale zone."),ao=d(),le=r("h4"),be=r("a"),us=a("Finding Zone Takeover"),so=d(),ke=r("p"),ps=a("The good thing with zone takeover is you don’t have to brute force your way into it or find anything publicly. The information is already there, you just have to make sure its in the right condition."),lo=d(),M=r("p"),hs=a("The first step would be to get the nameservers of the domain. We can use "),mt=r("code"),vs=a("dig"),ms=a(" for that:"),ro=d(),Ft=new W(!1),yt=d(),j=r("p"),Fs=a("Or you can directly get the "),Et=r("code"),ys=a("NS"),Es=a(" records and start looking from there."),io=d(),_t=new W(!1),bt=d(),B=r("img"),no=d(),S=r("p"),_s=a("The against each NS record, check if any of them fails to responsd. If it does, it can probably be vulnerable to zone takeover. The case it failes, you will have the status as "),kt=r("strong"),bs=a("REFUSED"),ks=a(" or "),wt=r("strong"),ws=a("SERVFAIL"),Ds=a(":"),co=d(),Dt=new W(!1),Tt=d(),$=r("p"),Ts=a("You can also check for "),St=r("code"),Ss=a("SOA"),As=a(" which is what i would like to do instead (to be more concise):"),fo=d(),At=new W(!1),Ct=ql(),this.h()},l(e){p=i(e,"H2",{id:!0});var l=n(p);F=i(l,"A",{href:!0});var zs=n(F);N=s(zs,"Introduction"),zs.forEach(t),l.forEach(t),g=f(e),h=i(e,"P",{});var Ps=n(h);b=s(Ps,"DNS have been there for years now to help you find things normally you wouldn’t remember. In this guide, we will go through the following set of problems that a third party can find and take advantage of in negative terms:"),Ps.forEach(t),X=f(e),k=i(e,"UL",{});var we=n(k);Ie=i(we,"LI",{});var Ls=n(Ie);ko=s(Ls,"DNS Zone Transfer"),Ls.forEach(t),wo=f(we),Ne=i(we,"LI",{});var xs=n(Ne);Do=s(xs,"Subdomain Takeover"),xs.forEach(t),To=f(we),Oe=i(we,"LI",{});var Rs=n(Oe);So=s(Rs,"DNS Zone Transfer"),Rs.forEach(t),we.forEach(t),It=f(e),V=i(e,"H2",{id:!0});var Hs=n(V);ie=i(Hs,"A",{href:!0});var Gs=n(ie);Ao=s(Gs,"Subrake"),Gs.forEach(t),Hs.forEach(t),Nt=f(e),Z=i(e,"P",{});var uo=n(Z);Co=s(uo,"The primary reason i wrote this blog post was this project i am working on: "),z=i(uo,"A",{href:!0,rel:!0,target:!0});var Ms=n(z);Io=s(Ms,"Subrake"),Ms.forEach(t),No=s(uo,". It’s an automated DNS scanner to cover various issues in a single go. Let me know what you think about it in the comment section…"),uo.forEach(t),Ot=f(e),J=i(e,"H2",{id:!0});var js=n(J);ne=i(js,"A",{href:!0});var Bs=n(ne);Oo=s(Bs,"Explanation"),Bs.forEach(t),js.forEach(t),gt=f(e),K=i(e,"H3",{id:!0});var $s=n(K);ce=i($s,"A",{href:!0});var Ys=n(ce);go=s(Ys,"Zone Transfer"),Ys.forEach(t),$s.forEach(t),Zt=f(e),w=i(e,"P",{});var De=n(w);Zo=s(De,"Zone Transfer itself is not a vulnerability and is a procedure followed to transfer the records of a domain from one DNS server to another. For example, you need to replicate the records of your domain available in "),ge=i(De,"CODE",{});var qs=n(ge);zo=s(qs,"namecheap"),qs.forEach(t),Po=s(De," to AWS "),Ze=i(De,"CODE",{});var Ws=n(Ze);Lo=s(Ws,"Route53"),Ws.forEach(t),xo=s(De,"."),De.forEach(t),zt=f(e),v=i(e,"P",{});var A=n(v);Ro=s(A,"In a Zone transfer, the dns server sends a complete dns records file to another server. The file contains everything the DNS server has regarding that domain including its "),ze=i(A,"CODE",{});var Us=n(ze);Ho=s(Us,"A"),Us.forEach(t),Go=s(A,", "),Pe=i(A,"CODE",{});var Xs=n(Pe);Mo=s(Xs,"AAAA"),Xs.forEach(t),jo=s(A,", "),Le=i(A,"CODE",{});var Vs=n(Le);Bo=s(Vs,"CNAME"),Vs.forEach(t),$o=s(A,", and "),xe=i(A,"CODE",{});var Js=n(xe);Yo=s(Js,"SOA"),Js.forEach(t),qo=s(A," records. This includes the information which publicly isn’t accessible."),A.forEach(t),Pt=f(e),P=i(e,"P",{});var po=n(P);Wo=s(po,"For example, you can’t access the "),Re=i(po,"CODE",{});var Ks=n(Re);Uo=s(Ks,"CNAME"),Ks.forEach(t),Xo=s(po," records of any domain without having to brute force your way into it. But if the DNS server itself is offering the service, kaboom."),po.forEach(t),Lt=f(e),E=i(e,"P",{});var Y=n(E);Vo=s(Y,"Most of the pople in industry are already aware of Zone transfer, so lets directly jump to the part "),He=i(Y,"STRONG",{});var Qs=n(He);Jo=s(Qs,"How to find it?"),Qs.forEach(t),Ko=s(Y,". There are many tools available in the wild to find "),Ge=i(Y,"CODE",{});var el=n(Ge);Qo=s(el,"zone transfer"),el.forEach(t),ea=s(Y,". But the famous and the most simple one is "),Me=i(Y,"CODE",{});var tl=n(Me);ta=s(tl,"dig"),tl.forEach(t),oa=s(Y,":"),Y.forEach(t),xt=f(e),je=U(e,!1),Be=f(e),D=i(e,"UL",{});var Te=n(D);Q=i(Te,"LI",{});var ho=n(Q);aa=s(ho,"The "),$e=i(ho,"CODE",{});var ol=n($e);sa=s(ol,"-t AXFR"),ol.forEach(t),la=s(ho," option is a type of query to request zone transfer details."),ho.forEach(t),ra=f(Te),ee=i(Te,"LI",{});var vo=n(ee);ia=s(vo,"The "),Ye=i(vo,"CODE",{});var al=n(Ye);na=s(al,"+nocookie"),al.forEach(t),ca=s(vo," option would disable the use of DNS cookies."),vo.forEach(t),da=f(Te),te=i(Te,"LI",{});var mo=n(te);fa=s(mo,"And additionally, you can specify "),qe=i(mo,"CODE",{});var sl=n(qe);ua=s(sl,"@dns_server"),sl.forEach(t),pa=s(mo," which can be skipped to use default DNS servers. I would highly recommend this option if you a playing a CTF or inside a network where a private DNS server is accessible."),mo.forEach(t),Te.forEach(t),Rt=f(e),L=i(e,"P",{});var Fo=n(L);ha=s(Fo,"If successfull, this would list all the DNS records. This can also be accomplished using "),We=i(Fo,"CODE",{});var ll=n(We);va=s(ll,"subrake -d zonetransfer.me"),ll.forEach(t),ma=s(Fo," and you would get:"),Fo.forEach(t),Ht=f(e),x=i(e,"IMG",{width:!0,alt:!0,src:!0}),Gt=f(e),oe=i(e,"H3",{id:!0});var rl=n(oe);de=i(rl,"A",{href:!0});var il=n(de);Fa=s(il,"Subdomain Takeover"),il.forEach(t),rl.forEach(t),Mt=f(e),_=i(e,"P",{});var q=n(_);ya=s(q,"Subdomain Takeover unlike it sounds is actually the takeover of the service that subdomain is pointing to. Lets say "),Ue=i(q,"CODE",{});var nl=n(Ue);Ea=s(nl,"marketing.domain.tld"),nl.forEach(t),_a=s(q," was pointing to an Amazon "),Xe=i(q,"CODE",{});var cl=n(Xe);ba=s(cl,"S3"),cl.forEach(t),ka=s(q," bucket or "),Ve=i(q,"CODE",{});var dl=n(Ve);wa=s(dl,"ELastic Beanstalk"),dl.forEach(t),Da=s(q," service which actually didn’t exist."),q.forEach(t),jt=f(e),fe=i(e,"P",{});var fl=n(fe);Ta=s(fl,"A third party can come and claim this service. Now what happens is that the party that claimed the service can host whatever they want on that subdomain but that ofcourse is limited to what the service has to offer."),fl.forEach(t),Bt=f(e),ue=i(e,"P",{});var ul=n(ue);Sa=s(ul,"Most of the people in industry have been creating their automations of this. Some use their own tools and some have sort of created a workflow."),ul.forEach(t),$t=f(e),R=i(e,"P",{});var yo=n(R);Aa=s(yo,"You can go for a "),Je=i(yo,"CODE",{});var pl=n(Je);Ca=s(pl,"oneliner"),pl.forEach(t),Ia=s(yo,":"),yo.forEach(t),Yt=f(e),Ke=U(e,!1),Qe=f(e),pe=i(e,"P",{});var hl=n(pe);Na=s(hl,"Or you can find the subdomains first using different tools and public sources and probably use a tool to check the takeover."),hl.forEach(t),qt=f(e),et=U(e,!1),tt=f(e),he=i(e,"P",{});var vl=n(he);Oa=s(vl,"Checking the takeover:"),vl.forEach(t),Wt=f(e),ot=U(e,!1),at=f(e),H=i(e,"IMG",{width:!0,alt:!0,src:!0}),Ut=f(e),ae=i(e,"P",{});var Cs=n(ae);ga=s(Cs,"The list of services that are currently known to vulnerable to Subdomain Takeover can be found at: "),st=i(Cs,"STRONG",{});var ml=n(st);G=i(ml,"A",{href:!0,rel:!0,target:!0});var Fl=n(G);Za=s(Fl,"Can I Takeover XYZ"),Fl.forEach(t),ml.forEach(t),Cs.forEach(t),Xt=f(e),se=i(e,"H3",{id:!0});var yl=n(se);ve=i(yl,"A",{href:!0});var El=n(ve);za=s(El,"DNS Zone Takeover"),El.forEach(t),yl.forEach(t),Vt=f(e),T=i(e,"P",{});var Se=n(T);Pa=s(Se,"Zone Takeover is a term not too old right now and its actually is as it sounds unlike subdomain takeover. And it can be more "),lt=i(Se,"STRONG",{});var _l=n(lt);La=s(_l,"severe"),_l.forEach(t),xa=s(Se," as you have the control over the complete zone. In order words, you can host your own "),rt=i(Se,"CODE",{});var bl=n(rt);Ra=s(bl,"records"),bl.forEach(t),Ha=s(Se," and are not limited to the service being used like subdomain takeover."),Se.forEach(t),Jt=f(e),me=i(e,"P",{});var kl=n(me);Ga=s(kl,"The normal procedure that is being followed or atleast i follow this:"),kl.forEach(t),Kt=f(e),m=i(e,"UL",{});var C=n(m);it=i(C,"LI",{});var wl=n(it);Ma=s(wl,"I purchase the domain from namecheap or godaddy."),wl.forEach(t),ja=f(C),O=i(C,"LI",{});var Ae=n(O);Ba=s(Ae,"I create a new "),nt=i(Ae,"CODE",{});var Dl=n(nt);$a=s(Dl,"Hosted Zone"),Dl.forEach(t),Ya=s(Ae," in AWS "),ct=i(Ae,"CODE",{});var Tl=n(ct);qa=s(Tl,"Route53"),Tl.forEach(t),Wa=s(Ae," service."),Ae.forEach(t),Ua=f(C),dt=i(C,"LI",{});var Sl=n(dt);Xa=s(Sl,"The hosted zone gives me a set of nameservers."),Sl.forEach(t),Va=f(C),ft=i(C,"LI",{});var Al=n(ft);Ja=s(Al,"I enter these nameservers into the Authoritative nameservers section in GoDaddy or namecheap."),Al.forEach(t),Ka=f(C),y=i(C,"LI",{});var I=n(y);Qa=s(I,"Then i use the "),ut=i(I,"CODE",{});var Cl=n(ut);es=s(Cl,"Route53"),Cl.forEach(t),ts=s(I," service instead of GoDaddy or Namecheap to manage the records like "),pt=i(I,"CODE",{});var Il=n(pt);os=s(Il,"A"),Il.forEach(t),as=s(I,", "),ht=i(I,"CODE",{});var Nl=n(ht);ss=s(Nl,"AAAA"),Nl.forEach(t),ls=s(I,", or "),vt=i(I,"CODE",{});var Ol=n(vt);rs=s(Ol,"CNAME"),Ol.forEach(t),is=s(I,"."),I.forEach(t),C.forEach(t),Qt=f(e),Fe=i(e,"P",{});var gl=n(Fe);ns=s(gl,"Infact, if you ever worked with Cloudflare, you would know that you create a new website in Cloudflare. In result you get the nameservers. You then set the nameservers with the domain you purchased."),gl.forEach(t),eo=f(e),ye=i(e,"P",{});var Zl=n(ye);cs=s(Zl,"After doing so, you add/edit/remove the records within the cloudflare panel. Lets suppose, after a year you plan to not use the Cloudflare service anymore. So, you delete your website from cloudflare but doesn’t actually remove the authoritative entries in your domain settings from godaddy."),Zl.forEach(t),to=f(e),Ee=i(e,"P",{});var zl=n(Ee);ds=s(zl,"Since the nameserver entries already exist and still pointing to the service (aka cloudflare in this case), a third party can claim the service which would lead to zone takeover."),zl.forEach(t),oo=f(e),_e=i(e,"P",{});var Pl=n(_e);fs=s(Pl,"If you understand the above scenario, you can relate it to the subdomain takeover where you claim the stale service. But here, its the stale zone."),Pl.forEach(t),ao=f(e),le=i(e,"H4",{id:!0});var Ll=n(le);be=i(Ll,"A",{href:!0});var xl=n(be);us=s(xl,"Finding Zone Takeover"),xl.forEach(t),Ll.forEach(t),so=f(e),ke=i(e,"P",{});var Rl=n(ke);ps=s(Rl,"The good thing with zone takeover is you don’t have to brute force your way into it or find anything publicly. The information is already there, you just have to make sure its in the right condition."),Rl.forEach(t),lo=f(e),M=i(e,"P",{});var Eo=n(M);hs=s(Eo,"The first step would be to get the nameservers of the domain. We can use "),mt=i(Eo,"CODE",{});var Hl=n(mt);vs=s(Hl,"dig"),Hl.forEach(t),ms=s(Eo," for that:"),Eo.forEach(t),ro=f(e),Ft=U(e,!1),yt=f(e),j=i(e,"P",{});var _o=n(j);Fs=s(_o,"Or you can directly get the "),Et=i(_o,"CODE",{});var Gl=n(Et);ys=s(Gl,"NS"),Gl.forEach(t),Es=s(_o," records and start looking from there."),_o.forEach(t),io=f(e),_t=U(e,!1),bt=f(e),B=i(e,"IMG",{width:!0,alt:!0,src:!0}),no=f(e),S=i(e,"P",{});var Ce=n(S);_s=s(Ce,"The against each NS record, check if any of them fails to responsd. If it does, it can probably be vulnerable to zone takeover. The case it failes, you will have the status as "),kt=i(Ce,"STRONG",{});var Ml=n(kt);bs=s(Ml,"REFUSED"),Ml.forEach(t),ks=s(Ce," or "),wt=i(Ce,"STRONG",{});var jl=n(wt);ws=s(jl,"SERVFAIL"),jl.forEach(t),Ds=s(Ce,":"),Ce.forEach(t),co=f(e),Dt=U(e,!1),Tt=f(e),$=i(e,"P",{});var bo=n($);Ts=s(bo,"You can also check for "),St=i(bo,"CODE",{});var Bl=n(St);Ss=s(Bl,"SOA"),Bl.forEach(t),As=s(bo," which is what i would like to do instead (to be more concise):"),bo.forEach(t),fo=f(e),At=U(e,!1),Ct=ql(),this.h()},h(){u(F,"href","#introduction"),u(p,"id","introduction"),u(ie,"href","#subrake"),u(V,"id","subrake"),u(z,"href","https://github.com/hash3liZer/Subrake"),u(z,"rel","nofollow noopener noreferrer external"),u(z,"target","_blank"),u(ne,"href","#explanation"),u(J,"id","explanation"),u(ce,"href","#zone-transfer"),u(K,"id","zone-transfer"),je.a=Be,u(x,"width","828"),u(x,"alt","image"),Is(x.src,Os="https://github.com/hash3liZer/khatta/assets/29171692/e0552efd-45d1-41fc-ad00-63706be3849a")||u(x,"src",Os),u(de,"href","#subdomain-takeover"),u(oe,"id","subdomain-takeover"),Ke.a=Qe,et.a=tt,ot.a=at,u(H,"width","828"),u(H,"alt","image"),Is(H.src,gs="https://github.com/hash3liZer/khatta/assets/29171692/ce1559b0-e5fe-4fdc-ae2c-98de252c9970")||u(H,"src",gs),u(G,"href","https://github.com/EdOverflow/can-i-take-over-xyz"),u(G,"rel","nofollow noopener noreferrer external"),u(G,"target","_blank"),u(ve,"href","#dns-zone-takeover"),u(se,"id","dns-zone-takeover"),u(be,"href","#finding-zone-takeover"),u(le,"id","finding-zone-takeover"),Ft.a=yt,_t.a=bt,u(B,"width","894"),u(B,"alt","image"),Is(B.src,Zs="https://github.com/hash3liZer/khatta/assets/29171692/aba8e709-0b33-486a-ac5c-c0ab48264625")||u(B,"src",Zs),Dt.a=Tt,At.a=Ct},m(e,l){c(e,p,l),o(p,F),o(F,N),c(e,g,l),c(e,h,l),o(h,b),c(e,X,l),c(e,k,l),o(k,Ie),o(Ie,ko),o(k,wo),o(k,Ne),o(Ne,Do),o(k,To),o(k,Oe),o(Oe,So),c(e,It,l),c(e,V,l),o(V,ie),o(ie,Ao),c(e,Nt,l),c(e,Z,l),o(Z,Co),o(Z,z),o(z,Io),o(Z,No),c(e,Ot,l),c(e,J,l),o(J,ne),o(ne,Oo),c(e,gt,l),c(e,K,l),o(K,ce),o(ce,go),c(e,Zt,l),c(e,w,l),o(w,Zo),o(w,ge),o(ge,zo),o(w,Po),o(w,Ze),o(Ze,Lo),o(w,xo),c(e,zt,l),c(e,v,l),o(v,Ro),o(v,ze),o(ze,Ho),o(v,Go),o(v,Pe),o(Pe,Mo),o(v,jo),o(v,Le),o(Le,Bo),o(v,$o),o(v,xe),o(xe,Yo),o(v,qo),c(e,Pt,l),c(e,P,l),o(P,Wo),o(P,Re),o(Re,Uo),o(P,Xo),c(e,Lt,l),c(e,E,l),o(E,Vo),o(E,He),o(He,Jo),o(E,Ko),o(E,Ge),o(Ge,Qo),o(E,ea),o(E,Me),o(Me,ta),o(E,oa),c(e,xt,l),je.m(Ul,e,l),c(e,Be,l),c(e,D,l),o(D,Q),o(Q,aa),o(Q,$e),o($e,sa),o(Q,la),o(D,ra),o(D,ee),o(ee,ia),o(ee,Ye),o(Ye,na),o(ee,ca),o(D,da),o(D,te),o(te,fa),o(te,qe),o(qe,ua),o(te,pa),c(e,Rt,l),c(e,L,l),o(L,ha),o(L,We),o(We,va),o(L,ma),c(e,Ht,l),c(e,x,l),c(e,Gt,l),c(e,oe,l),o(oe,de),o(de,Fa),c(e,Mt,l),c(e,_,l),o(_,ya),o(_,Ue),o(Ue,Ea),o(_,_a),o(_,Xe),o(Xe,ba),o(_,ka),o(_,Ve),o(Ve,wa),o(_,Da),c(e,jt,l),c(e,fe,l),o(fe,Ta),c(e,Bt,l),c(e,ue,l),o(ue,Sa),c(e,$t,l),c(e,R,l),o(R,Aa),o(R,Je),o(Je,Ca),o(R,Ia),c(e,Yt,l),Ke.m(Xl,e,l),c(e,Qe,l),c(e,pe,l),o(pe,Na),c(e,qt,l),et.m(Vl,e,l),c(e,tt,l),c(e,he,l),o(he,Oa),c(e,Wt,l),ot.m(Jl,e,l),c(e,at,l),c(e,H,l),c(e,Ut,l),c(e,ae,l),o(ae,ga),o(ae,st),o(st,G),o(G,Za),c(e,Xt,l),c(e,se,l),o(se,ve),o(ve,za),c(e,Vt,l),c(e,T,l),o(T,Pa),o(T,lt),o(lt,La),o(T,xa),o(T,rt),o(rt,Ra),o(T,Ha),c(e,Jt,l),c(e,me,l),o(me,Ga),c(e,Kt,l),c(e,m,l),o(m,it),o(it,Ma),o(m,ja),o(m,O),o(O,Ba),o(O,nt),o(nt,$a),o(O,Ya),o(O,ct),o(ct,qa),o(O,Wa),o(m,Ua),o(m,dt),o(dt,Xa),o(m,Va),o(m,ft),o(ft,Ja),o(m,Ka),o(m,y),o(y,Qa),o(y,ut),o(ut,es),o(y,ts),o(y,pt),o(pt,os),o(y,as),o(y,ht),o(ht,ss),o(y,ls),o(y,vt),o(vt,rs),o(y,is),c(e,Qt,l),c(e,Fe,l),o(Fe,ns),c(e,eo,l),c(e,ye,l),o(ye,cs),c(e,to,l),c(e,Ee,l),o(Ee,ds),c(e,oo,l),c(e,_e,l),o(_e,fs),c(e,ao,l),c(e,le,l),o(le,be),o(be,us),c(e,so,l),c(e,ke,l),o(ke,ps),c(e,lo,l),c(e,M,l),o(M,hs),o(M,mt),o(mt,vs),o(M,ms),c(e,ro,l),Ft.m(Kl,e,l),c(e,yt,l),c(e,j,l),o(j,Fs),o(j,Et),o(Et,ys),o(j,Es),c(e,io,l),_t.m(Ql,e,l),c(e,bt,l),c(e,B,l),c(e,no,l),c(e,S,l),o(S,_s),o(S,kt),o(kt,bs),o(S,ks),o(S,wt),o(wt,ws),o(S,Ds),c(e,co,l),Dt.m(er,e,l),c(e,Tt,l),c(e,$,l),o($,Ts),o($,St),o(St,Ss),o($,As),c(e,fo,l),At.m(tr,e,l),c(e,Ct,l)},p:ur,d(e){e&&t(p),e&&t(g),e&&t(h),e&&t(X),e&&t(k),e&&t(It),e&&t(V),e&&t(Nt),e&&t(Z),e&&t(Ot),e&&t(J),e&&t(gt),e&&t(K),e&&t(Zt),e&&t(w),e&&t(zt),e&&t(v),e&&t(Pt),e&&t(P),e&&t(Lt),e&&t(E),e&&t(xt),e&&je.d(),e&&t(Be),e&&t(D),e&&t(Rt),e&&t(L),e&&t(Ht),e&&t(x),e&&t(Gt),e&&t(oe),e&&t(Mt),e&&t(_),e&&t(jt),e&&t(fe),e&&t(Bt),e&&t(ue),e&&t($t),e&&t(R),e&&t(Yt),e&&Ke.d(),e&&t(Qe),e&&t(pe),e&&t(qt),e&&et.d(),e&&t(tt),e&&t(he),e&&t(Wt),e&&ot.d(),e&&t(at),e&&t(H),e&&t(Ut),e&&t(ae),e&&t(Xt),e&&t(se),e&&t(Vt),e&&t(T),e&&t(Jt),e&&t(me),e&&t(Kt),e&&t(m),e&&t(Qt),e&&t(Fe),e&&t(eo),e&&t(ye),e&&t(to),e&&t(Ee),e&&t(oo),e&&t(_e),e&&t(ao),e&&t(le),e&&t(so),e&&t(ke),e&&t(lo),e&&t(M),e&&t(ro),e&&Ft.d(),e&&t(yt),e&&t(j),e&&t(io),e&&_t.d(),e&&t(bt),e&&t(B),e&&t(no),e&&t(S),e&&t(co),e&&Dt.d(),e&&t(Tt),e&&t($),e&&t(fo),e&&t(Ct),e&&At.d()}}}function vr(re){let p,F;const N=[re[0],Wl];let g={$$slots:{default:[hr]},$$scope:{ctx:re}};for(let h=0;h<N.length;h+=1)g=Ns(g,N[h]);return p=new pr({props:g}),{c(){lr(p.$$.fragment)},l(h){rr(p.$$.fragment,h)},m(h,b){ir(p,h,b),F=!0},p(h,[b]){const X=b&1?nr(N,[b&1&&$l(h[0]),b&0&&$l(Wl)]):{};b&2&&(X.$$scope={dirty:b,ctx:h}),p.$set(X)},i(h){F||(cr(p.$$.fragment,h),F=!0)},o(h){dr(p.$$.fragment,h),F=!1},d(h){fr(p,h)}}}const Wl={title:"A Guide to Zone Transfer, DNS Zone Takeover and Subdomain Takeover",tags:["dns-zone-takeover","dns-zone-transfer","subdomain-takeover","bugbounty","infosec","reconnaissance","automated-tool"],categories:["Bug Bounty","Projects"],summary:"In this guide, we will be looking over vulnerabilites associated with a domain normally occured due to the negligence from the develper team. The terms we will see are Zone Transfer, DNS Zone Takeover and Subdomain Takeover.",created:"2023-06-30T00:00:00.000Z",lastmod:"2023-06-30T00:00:00.000Z",image:"https://github.com/hash3liZer/khatta/assets/29171692/755e47ec-8f67-45e9-a7cb-04efe7584127",flags:[],updated:"2023-07-01T17:46:20.381Z",slug:"/blog/2023/subrake-a-dns-automated-scanner/+page.md",path:"/blog/2023/subrake-a-dns-automated-scanner",toc:[{depth:2,title:"Introduction",slug:"introduction"},{depth:2,title:"Subrake",slug:"subrake"},{depth:2,title:"Explanation",slug:"explanation"},{depth:3,title:"Zone Transfer",slug:"zone-transfer"},{depth:3,title:"Subdomain Takeover",slug:"subdomain-takeover"},{depth:3,title:"DNS Zone Takeover",slug:"dns-zone-takeover"},{depth:4,title:"Finding Zone Takeover",slug:"finding-zone-takeover"}]};function mr(re,p,F){return re.$$set=N=>{F(0,p=Ns(Ns({},p),Yl(N)))},p=Yl(p),[p]}class Er extends or{constructor(p){super(),ar(this,p,mr,vr,sr,{})}}export{Er as component};
