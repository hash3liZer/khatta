import{S as Qr,i as ei,s as ti,U as yl,y as oi,z as ai,A as si,V as li,W as Wr,g as ri,d as ii,B as ni,X as jr,k as r,q as a,a as d,Y as K,l as i,m as n,r as s,h as t,c as f,Z as Q,n as u,T as $t,b as c,D as o,E as ci}from"../chunks/index.725d15e1.js";import{P as di}from"../chunks/post_layout.b6bd0bbf.js";function fi(he){let p,y,g,Z,h,k,ee,_,Me,qo,Xo,We,Vo,Jo,je,Ko,Ut,te,ve,Qo,Yt,z,ea,P,ta,oa,qt,oe,me,aa,Xt,ae,ye,sa,Vt,w,la,Be,ra,ia,$e,na,ca,Jt,v,da,Ue,fa,ua,Ye,pa,ha,qe,va,ma,Xe,ya,Fa,Kt,L,Ea,Ve,ba,ka,Qt,E,_a,Je,wa,Da,Ke,Ta,Sa,Qe,Aa,Ca,eo,et,$r=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">dig zonetransfer.me -t AXFR +nocookie @dns_address</span></div></code></div></pre>`,tt,D,se,Ia,ot,Na,ga,Oa,le,Za,at,za,Pa,La,re,xa,st,Ra,Ha,to,x,Ga,lt,Ma,Wa,oo,R,Fl,ao,ie,Fe,ja,so,b,Ba,rt,$a,Ua,it,Ya,qa,nt,Xa,Va,lo,Ee,Ja,ro,be,Ka,io,H,Qa,ct,es,ts,no,dt,Ur=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">subfinder </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d HOST </span><span style="color: #89DDFF">&gt;&gt;</span><span style="color: #EEFFFF"> FILE; assetfinder --subs</span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">only HOST </span><span style="color: #89DDFF">&gt;&gt;</span><span style="color: #EEFFFF"> FILE; amass enum </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">norecursive </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">noalts </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d HOST </span><span style="color: #89DDFF">&gt;&gt;</span><span style="color: #EEFFFF"> FILE; subjack </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">w FILE </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">t </span><span style="color: #F78C6C">100</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">timeout </span><span style="color: #F78C6C">30</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">ssl </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">c $GOPATH</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">src</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">github</span><span style="color: #89DDFF">.</span><span style="color: #F07178">com</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">haccer</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">subjack</span><span style="color: #89DDFF">/</span><span style="color: #EEFFFF">fingerprints</span><span style="color: #89DDFF">.</span><span style="color: #F07178">json</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">v </span><span style="color: #F78C6C">3</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&gt;&gt;</span><span style="color: #EEFFFF"> takeover ; </span></div></code></div></pre>`,ft,ke,os,co,ut,Yr=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">python3 sublist3r</span><span style="color: #89DDFF">.</span><span style="color: #F07178">py</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d target</span><span style="color: #89DDFF">.</span><span style="color: #F07178">com</span></div><div class='line'><span style="color: #EEFFFF">amass enum </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d target</span><span style="color: #89DDFF">.</span><span style="color: #F07178">com</span></div><div class='line'><span style="color: #EEFFFF">...</span></div></code></div></pre>`,pt,_e,as,fo,ht,qr=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">subrake </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">d target</span><span style="color: #89DDFF">.</span><span style="color: #F07178">com</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">w </span><span style="color: #89DDFF">./</span><span style="color: #EEFFFF">finalwordlists</span><span style="color: #89DDFF">.</span><span style="color: #F07178">txt</span></div></code></div></pre>`,vt,G,El,uo,ne,ss,mt,M,ls,po,ce,we,rs,ho,T,is,yt,ns,cs,Ft,ds,fs,vo,De,us,mo,m,Et,ps,hs,O,vs,bt,ms,ys,kt,Fs,Es,bs,_t,ks,_s,wt,ws,Ds,F,Ts,Dt,Ss,As,Tt,Cs,Is,St,Ns,gs,At,Os,Zs,yo,S,zs,Ct,Ps,Ls,It,xs,Rs,Fo,W,Hs,Nt,Gs,Ms,Eo,j,Ws,gt,js,Bs,bo,Te,$s,ko,de,Se,Us,_o,Ae,Ys,wo,B,qs,Ot,Xs,Vs,Do,Zt,Xr=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">dig shameerkashif.me +trace +all</span></div></code></div></pre>`,zt,$,Js,Pt,Ks,Qs,To,Lt,Vr=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">dig shameerkashif.me NS</span></div></code></div></pre>`,xt,U,bl,So,A,el,Rt,tl,ol,Ht,al,sl,Ao,Gt,Jr=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">dig shameerkashif.me @ns1.digitalocean.com</span></div></code></div></pre>`,Mt,Y,ll,Wt,rl,il,Co,jt,Kr=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">dig shameerkashif.me @ns1.digitalocean.com SOA</span></div></code></div></pre>`,Bt,fe,nl,q,cl,Io,Ce,dl,No,X,kl,go,ue,Ie,fl,Oo,Ne,ul,Zo,ge,_l,zo,pe,Oe,pl,Po,Ze,hl;return{c(){p=r("h2"),y=r("a"),g=a("Introduction"),Z=d(),h=r("p"),k=a("DNS have been there for years now to help you find things normally you wouldn’t remember. In this guide, we will go through the following set of problems that a third party can find and take advantage of in negative terms:"),ee=d(),_=r("ul"),Me=r("li"),qo=a("DNS Zone Transfer"),Xo=d(),We=r("li"),Vo=a("Subdomain Takeover"),Jo=d(),je=r("li"),Ko=a("DNS Zone Transfer"),Ut=d(),te=r("h2"),ve=r("a"),Qo=a("Subrake"),Yt=d(),z=r("p"),ea=a("The primary reason i wrote this blog post was this project i am working on: "),P=r("a"),ta=a("Subrake"),oa=a(". It’s an automated DNS scanner to cover various issues in a single go. Let me know what you think about it in the comment section…"),qt=d(),oe=r("h2"),me=r("a"),aa=a("Explanation"),Xt=d(),ae=r("h3"),ye=r("a"),sa=a("Zone Transfer"),Vt=d(),w=r("p"),la=a("Zone Transfer itself is not a vulnerability and is a procedure followed to transfer the records of a domain from one DNS server to another. For example, you need to replicate the records of your domain available in "),Be=r("code"),ra=a("namecheap"),ia=a(" to AWS "),$e=r("code"),na=a("Route53"),ca=a("."),Jt=d(),v=r("p"),da=a("In a Zone transfer, the dns server sends a complete dns records file to another server. The file contains everything the DNS server has regarding that domain including its "),Ue=r("code"),fa=a("A"),ua=a(", "),Ye=r("code"),pa=a("AAAA"),ha=a(", "),qe=r("code"),va=a("CNAME"),ma=a(", and "),Xe=r("code"),ya=a("SOA"),Fa=a(" records. This includes the information which publicly isn’t accessible."),Kt=d(),L=r("p"),Ea=a("For example, you can’t access the "),Ve=r("code"),ba=a("CNAME"),ka=a(" records of any domain without having to brute force your way into it. But if the DNS server itself is offering the service, kaboom."),Qt=d(),E=r("p"),_a=a("Most of the pople in industry are already aware of Zone transfer, so lets directly jump to the part "),Je=r("strong"),wa=a("How to find it?"),Da=a(". There are many tools available in the wild to find "),Ke=r("code"),Ta=a("zone transfer"),Sa=a(". But the famous and the most simple one is "),Qe=r("code"),Aa=a("dig"),Ca=a(":"),eo=d(),et=new K(!1),tt=d(),D=r("ul"),se=r("li"),Ia=a("The "),ot=r("code"),Na=a("-t AXFR"),ga=a(" option is a type of query to request zone transfer details."),Oa=d(),le=r("li"),Za=a("The "),at=r("code"),za=a("+nocookie"),Pa=a(" option would disable the use of DNS cookies."),La=d(),re=r("li"),xa=a("And additionally, you can specify "),st=r("code"),Ra=a("@dns_server"),Ha=a(" which can be skipped to use default DNS servers. I would highly recommend this option if you a playing a CTF or inside a network where a private DNS server is accessible."),to=d(),x=r("p"),Ga=a("If successfull, this would list all the DNS records. This can also be accomplished using "),lt=r("code"),Ma=a("subrake -d zonetransfer.me"),Wa=a(" and you would get:"),oo=d(),R=r("img"),ao=d(),ie=r("h3"),Fe=r("a"),ja=a("Subdomain Takeover"),so=d(),b=r("p"),Ba=a("Subdomain Takeover unlike it sounds is actually the takeover of the service that subdomain is pointing to. Lets say "),rt=r("code"),$a=a("marketing.domain.tld"),Ua=a(" was pointing to an Amazon "),it=r("code"),Ya=a("S3"),qa=a(" bucket or "),nt=r("code"),Xa=a("ELastic Beanstalk"),Va=a(" service which actually didn’t exist."),lo=d(),Ee=r("p"),Ja=a("A third party can come and claim this service. Now what happens is that the party that claimed the service can host whatever they want on that subdomain but that ofcourse is limited to what the service has to offer."),ro=d(),be=r("p"),Ka=a("Most of the people in industry have been creating their automations of this. Some use their own tools and some have sort of created a workflow."),io=d(),H=r("p"),Qa=a("You can go for a "),ct=r("code"),es=a("oneliner"),ts=a(":"),no=d(),dt=new K(!1),ft=d(),ke=r("p"),os=a("Or you can find the subdomains first using different tools and public sources and probably use a tool to check the takeover."),co=d(),ut=new K(!1),pt=d(),_e=r("p"),as=a("Checking the takeover:"),fo=d(),ht=new K(!1),vt=d(),G=r("img"),uo=d(),ne=r("p"),ss=a("The list of services that are currently known to vulnerable to Subdomain Takeover can be found at: "),mt=r("strong"),M=r("a"),ls=a("Can I Takeover XYZ"),po=d(),ce=r("h3"),we=r("a"),rs=a("DNS Zone Takeover"),ho=d(),T=r("p"),is=a("Zone Takeover is a term not too old right now and its actually is as it sounds unlike subdomain takeover. And it can be more "),yt=r("strong"),ns=a("severe"),cs=a(" as you have the control over the complete zone. In order words, you can host your own "),Ft=r("code"),ds=a("records"),fs=a(" and are not limited to the service being used like subdomain takeover."),vo=d(),De=r("p"),us=a("The normal procedure that is being followed or atleast i follow this:"),mo=d(),m=r("ul"),Et=r("li"),ps=a("I purchase the domain from namecheap or godaddy."),hs=d(),O=r("li"),vs=a("I create a new "),bt=r("code"),ms=a("Hosted Zone"),ys=a(" in AWS "),kt=r("code"),Fs=a("Route53"),Es=a(" service."),bs=d(),_t=r("li"),ks=a("The hosted zone gives me a set of nameservers."),_s=d(),wt=r("li"),ws=a("I enter these nameservers into the Authoritative nameservers section in GoDaddy or namecheap."),Ds=d(),F=r("li"),Ts=a("Then i use the "),Dt=r("code"),Ss=a("Route53"),As=a(" service instead of GoDaddy or Namecheap to manage the records like "),Tt=r("code"),Cs=a("A"),Is=a(", "),St=r("code"),Ns=a("AAAA"),gs=a(", or "),At=r("code"),Os=a("CNAME"),Zs=a("."),yo=d(),S=r("p"),zs=a("Infact, if you ever worked with "),Ct=r("strong"),Ps=a("Cloudflare"),Ls=a(", you would know that you create a new website in Cloudflare. In result you get the nameservers. You then set the "),It=r("code"),xs=a("nameservers"),Rs=a(" with the domain you purchased."),Fo=d(),W=r("p"),Hs=a("After doing so, you "),Nt=r("em"),Gs=a("add/edit/remove"),Ms=a(" the records within the cloudflare panel. Lets suppose, after a year you plan to not use the Cloudflare service anymore. So, you delete your website from cloudflare but doesn’t actually remove the authoritative entries in your domain settings from godaddy."),Eo=d(),j=r("p"),Ws=a("Since the nameserver entries already exist and still pointing to the service (aka cloudflare in this case), a third party can claim the service which would lead to "),gt=r("strong"),js=a("zone takeover"),Bs=a("."),bo=d(),Te=r("p"),$s=a("If you understand the above scenario, you can relate it to the subdomain takeover where you claim the stale service. But here, its the stale zone."),ko=d(),de=r("h4"),Se=r("a"),Us=a("Finding Zone Takeover"),_o=d(),Ae=r("p"),Ys=a("The good thing with zone takeover is you don’t have to brute force your way into it or find anything publicly. The information is already there, you just have to make sure its in the right condition."),wo=d(),B=r("p"),qs=a("The first step would be to get the nameservers of the domain. We can use "),Ot=r("code"),Xs=a("dig"),Vs=a(" for that:"),Do=d(),Zt=new K(!1),zt=d(),$=r("p"),Js=a("Or you can directly get the "),Pt=r("code"),Ks=a("NS"),Qs=a(" records and start looking from there."),To=d(),Lt=new K(!1),xt=d(),U=r("img"),So=d(),A=r("p"),el=a("The against each NS record, check if any of them fails to responsd. If it does, it can probably be vulnerable to zone takeover. The case it failes, you will have the status as "),Rt=r("strong"),tl=a("REFUSED"),ol=a(" or "),Ht=r("strong"),al=a("SERVFAIL"),sl=a(":"),Ao=d(),Gt=new K(!1),Mt=d(),Y=r("p"),ll=a("You can also check for "),Wt=r("code"),rl=a("SOA"),il=a(" which is what i would like to do instead (to be more concise):"),Co=d(),jt=new K(!1),Bt=d(),fe=r("p"),nl=a("Well, if it doesn’t responsd, you can try to claim the service. As of now, the current vulnerable services are available at: "),q=r("a"),cl=a("Can I Takeover DNS"),Io=d(),Ce=r("p"),dl=a("Well, with subrake, it first tries to resolve each nameserver and if it does then it tries to guess the service and tells if its vulnerable or not. Something like this:"),No=d(),X=r("img"),go=d(),ue=r("h2"),Ie=r("a"),fl=a("Using Subrake"),Oo=d(),Ne=r("p"),ul=a("Subrake can help you pick all 3 above cases. The complete information and details can be found at the link i mentioned in the start of this blog. I am simply attaching a screenshot with the details."),Zo=d(),ge=r("img"),zo=d(),pe=r("h2"),Oe=r("a"),pl=a("Conclusion"),Po=d(),Ze=r("p"),hl=a("First of all, i hope this guide was helpful 😅. We saw 3 different cases namely, Zone Transfer, Zone Takeover and Subdomain Takeover. The mitigation simply is to be aware of when you remove a service. Make sure the entries in your DNS gets updated as well. Or wrap the service completely."),this.h()},l(e){p=i(e,"H2",{id:!0});var l=n(p);y=i(l,"A",{href:!0});var wl=n(y);g=s(wl,"Introduction"),wl.forEach(t),l.forEach(t),Z=f(e),h=i(e,"P",{});var Dl=n(h);k=s(Dl,"DNS have been there for years now to help you find things normally you wouldn’t remember. In this guide, we will go through the following set of problems that a third party can find and take advantage of in negative terms:"),Dl.forEach(t),ee=f(e),_=i(e,"UL",{});var ze=n(_);Me=i(ze,"LI",{});var Tl=n(Me);qo=s(Tl,"DNS Zone Transfer"),Tl.forEach(t),Xo=f(ze),We=i(ze,"LI",{});var Sl=n(We);Vo=s(Sl,"Subdomain Takeover"),Sl.forEach(t),Jo=f(ze),je=i(ze,"LI",{});var Al=n(je);Ko=s(Al,"DNS Zone Transfer"),Al.forEach(t),ze.forEach(t),Ut=f(e),te=i(e,"H2",{id:!0});var Cl=n(te);ve=i(Cl,"A",{href:!0});var Il=n(ve);Qo=s(Il,"Subrake"),Il.forEach(t),Cl.forEach(t),Yt=f(e),z=i(e,"P",{});var Lo=n(z);ea=s(Lo,"The primary reason i wrote this blog post was this project i am working on: "),P=i(Lo,"A",{href:!0,rel:!0,target:!0});var Nl=n(P);ta=s(Nl,"Subrake"),Nl.forEach(t),oa=s(Lo,". It’s an automated DNS scanner to cover various issues in a single go. Let me know what you think about it in the comment section…"),Lo.forEach(t),qt=f(e),oe=i(e,"H2",{id:!0});var gl=n(oe);me=i(gl,"A",{href:!0});var Ol=n(me);aa=s(Ol,"Explanation"),Ol.forEach(t),gl.forEach(t),Xt=f(e),ae=i(e,"H3",{id:!0});var Zl=n(ae);ye=i(Zl,"A",{href:!0});var zl=n(ye);sa=s(zl,"Zone Transfer"),zl.forEach(t),Zl.forEach(t),Vt=f(e),w=i(e,"P",{});var Pe=n(w);la=s(Pe,"Zone Transfer itself is not a vulnerability and is a procedure followed to transfer the records of a domain from one DNS server to another. For example, you need to replicate the records of your domain available in "),Be=i(Pe,"CODE",{});var Pl=n(Be);ra=s(Pl,"namecheap"),Pl.forEach(t),ia=s(Pe," to AWS "),$e=i(Pe,"CODE",{});var Ll=n($e);na=s(Ll,"Route53"),Ll.forEach(t),ca=s(Pe,"."),Pe.forEach(t),Jt=f(e),v=i(e,"P",{});var C=n(v);da=s(C,"In a Zone transfer, the dns server sends a complete dns records file to another server. The file contains everything the DNS server has regarding that domain including its "),Ue=i(C,"CODE",{});var xl=n(Ue);fa=s(xl,"A"),xl.forEach(t),ua=s(C,", "),Ye=i(C,"CODE",{});var Rl=n(Ye);pa=s(Rl,"AAAA"),Rl.forEach(t),ha=s(C,", "),qe=i(C,"CODE",{});var Hl=n(qe);va=s(Hl,"CNAME"),Hl.forEach(t),ma=s(C,", and "),Xe=i(C,"CODE",{});var Gl=n(Xe);ya=s(Gl,"SOA"),Gl.forEach(t),Fa=s(C," records. This includes the information which publicly isn’t accessible."),C.forEach(t),Kt=f(e),L=i(e,"P",{});var xo=n(L);Ea=s(xo,"For example, you can’t access the "),Ve=i(xo,"CODE",{});var Ml=n(Ve);ba=s(Ml,"CNAME"),Ml.forEach(t),ka=s(xo," records of any domain without having to brute force your way into it. But if the DNS server itself is offering the service, kaboom."),xo.forEach(t),Qt=f(e),E=i(e,"P",{});var V=n(E);_a=s(V,"Most of the pople in industry are already aware of Zone transfer, so lets directly jump to the part "),Je=i(V,"STRONG",{});var Wl=n(Je);wa=s(Wl,"How to find it?"),Wl.forEach(t),Da=s(V,". There are many tools available in the wild to find "),Ke=i(V,"CODE",{});var jl=n(Ke);Ta=s(jl,"zone transfer"),jl.forEach(t),Sa=s(V,". But the famous and the most simple one is "),Qe=i(V,"CODE",{});var Bl=n(Qe);Aa=s(Bl,"dig"),Bl.forEach(t),Ca=s(V,":"),V.forEach(t),eo=f(e),et=Q(e,!1),tt=f(e),D=i(e,"UL",{});var Le=n(D);se=i(Le,"LI",{});var Ro=n(se);Ia=s(Ro,"The "),ot=i(Ro,"CODE",{});var $l=n(ot);Na=s($l,"-t AXFR"),$l.forEach(t),ga=s(Ro," option is a type of query to request zone transfer details."),Ro.forEach(t),Oa=f(Le),le=i(Le,"LI",{});var Ho=n(le);Za=s(Ho,"The "),at=i(Ho,"CODE",{});var Ul=n(at);za=s(Ul,"+nocookie"),Ul.forEach(t),Pa=s(Ho," option would disable the use of DNS cookies."),Ho.forEach(t),La=f(Le),re=i(Le,"LI",{});var Go=n(re);xa=s(Go,"And additionally, you can specify "),st=i(Go,"CODE",{});var Yl=n(st);Ra=s(Yl,"@dns_server"),Yl.forEach(t),Ha=s(Go," which can be skipped to use default DNS servers. I would highly recommend this option if you a playing a CTF or inside a network where a private DNS server is accessible."),Go.forEach(t),Le.forEach(t),to=f(e),x=i(e,"P",{});var Mo=n(x);Ga=s(Mo,"If successfull, this would list all the DNS records. This can also be accomplished using "),lt=i(Mo,"CODE",{});var ql=n(lt);Ma=s(ql,"subrake -d zonetransfer.me"),ql.forEach(t),Wa=s(Mo," and you would get:"),Mo.forEach(t),oo=f(e),R=i(e,"IMG",{width:!0,alt:!0,src:!0}),ao=f(e),ie=i(e,"H3",{id:!0});var Xl=n(ie);Fe=i(Xl,"A",{href:!0});var Vl=n(Fe);ja=s(Vl,"Subdomain Takeover"),Vl.forEach(t),Xl.forEach(t),so=f(e),b=i(e,"P",{});var J=n(b);Ba=s(J,"Subdomain Takeover unlike it sounds is actually the takeover of the service that subdomain is pointing to. Lets say "),rt=i(J,"CODE",{});var Jl=n(rt);$a=s(Jl,"marketing.domain.tld"),Jl.forEach(t),Ua=s(J," was pointing to an Amazon "),it=i(J,"CODE",{});var Kl=n(it);Ya=s(Kl,"S3"),Kl.forEach(t),qa=s(J," bucket or "),nt=i(J,"CODE",{});var Ql=n(nt);Xa=s(Ql,"ELastic Beanstalk"),Ql.forEach(t),Va=s(J," service which actually didn’t exist."),J.forEach(t),lo=f(e),Ee=i(e,"P",{});var er=n(Ee);Ja=s(er,"A third party can come and claim this service. Now what happens is that the party that claimed the service can host whatever they want on that subdomain but that ofcourse is limited to what the service has to offer."),er.forEach(t),ro=f(e),be=i(e,"P",{});var tr=n(be);Ka=s(tr,"Most of the people in industry have been creating their automations of this. Some use their own tools and some have sort of created a workflow."),tr.forEach(t),io=f(e),H=i(e,"P",{});var Wo=n(H);Qa=s(Wo,"You can go for a "),ct=i(Wo,"CODE",{});var or=n(ct);es=s(or,"oneliner"),or.forEach(t),ts=s(Wo,":"),Wo.forEach(t),no=f(e),dt=Q(e,!1),ft=f(e),ke=i(e,"P",{});var ar=n(ke);os=s(ar,"Or you can find the subdomains first using different tools and public sources and probably use a tool to check the takeover."),ar.forEach(t),co=f(e),ut=Q(e,!1),pt=f(e),_e=i(e,"P",{});var sr=n(_e);as=s(sr,"Checking the takeover:"),sr.forEach(t),fo=f(e),ht=Q(e,!1),vt=f(e),G=i(e,"IMG",{width:!0,alt:!0,src:!0}),uo=f(e),ne=i(e,"P",{});var vl=n(ne);ss=s(vl,"The list of services that are currently known to vulnerable to Subdomain Takeover can be found at: "),mt=i(vl,"STRONG",{});var lr=n(mt);M=i(lr,"A",{href:!0,rel:!0,target:!0});var rr=n(M);ls=s(rr,"Can I Takeover XYZ"),rr.forEach(t),lr.forEach(t),vl.forEach(t),po=f(e),ce=i(e,"H3",{id:!0});var ir=n(ce);we=i(ir,"A",{href:!0});var nr=n(we);rs=s(nr,"DNS Zone Takeover"),nr.forEach(t),ir.forEach(t),ho=f(e),T=i(e,"P",{});var xe=n(T);is=s(xe,"Zone Takeover is a term not too old right now and its actually is as it sounds unlike subdomain takeover. And it can be more "),yt=i(xe,"STRONG",{});var cr=n(yt);ns=s(cr,"severe"),cr.forEach(t),cs=s(xe," as you have the control over the complete zone. In order words, you can host your own "),Ft=i(xe,"CODE",{});var dr=n(Ft);ds=s(dr,"records"),dr.forEach(t),fs=s(xe," and are not limited to the service being used like subdomain takeover."),xe.forEach(t),vo=f(e),De=i(e,"P",{});var fr=n(De);us=s(fr,"The normal procedure that is being followed or atleast i follow this:"),fr.forEach(t),mo=f(e),m=i(e,"UL",{});var I=n(m);Et=i(I,"LI",{});var ur=n(Et);ps=s(ur,"I purchase the domain from namecheap or godaddy."),ur.forEach(t),hs=f(I),O=i(I,"LI",{});var Re=n(O);vs=s(Re,"I create a new "),bt=i(Re,"CODE",{});var pr=n(bt);ms=s(pr,"Hosted Zone"),pr.forEach(t),ys=s(Re," in AWS "),kt=i(Re,"CODE",{});var hr=n(kt);Fs=s(hr,"Route53"),hr.forEach(t),Es=s(Re," service."),Re.forEach(t),bs=f(I),_t=i(I,"LI",{});var vr=n(_t);ks=s(vr,"The hosted zone gives me a set of nameservers."),vr.forEach(t),_s=f(I),wt=i(I,"LI",{});var mr=n(wt);ws=s(mr,"I enter these nameservers into the Authoritative nameservers section in GoDaddy or namecheap."),mr.forEach(t),Ds=f(I),F=i(I,"LI",{});var N=n(F);Ts=s(N,"Then i use the "),Dt=i(N,"CODE",{});var yr=n(Dt);Ss=s(yr,"Route53"),yr.forEach(t),As=s(N," service instead of GoDaddy or Namecheap to manage the records like "),Tt=i(N,"CODE",{});var Fr=n(Tt);Cs=s(Fr,"A"),Fr.forEach(t),Is=s(N,", "),St=i(N,"CODE",{});var Er=n(St);Ns=s(Er,"AAAA"),Er.forEach(t),gs=s(N,", or "),At=i(N,"CODE",{});var br=n(At);Os=s(br,"CNAME"),br.forEach(t),Zs=s(N,"."),N.forEach(t),I.forEach(t),yo=f(e),S=i(e,"P",{});var He=n(S);zs=s(He,"Infact, if you ever worked with "),Ct=i(He,"STRONG",{});var kr=n(Ct);Ps=s(kr,"Cloudflare"),kr.forEach(t),Ls=s(He,", you would know that you create a new website in Cloudflare. In result you get the nameservers. You then set the "),It=i(He,"CODE",{});var _r=n(It);xs=s(_r,"nameservers"),_r.forEach(t),Rs=s(He," with the domain you purchased."),He.forEach(t),Fo=f(e),W=i(e,"P",{});var jo=n(W);Hs=s(jo,"After doing so, you "),Nt=i(jo,"EM",{});var wr=n(Nt);Gs=s(wr,"add/edit/remove"),wr.forEach(t),Ms=s(jo," the records within the cloudflare panel. Lets suppose, after a year you plan to not use the Cloudflare service anymore. So, you delete your website from cloudflare but doesn’t actually remove the authoritative entries in your domain settings from godaddy."),jo.forEach(t),Eo=f(e),j=i(e,"P",{});var Bo=n(j);Ws=s(Bo,"Since the nameserver entries already exist and still pointing to the service (aka cloudflare in this case), a third party can claim the service which would lead to "),gt=i(Bo,"STRONG",{});var Dr=n(gt);js=s(Dr,"zone takeover"),Dr.forEach(t),Bs=s(Bo,"."),Bo.forEach(t),bo=f(e),Te=i(e,"P",{});var Tr=n(Te);$s=s(Tr,"If you understand the above scenario, you can relate it to the subdomain takeover where you claim the stale service. But here, its the stale zone."),Tr.forEach(t),ko=f(e),de=i(e,"H4",{id:!0});var Sr=n(de);Se=i(Sr,"A",{href:!0});var Ar=n(Se);Us=s(Ar,"Finding Zone Takeover"),Ar.forEach(t),Sr.forEach(t),_o=f(e),Ae=i(e,"P",{});var Cr=n(Ae);Ys=s(Cr,"The good thing with zone takeover is you don’t have to brute force your way into it or find anything publicly. The information is already there, you just have to make sure its in the right condition."),Cr.forEach(t),wo=f(e),B=i(e,"P",{});var $o=n(B);qs=s($o,"The first step would be to get the nameservers of the domain. We can use "),Ot=i($o,"CODE",{});var Ir=n(Ot);Xs=s(Ir,"dig"),Ir.forEach(t),Vs=s($o," for that:"),$o.forEach(t),Do=f(e),Zt=Q(e,!1),zt=f(e),$=i(e,"P",{});var Uo=n($);Js=s(Uo,"Or you can directly get the "),Pt=i(Uo,"CODE",{});var Nr=n(Pt);Ks=s(Nr,"NS"),Nr.forEach(t),Qs=s(Uo," records and start looking from there."),Uo.forEach(t),To=f(e),Lt=Q(e,!1),xt=f(e),U=i(e,"IMG",{width:!0,alt:!0,src:!0}),So=f(e),A=i(e,"P",{});var Ge=n(A);el=s(Ge,"The against each NS record, check if any of them fails to responsd. If it does, it can probably be vulnerable to zone takeover. The case it failes, you will have the status as "),Rt=i(Ge,"STRONG",{});var gr=n(Rt);tl=s(gr,"REFUSED"),gr.forEach(t),ol=s(Ge," or "),Ht=i(Ge,"STRONG",{});var Or=n(Ht);al=s(Or,"SERVFAIL"),Or.forEach(t),sl=s(Ge,":"),Ge.forEach(t),Ao=f(e),Gt=Q(e,!1),Mt=f(e),Y=i(e,"P",{});var Yo=n(Y);ll=s(Yo,"You can also check for "),Wt=i(Yo,"CODE",{});var Zr=n(Wt);rl=s(Zr,"SOA"),Zr.forEach(t),il=s(Yo," which is what i would like to do instead (to be more concise):"),Yo.forEach(t),Co=f(e),jt=Q(e,!1),Bt=f(e),fe=i(e,"P",{});var ml=n(fe);nl=s(ml,"Well, if it doesn’t responsd, you can try to claim the service. As of now, the current vulnerable services are available at: "),q=i(ml,"A",{href:!0,rel:!0,target:!0});var zr=n(q);cl=s(zr,"Can I Takeover DNS"),zr.forEach(t),ml.forEach(t),Io=f(e),Ce=i(e,"P",{});var Pr=n(Ce);dl=s(Pr,"Well, with subrake, it first tries to resolve each nameserver and if it does then it tries to guess the service and tells if its vulnerable or not. Something like this:"),Pr.forEach(t),No=f(e),X=i(e,"IMG",{width:!0,alt:!0,src:!0}),go=f(e),ue=i(e,"H2",{id:!0});var Lr=n(ue);Ie=i(Lr,"A",{href:!0});var xr=n(Ie);fl=s(xr,"Using Subrake"),xr.forEach(t),Lr.forEach(t),Oo=f(e),Ne=i(e,"P",{});var Rr=n(Ne);ul=s(Rr,"Subrake can help you pick all 3 above cases. The complete information and details can be found at the link i mentioned in the start of this blog. I am simply attaching a screenshot with the details."),Rr.forEach(t),Zo=f(e),ge=i(e,"IMG",{src:!0}),zo=f(e),pe=i(e,"H2",{id:!0});var Hr=n(pe);Oe=i(Hr,"A",{href:!0});var Gr=n(Oe);pl=s(Gr,"Conclusion"),Gr.forEach(t),Hr.forEach(t),Po=f(e),Ze=i(e,"P",{});var Mr=n(Ze);hl=s(Mr,"First of all, i hope this guide was helpful 😅. We saw 3 different cases namely, Zone Transfer, Zone Takeover and Subdomain Takeover. The mitigation simply is to be aware of when you remove a service. Make sure the entries in your DNS gets updated as well. Or wrap the service completely."),Mr.forEach(t),this.h()},h(){u(y,"href","#introduction"),u(p,"id","introduction"),u(ve,"href","#subrake"),u(te,"id","subrake"),u(P,"href","https://github.com/hash3liZer/Subrake"),u(P,"rel","nofollow noopener noreferrer external"),u(P,"target","_blank"),u(me,"href","#explanation"),u(oe,"id","explanation"),u(ye,"href","#zone-transfer"),u(ae,"id","zone-transfer"),et.a=tt,u(R,"width","828"),u(R,"alt","image"),$t(R.src,Fl="https://github.com/hash3liZer/khatta/assets/29171692/e0552efd-45d1-41fc-ad00-63706be3849a")||u(R,"src",Fl),u(Fe,"href","#subdomain-takeover"),u(ie,"id","subdomain-takeover"),dt.a=ft,ut.a=pt,ht.a=vt,u(G,"width","828"),u(G,"alt","image"),$t(G.src,El="https://github.com/hash3liZer/khatta/assets/29171692/ce1559b0-e5fe-4fdc-ae2c-98de252c9970")||u(G,"src",El),u(M,"href","https://github.com/EdOverflow/can-i-take-over-xyz"),u(M,"rel","nofollow noopener noreferrer external"),u(M,"target","_blank"),u(we,"href","#dns-zone-takeover"),u(ce,"id","dns-zone-takeover"),u(Se,"href","#finding-zone-takeover"),u(de,"id","finding-zone-takeover"),Zt.a=zt,Lt.a=xt,u(U,"width","894"),u(U,"alt","image"),$t(U.src,bl="https://github.com/hash3liZer/khatta/assets/29171692/aba8e709-0b33-486a-ac5c-c0ab48264625")||u(U,"src",bl),Gt.a=Mt,jt.a=Bt,u(q,"href","https://github.com/indianajson/can-i-take-over-dns"),u(q,"rel","nofollow noopener noreferrer external"),u(q,"target","_blank"),u(X,"width","743"),u(X,"alt","image"),$t(X.src,kl="https://github.com/hash3liZer/khatta/assets/29171692/3d55e662-c019-4062-8c46-4c9075c47a8e")||u(X,"src",kl),u(Ie,"href","#using-subrake"),u(ue,"id","using-subrake"),$t(ge.src,_l="https://user-images.githubusercontent.com/29171692/250178751-75abd71e-7765-4da0-8b08-1cc5e1e069c7.png")||u(ge,"src",_l),u(Oe,"href","#conclusion"),u(pe,"id","conclusion")},m(e,l){c(e,p,l),o(p,y),o(y,g),c(e,Z,l),c(e,h,l),o(h,k),c(e,ee,l),c(e,_,l),o(_,Me),o(Me,qo),o(_,Xo),o(_,We),o(We,Vo),o(_,Jo),o(_,je),o(je,Ko),c(e,Ut,l),c(e,te,l),o(te,ve),o(ve,Qo),c(e,Yt,l),c(e,z,l),o(z,ea),o(z,P),o(P,ta),o(z,oa),c(e,qt,l),c(e,oe,l),o(oe,me),o(me,aa),c(e,Xt,l),c(e,ae,l),o(ae,ye),o(ye,sa),c(e,Vt,l),c(e,w,l),o(w,la),o(w,Be),o(Be,ra),o(w,ia),o(w,$e),o($e,na),o(w,ca),c(e,Jt,l),c(e,v,l),o(v,da),o(v,Ue),o(Ue,fa),o(v,ua),o(v,Ye),o(Ye,pa),o(v,ha),o(v,qe),o(qe,va),o(v,ma),o(v,Xe),o(Xe,ya),o(v,Fa),c(e,Kt,l),c(e,L,l),o(L,Ea),o(L,Ve),o(Ve,ba),o(L,ka),c(e,Qt,l),c(e,E,l),o(E,_a),o(E,Je),o(Je,wa),o(E,Da),o(E,Ke),o(Ke,Ta),o(E,Sa),o(E,Qe),o(Qe,Aa),o(E,Ca),c(e,eo,l),et.m($r,e,l),c(e,tt,l),c(e,D,l),o(D,se),o(se,Ia),o(se,ot),o(ot,Na),o(se,ga),o(D,Oa),o(D,le),o(le,Za),o(le,at),o(at,za),o(le,Pa),o(D,La),o(D,re),o(re,xa),o(re,st),o(st,Ra),o(re,Ha),c(e,to,l),c(e,x,l),o(x,Ga),o(x,lt),o(lt,Ma),o(x,Wa),c(e,oo,l),c(e,R,l),c(e,ao,l),c(e,ie,l),o(ie,Fe),o(Fe,ja),c(e,so,l),c(e,b,l),o(b,Ba),o(b,rt),o(rt,$a),o(b,Ua),o(b,it),o(it,Ya),o(b,qa),o(b,nt),o(nt,Xa),o(b,Va),c(e,lo,l),c(e,Ee,l),o(Ee,Ja),c(e,ro,l),c(e,be,l),o(be,Ka),c(e,io,l),c(e,H,l),o(H,Qa),o(H,ct),o(ct,es),o(H,ts),c(e,no,l),dt.m(Ur,e,l),c(e,ft,l),c(e,ke,l),o(ke,os),c(e,co,l),ut.m(Yr,e,l),c(e,pt,l),c(e,_e,l),o(_e,as),c(e,fo,l),ht.m(qr,e,l),c(e,vt,l),c(e,G,l),c(e,uo,l),c(e,ne,l),o(ne,ss),o(ne,mt),o(mt,M),o(M,ls),c(e,po,l),c(e,ce,l),o(ce,we),o(we,rs),c(e,ho,l),c(e,T,l),o(T,is),o(T,yt),o(yt,ns),o(T,cs),o(T,Ft),o(Ft,ds),o(T,fs),c(e,vo,l),c(e,De,l),o(De,us),c(e,mo,l),c(e,m,l),o(m,Et),o(Et,ps),o(m,hs),o(m,O),o(O,vs),o(O,bt),o(bt,ms),o(O,ys),o(O,kt),o(kt,Fs),o(O,Es),o(m,bs),o(m,_t),o(_t,ks),o(m,_s),o(m,wt),o(wt,ws),o(m,Ds),o(m,F),o(F,Ts),o(F,Dt),o(Dt,Ss),o(F,As),o(F,Tt),o(Tt,Cs),o(F,Is),o(F,St),o(St,Ns),o(F,gs),o(F,At),o(At,Os),o(F,Zs),c(e,yo,l),c(e,S,l),o(S,zs),o(S,Ct),o(Ct,Ps),o(S,Ls),o(S,It),o(It,xs),o(S,Rs),c(e,Fo,l),c(e,W,l),o(W,Hs),o(W,Nt),o(Nt,Gs),o(W,Ms),c(e,Eo,l),c(e,j,l),o(j,Ws),o(j,gt),o(gt,js),o(j,Bs),c(e,bo,l),c(e,Te,l),o(Te,$s),c(e,ko,l),c(e,de,l),o(de,Se),o(Se,Us),c(e,_o,l),c(e,Ae,l),o(Ae,Ys),c(e,wo,l),c(e,B,l),o(B,qs),o(B,Ot),o(Ot,Xs),o(B,Vs),c(e,Do,l),Zt.m(Xr,e,l),c(e,zt,l),c(e,$,l),o($,Js),o($,Pt),o(Pt,Ks),o($,Qs),c(e,To,l),Lt.m(Vr,e,l),c(e,xt,l),c(e,U,l),c(e,So,l),c(e,A,l),o(A,el),o(A,Rt),o(Rt,tl),o(A,ol),o(A,Ht),o(Ht,al),o(A,sl),c(e,Ao,l),Gt.m(Jr,e,l),c(e,Mt,l),c(e,Y,l),o(Y,ll),o(Y,Wt),o(Wt,rl),o(Y,il),c(e,Co,l),jt.m(Kr,e,l),c(e,Bt,l),c(e,fe,l),o(fe,nl),o(fe,q),o(q,cl),c(e,Io,l),c(e,Ce,l),o(Ce,dl),c(e,No,l),c(e,X,l),c(e,go,l),c(e,ue,l),o(ue,Ie),o(Ie,fl),c(e,Oo,l),c(e,Ne,l),o(Ne,ul),c(e,Zo,l),c(e,ge,l),c(e,zo,l),c(e,pe,l),o(pe,Oe),o(Oe,pl),c(e,Po,l),c(e,Ze,l),o(Ze,hl)},p:ci,d(e){e&&t(p),e&&t(Z),e&&t(h),e&&t(ee),e&&t(_),e&&t(Ut),e&&t(te),e&&t(Yt),e&&t(z),e&&t(qt),e&&t(oe),e&&t(Xt),e&&t(ae),e&&t(Vt),e&&t(w),e&&t(Jt),e&&t(v),e&&t(Kt),e&&t(L),e&&t(Qt),e&&t(E),e&&t(eo),e&&et.d(),e&&t(tt),e&&t(D),e&&t(to),e&&t(x),e&&t(oo),e&&t(R),e&&t(ao),e&&t(ie),e&&t(so),e&&t(b),e&&t(lo),e&&t(Ee),e&&t(ro),e&&t(be),e&&t(io),e&&t(H),e&&t(no),e&&dt.d(),e&&t(ft),e&&t(ke),e&&t(co),e&&ut.d(),e&&t(pt),e&&t(_e),e&&t(fo),e&&ht.d(),e&&t(vt),e&&t(G),e&&t(uo),e&&t(ne),e&&t(po),e&&t(ce),e&&t(ho),e&&t(T),e&&t(vo),e&&t(De),e&&t(mo),e&&t(m),e&&t(yo),e&&t(S),e&&t(Fo),e&&t(W),e&&t(Eo),e&&t(j),e&&t(bo),e&&t(Te),e&&t(ko),e&&t(de),e&&t(_o),e&&t(Ae),e&&t(wo),e&&t(B),e&&t(Do),e&&Zt.d(),e&&t(zt),e&&t($),e&&t(To),e&&Lt.d(),e&&t(xt),e&&t(U),e&&t(So),e&&t(A),e&&t(Ao),e&&Gt.d(),e&&t(Mt),e&&t(Y),e&&t(Co),e&&jt.d(),e&&t(Bt),e&&t(fe),e&&t(Io),e&&t(Ce),e&&t(No),e&&t(X),e&&t(go),e&&t(ue),e&&t(Oo),e&&t(Ne),e&&t(Zo),e&&t(ge),e&&t(zo),e&&t(pe),e&&t(Po),e&&t(Ze)}}}function ui(he){let p,y;const g=[he[0],Br];let Z={$$slots:{default:[fi]},$$scope:{ctx:he}};for(let h=0;h<g.length;h+=1)Z=yl(Z,g[h]);return p=new di({props:Z}),{c(){oi(p.$$.fragment)},l(h){ai(p.$$.fragment,h)},m(h,k){si(p,h,k),y=!0},p(h,[k]){const ee=k&1?li(g,[k&1&&Wr(h[0]),k&0&&Wr(Br)]):{};k&2&&(ee.$$scope={dirty:k,ctx:h}),p.$set(ee)},i(h){y||(ri(p.$$.fragment,h),y=!0)},o(h){ii(p.$$.fragment,h),y=!1},d(h){ni(p,h)}}}const Br={title:"A Guide to Zone Transfer, DNS Zone Takeover and Subdomain Takeover",tags:["dns-zone-takeover","dns-zone-transfer","subdomain-takeover","bugbounty","infosec","reconnaissance","automated-tool"],categories:["Bug Bounty","Projects"],summary:"In this guide, we will be looking over vulnerabilites associated with a domain normally occured due to the negligence from the develper team. The terms we will see are Zone Transfer, DNS Zone Takeover and Subdomain Takeover.",created:"2023-06-30T00:00:00.000Z",lastmod:"2023-06-30T00:00:00.000Z",image:"https://github.com/hash3liZer/khatta/assets/29171692/755e47ec-8f67-45e9-a7cb-04efe7584127",flags:[],updated:"2024-11-25T22:17:22.244Z",slug:"/blog/2023/subrake-a-dns-automated-scanner/+page.md",path:"/blog/2023/subrake-a-dns-automated-scanner",toc:[{depth:2,title:"Introduction",slug:"introduction"},{depth:2,title:"Subrake",slug:"subrake"},{depth:2,title:"Explanation",slug:"explanation"},{depth:3,title:"Zone Transfer",slug:"zone-transfer"},{depth:3,title:"Subdomain Takeover",slug:"subdomain-takeover"},{depth:3,title:"DNS Zone Takeover",slug:"dns-zone-takeover"},{depth:4,title:"Finding Zone Takeover",slug:"finding-zone-takeover"},{depth:2,title:"Using Subrake",slug:"using-subrake"},{depth:2,title:"Conclusion",slug:"conclusion"}]};function pi(he,p,y){return he.$$set=g=>{y(0,p=yl(yl({},p),jr(g)))},p=jr(p),[p]}class mi extends Qr{constructor(p){super(),ei(this,p,pi,ui,ti,{})}}export{mi as component};
